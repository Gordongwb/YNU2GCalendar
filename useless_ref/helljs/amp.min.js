!function(e,a){function t(a){var t="app",i="",r=a.attr("amp-hasdescription"),o=a.attr("amp-descriptionauth"),p=a.attr("amp-unviewabledescription");a.attr("amp-haspermission");e.space.unviewabledescriptionFlag&&(p="false"),e.space.descriptionauthFlag,"1"===r?"true"===p?i=s(a):"1"===o?AmpGlobal.loginFlag?t="detail":i=s(a):(i=s(a),(AmpHeader.space.showDetailFlag||"null"==AmpHeader.space.showDetailFlag)&&(t="detail")):i=s(a),"app"===t?i?AmpPrompt.show({content:i,state:"warning"}):e.open(a):n(a)}function n(e){AmpDetail.open(e);var a=$(".amp-detail-wrap").filter('[id="ampFolder"]'),t=a.length;t>0&&a.remove()}function i(e){AmpFolder.open(e)}function s(e){var a="",t=e.attr("amp-title"),n=e.attr("amp-haspermission"),i=e.attr("amp-opening"),s=e.attr("amp-maintaining");if("false"===i){var r="已过期或尚未开放";a=t+"  已过期或尚未开放","en_US"==AmpGlobal.currentLang&&(r=$.i18n("expiredOrNotOpen"),a=r)}else if("true"===s){var o="正在维护期";"en_US"==AmpGlobal.currentLang&&(o=$.i18n("duringTheMaintenancePeriod")),a=t+o}else if("false"===n){var o="您没有权限使用";"en_US"==AmpGlobal.currentLang&&(o=$.i18n("notAuthorizedToUseService")),a=o+t}return a}e.space={unviewabledescriptionFlag:!1,descriptionauthFlag:!1},e.eventsListen=function(){var a=$("body");a.on("click",".appFlag",function(e){var a=$(e.target||e.srcElement);if("ampAppdescFlag"!==a.attr("id")){var n=$(this),s=AmpUtils.moduleName(a);s&&n.attr("amp-modulename",s);var r=n.attr("amp-type");"1"===r?i(n):t(n)}}),a.on("click",".ampAppdescFlag",function(a){var n=$(this),i=!1,s=n.attr("amp-unviewabledescription");return"true"==s&&(e.space.unviewabledescriptionFlag=!0,e.space.descriptionauthFlag=!0),t(n),i&&$("#ampDetailUnViewInput").prop("checked",!0),e.space.unviewabledescriptionFlag=!1,e.space.descriptionauthFlag=!1,!1}),a.on("mouseenter",".amp-hover-app-card-group",function(e){var a=$(this);if("1"!=a.find(".amp-app-card-big").attr("amp-type")){var t=0;t="ampFolderAppList"==a.parent().attr("id")?t-$("#ampFolderAppList").offset().top+$("#ampFolderAppList").scrollTop():a.offset().top,t<200?a.find(".amp-app-card-big").removeClass("amp-app-card-big-bottom").addClass("amp-app-card-big-top"):a.find(".amp-app-card-big").addClass("amp-app-card-big-bottom").removeClass("amp-app-card-big-top"),a.addClass("amp-active")}}),a.on("mouseleave",".amp-hover-app-card-group",function(e){var a=$(this);a.removeClass("amp-active")})},e.open=function(e){var a=e.attr("amp-url"),t=e.attr("amp-appid"),n=e.attr("amp-hashead"),i=e.attr("amp-title"),s=e.attr("amp-isthirdparty");e.attr("amp-appkey");if("1"==n)if("1"==s){var r="thirdAppIndexShell.html";localStorage.isthirdpartyUrl=a,localStorage.isthirdpartyAppId=t,window.open(r)}else a.indexOf("http")===-1&&a.indexOf("//")===-1&&(a=AMPConstant.requestPath+a),window.open(a);else if("0"==n){var o=AMPConstant.requestPath+"new/indexShell.html";localStorage.openHasNoHeadAppUrl=a,localStorage.openHasNoHeadAppId=t,localStorage.openHasNoHead="0",localStorage.openHasNoHeadTitle=i,localStorage.isthirdparty=s,window.open(o)}else a.indexOf("http")===-1&&a.indexOf("//")===-1&&(a=AMPConstant.requestPath+a),window.open(a);$("#ampDetail .icon-chacha").click();var p=AMPConfigure.schoolId,l=AmpUtils.getSessionStorageData("ampUserID"),m=AmpUtils.getSessionStorageData("ampUserIp"),c=AmpUtils.getSessionStorageData("userType"),d=e.attr("amp-appkey"),u=e.attr("amp-title"),f=e.attr("amp-appid");Wisedu.ampAppDataSend(p,l,m,d,f,u,"0","appShow"),parent.window.AMPConstant.operationAnalysisRequestPath&&Wisedu.ampAppDataSendNew(p,l,m,d,c,u,"appShow"),AmpDataUtils.sendRecUseApp(t,function(e){"true"==e.success}),parent.window.Wisedu.userActionDataSend("0"),parent.window.AMPConstant.operationAnalysisRequestPath&&parent.window.Wisedu.userActionDataSendNew(m,c)}}(window.AmpApp=window.AmpApp||{}),function(e,a){function t(e){var a=e.attr("amp-position"),t="",n="";switch(a){case"left":t="amp-animate-move-left-out",n="amp-animate-move-left-in";break;case"right":t="amp-animate-move-right-out",n="amp-animate-move-right-in"}e.removeClass(n).addClass(t),setTimeout(function(){e.hasClass("amp-mini")?e.removeClass("amp-mini"):e.addClass("amp-mini"),e.removeClass(t).addClass(n)},AmpGlobal.animateTimes)}var n=$("body");n.on("click",".amp-aside-box-mini-item",function(){t($(this).parent().parent().parent())}),n.on("click",'[amp-role="ampAsideBoxClose"]',function(){t($(this).parent())})}(window.AmpAsideBox=window.AmpAsideBox||{}),function(e,a){function t(){var e=$("#ampBootLeftArrow");e.addClass("amp-hide")}function n(e,t){var e=e==a?"":e,n=t==a?0:t,i=0,s=$("#ampBootLeftArrow"),r=$("#ampBootRightArrow"),o=$("#ampBootMainSide");return(!s.hasClass("amp-hide")||"left"!=e)&&((!r.hasClass("amp-hide")||"right"!=e)&&("left"==e?i=parseInt(n)-1:"right"==e&&(i=parseInt(n)+1),o.find("li").removeClass("amp-hide").removeClass("amp-active"),void(""!=e||n?""!==e&&i<5?(o.find("li").removeClass("amp-active"),o.find('li[show-index="'+i+'"]').addClass("amp-active"),s.removeClass("amp-hide").addClass("amp-active"),"left"!=e||i||s.addClass("amp-hide"),4==i&&(s.addClass("amp-hide"),r.addClass("amp-hide"),$("#ampBootMainSideRQ").removeClass("amp-hide").addClass("amp-active"))):($("#ampBootPageIntroduce").addClass("amp-hide"),$("#ampBootPageReload").removeClass("amp-hide").addClass("amp-active")):(o.find('li[show-index="0"]').addClass("amp-active"),r.addClass("amp-active").removeClass("amp-hide")))))}function i(){var e=$("#ampBootPage"),a=$("#ampBootMainSide");e.off().on("click",".ampBootArrow",function(){var e=$(this).attr("amp-position"),t=a.find("li.amp-active").attr("show-index");n(e,t)}),$("#ampBootReload").off().on("click",function(){s()}),$("#ampBootEnter").off().on("click",function(){r()})}function s(){var e=$("#ampBootPageIntroduce"),a=$("#ampBootPageReload");e.removeClass("amp-hide").addClass("amp-active"),a.removeClass("amp-active").addClass("amp-hide"),t(),n()}function r(){var e=$("#ampServiceArticle");e.hasClass("ampCurrentBootPageFlag")?($("#ampPageHeaderSearch").click(),o()):o();var a="1";AmpDataUtils.updateUserReadGuidePage(a,function(e){"success"===e.result&&console.log("引导页已读成功！")})}function o(){var e=$("#ampPersonalArticle"),a=$("#ampBootPage"),t=$("#ampEhallBody"),n=$("#ampHeaderNav"),i=($("#ampServiceArticle"),n.find("i.amp-active").attr("id"));"ampPageHeaderHomeIcon"==i?t.removeClass("amp-opcity-bottom"):"ampPageHeaderPersonalIcon"==i&&e.removeClass("amp-hide").addClass("amp-active"),a.removeClass("amp-active").addClass("amp-hide")}e.init=function(){t(),n(),i()}}(window.AmpBootPage=window.AmpBootPage||{}),function(e,a){function t(a,t,i){var s;a?s=a.length:(a=null,s=0);var r=200,o=8,p=window.innerWidth,l=32,m=p-2*l,c=parseInt(m/r,10);(c-1)*o+c*r>m&&c--;var d=8,u=s%c!==0?parseInt(s/c,10)+1:parseInt(s/c,10),f=1,g="共",v="项 >";"en_US"==AmpGlobal.currentLang&&(g=$.i18n("aTotalOf"),v=$.i18n("item"));for(var h=$("#tpl-classify-card").html().replace("@aTotalOf",g).replace("@item",v),A="",C="",k=0;k<s;k++){var b=a[k],S=b.categoryName,y=b.categoryEnName?b.categoryEnName:"",w=b.categoryId,P=b.appList;if(P){var I=P.length,U="";if(I>0){var D="amp-rotateY-hide";"init"===i&&(D=f>1?"amp-rotateY-hide":"");for(var L=0;L<I&&L<d;L++){var T=P[L],F="single";U+=AmpTemplate.getSingleAppHtml(T,F)}A+=h.replace("@ChTitle",S).replace("@EnTitle",y).replace("@apps",U).replace("@hideRotateYClass",D).replace("@classifyId",w).replace("@appSumCount",P.length).replace("@TipChTitle",S)}}if((k+1)%c===0&&0!==k){var x=f>1?"amp-hide":"";C+='<div class="amp-classify-container '+x+'">'+A+"</div>",A="",f++}if(k===s-1&&A){var x=f>1?"amp-hide":"";C+='<div class="amp-classify-container '+x+'">'+A+"</div>"}}var H="init"!==i?"amp-hide":"amp-active",M="ampClassifyPage"+t,N={id:M};1===u&&(N.customClass="amp-hide");var R=AmpTemplate.getAppPageHtml(u,N),E=$("#ampClassifySection");E.append('<div class="ampPageBodyFlag '+H+'" amp-role-id="'+t+'"><div class="amp-classify ampPageContentFlag">'+C+"</div>"+R+"</div>"),"init"!==i&&e.roleNavChangeHandle({classifyContainer:E.children("[amp-role-id="+t+"]")},{classifyContainer:E.children(".amp-active")}),$("#"+M).on("click","div",function(){n($(this))})}function n(e){if(!e.hasClass("amp-active")){var a=e.closest(".ampPageBodyFlag"),t=a.children(".ampPageContentFlag"),n=a.children(".amp-apps-page"),i=t.children(),s=e.index(),r=$(i[s]),o={container:r,pageContainer:e},p=n.find(".amp-active"),l=p.index(),m=$(i[l]),c={container:m,pageContainer:p};AmpUtils.clickPage4RotateYState(o,c)}}function i(){$("#ampClassifySection").on("click",function(e){var a=$(e.target||e.srcElement);if(!(a.closest(".appFlag").length>0||a.hasClass("appFlag"))){var t=null;a.hasClass("amp-classify-apps")?t=a:a.closest(".amp-classify-apps").length>0&&(t=a.closest(".amp-classify-apps"));var n=$("#ampServiceArticle");if(t){var i=t.attr("amp-classify-id"),s=$("#ampClassifyRoleNav").children(".amp-active").attr("amp-role-id");AmpHeader.searchBoxFocus(),$("#ampExtend").addClass("amp-hide"),AmpHeader.openServiceSearch(),AmpServiceCenter.init({labels:[i,s]}),n.addClass("ampLoadActiveFlag"),n.hasClass("amp-active")&&$("#ampPageHeader").addClass("amp-service-header"),$("#ampServiceSearchInput").focus(),AmpUtils.zhuge("访问搜索中心",{"来源":"办事大厅-应用分类查看"})}}})}function s(){"en_US"==localStorage.localeLang?$("#ampPageFooter").html(AMPConfigure.footer.enFooter):$("#ampPageFooter").html(AMPConfigure.footer.normal)}i(),s(),e.getClassifyAppsData=function(e,a){AmpDataUtils.getClassifyApps(e,function(n){t(n,e,a)})},e.setClassifyContainerMarginAndNiceScroll=function(){var e=window.innerHeight,a=$("#ampClassifyArticle"),t=a.children(),n=0;t.each(function(){var e=$(this),a=e.outerHeight();n+=a});var i=$("#ampPageHeader").outerHeight();if(n+i<e){var s=e-n-i,r=parseInt(s/2,10),o=r+i+"px",p=r+"px";a.css({"padding-top":o,"padding-bottom":p})}else AmpUtils.niceScrollInit(a)},e.roleNavChangeHandle=function(e,a){var t=e.classifyContainer,n=t.children(".amp-apps-page").children(".amp-active").index(),i=$(t.children(".ampPageContentFlag").children()[n]),s=a.classifyContainer,r=s.children(".amp-apps-page").children(".amp-active").index(),o=$(s.children(".ampPageContentFlag").children()[r]),p=o.children(),l=p.length;p.each(function(e,a){AmpUtils.setRotateYState($(this),"hide",e*AmpGlobal.rotateYTimeStep)}),setTimeout(function(){t.removeClass("amp-hide").addClass("amp-active"),s.addClass("amp-hide").removeClass("amp-active"),setTimeout(function(){i.children().each(function(e){AmpUtils.setRotateYState($(this),"show",e*AmpGlobal.rotateYTimeStep)})},50)},450+(l-3)*AmpGlobal.rotateYTimeStep)}}(window.AmpClassify=window.AmpClassify||{}),function(e){e.getPublicAppPath=function(){return AMPConstant.publicRequestPath},e.getWidgetColNumberOrAtSide=function(){return""}}(window.AmpUtils=window.AmpUtils||{}),function(e){e.getWidgetUrlPrefix=function(e){return AMPConstant.requestPath+"resources/widget/"+e+"/"},e.getWidgetColNumberOrAtSide=function(e){return""},e.doJsonpAjax=function(e,a){var t=$.Deferred();return $.ajax({type:"GET",url:e,traditional:!0,data:a,dataType:"jsonp",jsonp:AMPConstant.jsonp,success:function(e){!e.hasLogin,t.resolve(e)},error:function(e){t.reject(e)}}),t.promise()}}(window.AmpWidget=window.AmpWidget||{}),function(e){e.getCurrentSiteId=function(){return""}}(window.AmpSiteManage=window.AmpSiteManage||{}),function(e){e.curation={}}(window.AMP=window.AMP||{}),function(e,a){function t(a,t,i){return e.space.ehallData[a]?i(n(a,t)):void AmpServices.ehallAppData(a).done(function(s){return e.space.ehallData[a]=s,i(n(a,t))})}function n(a,t){return"recommend"===t?i(a,t):"classify"===t?e.space.ehallData[a].categoryList:"hot"===t?e.space.ehallData[a].hotServiceList:"new"===t?i(a,t):e.space.ehallData[a]}function i(a,t){for(var n=[],i=e.space.ehallData[a].recommendAndNewAppList,s=i?i.length:0,r=0;r<s;r++){var o=i[r],p=o.newApp;"new"===t?p&&n.push(o):p||n.push(o)}return n}e.space={ampData:{},folderData:{},ehallData:{},allServiceData:null,userDesktopPropertyData:{},desktopData:{},userDescSetData:{},userCategoryAppData:null,expandListData:null,firstLoginFlag:null,getTaskCountData:null},e.getUserInfo=function(a){AmpServices.userInfo().done(function(t){return AmpGlobal.loginFlag=!!t.hasLogin,e.space.ampData=t,a(t)}).fail(function(e){return a({})})},e.getClassifyApps=function(e,a){t(e,"classify",function(e){return a(e)})},e.getHotApps=function(e,a){t(e,"hot",function(e){return a(e)})},e.getNewApps=function(e,a){t(e,"new",function(e){return a(e)})},e.getEhallData=function(e,a){t(e,"all",function(e){return a(e)})},e.getSearchApps=function(a,t){var n={containLabels:!0,searchKey:a.key},i="",s=a.labels;if(s){var r=s.length;if(r>0){for(var o=0;o<r;o++)i+=0!==o?"&labels="+s[o]:"labels="+s[o];n.labels=i}}var p=!1;return""===i&&""===a.key&&(p=!0,e.space.allServiceData)?t(e.space.allServiceData):void AmpServices.searchAppData(n).done(function(a){return p&&(e.space.allServiceData=a),t(a)}).fail(function(){return t({})})},e.getNewArrivalApps=function(a){return a(e.space.allServiceData.lastOnlineAppResult)},e.getMyFavoriteApps=function(e){AmpServices.myFavoriteApps().done(function(a){return e(a)})},e.getAllWidgetsData=function(a){return a(e.space.ampData.allWidget)},e.getMainWidgetsData=function(a){AmpServices.userInfo().done(function(t){return e.space.ampData=t,a(t)}).fail(function(e){return a({})})},e.getAsideWidgetsData=function(e){AmpServices.getTaskSideCard().done(function(a){return e(a)})},e.getAsideWidgetsDataOfUnreadMessage=function(e){AmpServices.getTaskSideCardOfUnreadMessage().done(function(a){return e(a)})},e.favoriteApp=function(e,a){AmpServices.favoriteApp(e).done(function(e){return a(e)})},e.unFavoriteApp=function(e,a){AmpServices.unFavoriteApp(e).done(function(e){return a(e)})},e.getAppIntroduction=function(e,a){AmpServices.appIntroduction(e).done(function(e){return a(e)})},e.updateDesHasUpdateStatus=function(e){AmpServices.updateDesHasUpdateStatus(e)},e.setAppUnViewableDescription=function(e,a){AmpServices.appUnViewableDescription(e).done(function(e){return a(e)})},e.setAppRestoreViewableDescription=function(e,a){e.unviewable=0,AmpServices.appRestoreViewableDescription(e).done(function(e){return a(e)})},e.getUserCategoryAppData=function(a){return null!=e.space.userCategoryAppData?a(e.space.userCategoryAppData):void AmpServices.getUserCategoryAppList().done(function(t){return e.space.userCategoryAppData=t,a(t)})},e.getNoReadMessageData=function(e,a){var t={typeId:"-1",typeName:"未读消息"};t=$.extend(t,e),AmpServices.noReadMessageData(t).done(function(e){return a(e)})},e.getFolderData=function(a,t){return t(e.space.folderData[a])},e.getRecentUseApps=function(e){AmpServices.recentUseApps().done(function(a){return e(a)})},e.deleteDesktop=function(e,a){AmpServices.deleteDesktop().done(function(e){return a(e)})},e.restoreDesktop=function(e,a){AmpServices.restoreDesktop().done(function(e){return a(e)})},e.editDesktop=function(e,a){AmpServices.editDesktop(e).done(function(e){return a(e)})},e.editUserDesktopOrder=function(e,a){AmpServices.editUserDesktopOrder().done(function(e){return a(e)})},e.getDesktopCreatData=function(a){return a(e.space.ampData)},e.desktopCreat=function(e,a){AmpServices.desktopCreat(e).done(function(e){return a(e)})},e.getUserDesktopProperty=function(a){AmpServices.getUserDesktopProperty().done(function(t){return e.space.userDesktopPropertyData=t,a(t)})},e.updateUserDesktopSeq=function(e,a){AmpServices.updateUserDesktopSeq(e).done(function(e){return a(e)})},e.deleteUserDesktopCard=function(e,a){AmpServices.deleteUserDesktopCard(e).done(function(e){return a(e)})},e.getRecommendCard=function(a){return a(e.space.desktopData.appPcCardBizList)},e.updateRecommendCardStatus=function(e,a){AmpServices.updateRecommendCardStatus(e).done(function(e){return a(e)})},e.userDesktopInfo=function(a,t){AmpServices.userDesktopInfo(a).done(function(a){return e.space.desktopData=a,AmpGlobal.loginFlag=!!a.hasLogin,e.space.ampData=a,t(a)})},e.desktopInfo=function(a){return a(e.space.ampData)},e.updatePcCardMarkStatus=function(e,a){AmpServices.updatePcCardMarkStatus(e).done(function(e){return a(e)})},e.getTagsMessages=function(e,a){AmpServices.getTagsMessages(e).done(function(e){return a(e)})},e.getUserDescSet=function(a){return null!=e.space.userDescSetData.length?a(e.space.userDescSetData):void AmpServices.getUserDescSet().done(function(t){return e.space.userDescSetData=t,a(t)})},e.getrecUseServiceList=function(e){AmpServices.getrecUseServiceList().done(function(a){return e(a)})},e.sendRecUseApp=function(e,a){AmpServices.sendRecUseApp(e).done(function(e){return a(e)})},e.updateUserDesktopStatus=function(e,a){AmpServices.updateUserDesktopStatus(e).done(function(e){return a(e)})},e.getUserSkin=function(e){AmpServices.getUserSkin().done(function(a){return e(a)})},e.switchSkin=function(e,a){AmpServices.switchSkin(e).done(function(e){return a(e)})},e.userSearchHistory=function(e){AmpServices.userSearchHistory().done(function(a){return e(a)})},e.getTopExtendList=function(a){return e.space.expandListData&&null!=e.space.expandListData?a(e.space.expandListData):void AmpServices.getTopExtendList().done(function(t){return e.space.expandListData=t,a(t)})},e.getUserFirstLogin=function(a){return null!=e.space.firstLoginFlag?a(e.space.firstLoginFlag):void AmpServices.getUserFirstLogin().done(function(t){return e.space.firstLoginFlag=t,a(t)})},e.setMsgsRead=function(e,a){AmpServices.setMsgsRead(e).done(function(e){return a(e)})},e.setAllTagMsgsRead=function(e){AmpServices.setAllTagMsgsRead().done(function(a){return e(a)})},e.getTaskCount=function(a){return e.space.getTaskCountData&&null!=e.space.getTaskCountData?a(e.space.getTaskCountData):void AmpServices.getTaskCount().done(function(t){return e.space.getTaskCountData=t,a(t)})},e.getTaskDbLcData=function(e,a){AmpServices.getTaskDbLcData(e).done(function(e){return a(e)})},e.getTaskZqfwData=function(e,a){AmpServices.getTaskZqfwData(e).done(function(e){return a(e)})},e.updateUserReadGuidePage=function(e,a){AmpServices.updateUserReadGuidePage(e).done(function(e){return a(e)})},e.getCurrentLocale=function(e){AmpServices.getCurrentLocale().done(function(a){return AmpGlobal.loginFlag=!!a.hasLogin,e(a)})},e.checkLogin=function(e){AmpServices.checkLogin().done(function(a){return AmpGlobal.loginFlag=!!a.hasLogin,e(a)})},e.setCurrentLocale=function(e,a){AmpServices.setCurrentLocale(e).done(function(e){return a(e)})},e.getUserFavFolders=function(e){AmpServices.getUserFavFolders().done(function(a){return e(a)})},e.saveUserFavFolder=function(e,a){AmpServices.saveUserFavFolder(e).done(function(e){return a(e)})},e.saveFavFolderOperates=function(e,a){AmpServices.saveFavFolderOperates(e).done(function(e){return a(e)})}}(window.AmpDataUtils=window.AmpDataUtils||{}),function(e,a){function t(e){var a=e.attr("amp-appid");n(e),AmpDataUtils.getAppIntroduction({appId:a},function(t){i(t,a,e.attr("amp-title"))})}function n(e){$("body").find(".ampLoadActiveFlag").addClass("amp-loaded-hide").removeClass("amp-loaded-active");var a=e.attr("amp-title"),t=e.attr("amp-img"),n=e.attr("amp-version"),i=e.attr("amp-category"),r=e.attr("amp-unviewabledescription"),o=e.attr("amp-haspermission"),p=(e.attr("amp-descriptionauth"),e.attr("amp-opening")),l=e.attr("amp-maintaining"),m="",c="",d="",u="",f="进入服务",g="无权限使用",v="已过期或尚未开放";if("en_US"==AmpGlobal.currentLang&&(f=$.i18n("enterTheService"),g=$.i18n("noAuthority"),v=$.i18n("expiredOrNotOpen")),AmpGlobal.loginFlag){if("true"==o?(c="amp-hide",d=f,u="amp-active"):(m="amp-hide",d=g,c="amp-hide",$("#ampDetailEnter").attr("amp-show-nopermission",!0)),"false"==p&&(m="amp-hide",d=v),"true"==l){var h="维护期";"en_US"==AmpGlobal.currentLang&&(h=$.i18n("maintenancePeriod")),m="amp-hide",d=h}}else"true"==o?(c="amp-hide",d=f,u="amp-active"):(m="amp-hide",d=g,$("#ampDetailEnter").attr("amp-show-permission",!0));var A=AmpTemplate.getDetailHtml().replace("@img",t).replace("@title",a).replace("@version",n).replace("@category",i).replace("@loginClass",c).replace("@unviewClass",m).replace("@enterText",d).replace("@enterClass",u).replace("@unviewabledescription",r).replace("@title_category",i);if($("body").append(A),AmpGlobal.loginFlag&&("false"==p&&(m="amp-hide",d=v,c="amp-hide",$("#ampDetailEnter").removeClass("amp-active").attr("amp-show-nopermission",!0)),"true"==l)){var h="正在维护期";"en_US"==AmpGlobal.currentLang&&(h=$.i18n("duringTheMaintenancePeriod")),m="amp-hide",d=h,c="amp-hide",$("#ampDetailEnter").removeClass("amp-active").attr("amp-show-nopermission",!0)}"true"!=o&&$("#ampDetailEnter").attr("amp-show-nopermission",!0),s(),AmpUtils.copyAppAttributesFromDomToDom(e,$("#ampDetailEnter")),"false"!==r&&$("#ampDetailUnViewInput").prop("checked",!0)}function i(e,t,n){var i=e.introduction;if(e.desHasUpdate){var s="更新",r="更新说明";"en_US"==AmpGlobal.currentLang&&(s=$.i18n("update"),r=$.i18n("updateInstructions")),$("#ampDetail").find("h3[data-amp-app-title]").html(n+'<span class="update-instr" data-i18n="updateInstructions">'+r+"</span>"),$("#ampDetail").find("div[data-amp-app-service]").html(e.desUpdateTime+"&nbsp;"+s),AmpDataUtils.updateDesHasUpdateStatus({appId:t,desHasUpdate:"0"})}i||(i='<img class="amp-detail-null-data" src="portal/images/prompt/null-data.png" />');var o=$("#ampDetailIntroduction"),p=$("#ampDetailIntroductionContent"),l="",m="";if(e.appMaintainList.length>0)for(var c=e.appMaintainList,d=0;d<c.length;d++){var u="维护周期",f="维护原因";"en_US"==AmpGlobal.currentLang&&(u=$.i18n("maintenanceCycle"),f=$.i18n("maintenanceReason"));var g=c[d].beginTime,v=c[d].endTime,h=null==c[d].reason||a==c[d].reason?"":c[d].reason;l+='<span class="amp-open-maintain-content"><span data-i18n="maintenanceCycle">'+u+"：</span>"+g+" - "+v+" </span>",l+='<span class="amp-open-maintain-content"><span data-i18n="maintenanceReason">'+f+"：</span>"+h+" </span>"}if(e.appOpenPeriodList.length>0)for(var A=e.appOpenPeriodList,d=0;d<A.length;d++){var C=A[d].beginTime,k=A[d].endTime,b="开放周期";"en_US"==AmpGlobal.currentLang&&(b=$.i18n("openCycle")),m+='<span  class="amp-open-maintain-content"><span data-i18n="openCycle">'+b+"：</span>"+C+" - "+k+" </span>"}p.before(l+m),p.html(i),AmpUtils.niceScrollInit(o)}function s(){var e=$("#ampDetail");e.on("click",".icon-chacha",function(){r()}),e.on("click",".amp-detail-enter",function(){var e=$(this).attr("amp-show-nopermission");e||AmpApp.open($(this))}),e.on("click",".amp-detail-login-btn",function(){AmpUtils.goLoginPage()}),$("#ampDetailUnViewInput").on("click",function(){$("#ampDetailUnViewInput").attr("state-change","true");var e=$("#ampDetailUnViewInput").prop("checked"),a=$("#ampDetailEnter").attr("amp-appid");if(e){var t={};t.unviewable=1,t.appId=a,AmpDataUtils.setAppUnViewableDescription(t,function(e){"选择跳过详情页面成功！"==e.result&&console.log("选择跳过详情页面成功！"),o(t)})}else{var t={};t.unviewable=0,t.appId=a,AmpDataUtils.setAppUnViewableDescription(t,function(e){console.log("选择跳过详情页面成功！"),o(t)})}})}function r(){var e=$("#ampDetailUnViewInput");if("true"===e.attr("state-change")){var a=e.val(),t=e.prop("checked").toString();if(a!==t){var n=$("#ampDetailEnter").attr("amp-appid"),i={appId:n};"false"===t&&AmpDataUtils.setAppRestoreViewableDescription(i,function(e){}),AmpUtils.synchronousAppAttributes(n,{"amp-unviewabledescription":t})}}$("#ampDetail").remove(),$("body").find(".ampLoadActiveFlag").removeClass("amp-loaded-hide").addClass("amp-loaded-active")}function o(e){var a=e.unviewable,t=e.appId;if(AmpDataUtils.space.allServiceData)for(var n=AmpDataUtils.space.allServiceData,i=n.searchResult,s=0;s<i.length;s++)if(i[s].type)for(var r=i[s].appList,o=0;o<r.length;o++)r[o].appId==t&&(a?r[o].unviewableDescription=!0:r[o].unviewableDescription=!1);else i[s].appId==t&&(a?i[s].unviewableDescription=!0:i[s].unviewableDescription=!1);var p=JSON.parse(sessionStorage.getItem("allCanUseApps"));if(p){var l=p,m=l.data,c=l.classify;if(c)for(var s=0;s<c.length;s++){var d=c[s],r=m[d].appList;if(r)for(var o=0;o<r.length;o++)r[o].appId==t&&(a?r[o].unviewableDescription=!0:r[o].unviewableDescription=!1)}sessionStorage.setItem("allCanUseApps",JSON.stringify(l))}}e.open=function(e){t(e)}}(window.AmpDetail=window.AmpDetail||{}),function(e,a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a(require("jquery")):e.AmpDialog=a(e.jQuery)}(this,function(e){var a=function(a){var t="确定",n="取消";"en_US"==AmpGlobal.currentLang&&(t=e.i18n("confirm"),n=e.i18n("cancel"));var i={title:"",type:"dialog",mask:!0,width:500,height:void 0,theme:"",remote:null,content:"",onConfirm:function(e){},onCancel:function(e){},template:['<div class="amp-dialog">','<div class="amp-dialog-content showSweetAlert">','<div class="amp-dialog-header">','<h2 class="amp-dialog-title"></h2>','<i class="amp-dialog-close"></i>',"</div>",'<div class="amp-dialog-body"></div>','<div class="amp-dialog-footer">','<button type="button" class="amp-dialog-ok" data-i18n="confirm">'+t+"</button>",'<button type="button" class="amp-dialog-cancel" data-i18n="cancel">'+n+"</button>","</div>","</div>",'<div class="amp-dialog-mask"></div>',"</div>"].join("")};return this.$element=null,e.extend(this,i,a),this.init(),this};a.prototype.init=function(){this._renderDOM(),this.bindEvents(),this.show()},a.prototype.bindEvents=function(){this.$element.on("click",".amp-dialog-close",e.proxy(this.hide,this)).on("click",".amp-dialog-cancel",e.proxy(this.hide,this)).on("click",".amp-dialog-ok",e.proxy(this.clickOk,this))},a.prototype._renderDOM=function(){var a,t,n=e(this.template),i=this;if(a=n.find(".amp-dialog-title"),t=n.find(".amp-dialog-body"),i.type=e.trim(i.type),n.addClass(function(e,a){var t=[];return"alert"!==i.type&&"confirm"!==i.type||t.push("amp-dialog__"+i.type),i.theme&&t.push(i.theme),i.mask&&t.push("amp-dialog--mask"),t.join(" ")}),a.text(this.title),this.remote){var s=this.remote,r=document.createElement("iframe");r.src=s.url,t.append(r),t.css({overflow:"hidden"})}else t.append(this.content);return n.find(".amp-dialog-content").css({width:i.width,height:i.height}),i.height&&t.height(i.height-106),this.$element=n,this.$element.appendTo(e("body")),this.$element.niceScroll(),this},a.prototype.show=function(){this.$element.addClass("amp-dialog__active")},a.prototype.hide=function(){this.onCancel.call(this,this.$element),this.$element.remove()},a.prototype.clickOk=function(){this.onConfirm.call(this,this.$element),this.$element.remove()};var t=function(e){return new a(e)};return t}),function(e,a){function t(a){var t=$("#ampEhallBody"),i="";AmpGlobal.showLoginPageFlag&&(i="amp-hide");var r=AmpTemplate.getRoleNavHtml({id:"ampEhallRoleNav",roleId:a,customClass:i}),p="ampClassifyRoleNav",l=AmpTemplate.getRoleNavHtml({roleId:a,id:p,customClass:"amp-hide"}),m="ampEhallRoleNavAnimateBlock",c=AmpTemplate.getRoleNavHtml({roleId:a,id:m,customClass:"amp-hide"}),d=$("#ampEhallRoleNavPlaceHolder");d.length>0?(d.html(r),$("#ampClassifyRoleNavPlaceHolder").html(l),t.append(c),setTimeout(function(){var e=d.offset(),a=e.left;!AmpUtils.IsPC(),$("#"+m).css({top:e.top,left:a}),$("#"+p).css({left:a})},AmpGlobal.animateTimes+10)):($("#ampClassifyRoleNavPlaceHolder").html(l),t.append(c),setTimeout(function(){var e=($(window).width()-$("#ampClassifyRoleNav").width())/2;AmpUtils.IsPC()||(e+=60),$("#"+m).css({left:e}),$("#"+p).css({left:e})},AmpGlobal.animateTimes+10)),t.on("click",".amp-ehall-nav-item",function(a){$(this).hasClass("amp-active")||(o($(this)),e.space.autoEhallIndex=0,e.space.autoClassifyIndex=0,n($(this)),s($(this)))})}function n(e){var a=i();clearInterval(a),a=null,$("#ampRecommendSection").mouseover(function(){clearInterval(a),a=null}),$("#ampRecommendSection").mouseout(function(){a=i()})}function i(a,t){var n=setInterval(function(){var a=$("#ampEhallRoleNav").children(".amp-ehall-nav-item.amp-active"),t=a,n=t.attr("amp-role-id"),i=$("#ampRecommendPage"+n),s=i.children(),r=s.length;e.space.autoEhallIndex==r&&(e.space.autoEhallIndex=0),i.children().length>0&&(i.children()[e.space.autoEhallIndex].click(),i.children("div:eq("+e.space.autoEhallIndex+")").hasClass("amp-active")&&e.space.autoEhallIndex++)},6e3);return n}function s(e){var a=r();clearInterval(a),a=null,$("#ampClassifySection").mouseover(function(){clearInterval(a),a=null}),$("#ampClassifySection").mouseleave(function(){a=r()})}function r(t,n){var i=setInterval(function(){var t=$("#ampEhallRoleNav").children(".amp-ehall-nav-item.amp-active"),n=t,i=n.attr("amp-role-id"),s=$("#ampClassifyPage"+i),r=s.children(),o=r.length;return e.space.autoClassifyIndex==o&&(e.space.autoClassifyIndex=0),s.children()[e.space.autoClassifyIndex]!=a&&(s.children()[e.space.autoClassifyIndex].click(),void(s.children("div:eq("+e.space.autoClassifyIndex+")").hasClass("amp-active")&&e.space.autoClassifyIndex++))},6e3);return i}function o(e){var a=e.attr("amp-role-id");p(a)}function p(e,a){var t=l(e);t.loadedFlag?(AmpUtils.animateMove(t.toShowData,t.toHideData),AmpClassify.roleNavChangeHandle(t.toShowData,t.toHideData)):AmpDataUtils.getEhallData(e,function(t){!AMPConfigure.showLoginPageFlag&&AMPConfigure.fudanEhallCustom?m(t,e,a):c(t,e,a),AmpClassify.getClassifyAppsData(e,a)})}function l(e){var t=!1,n=$("#ampRecommendSection"),i=$("#ampClassifySection"),s={},r={},o=0==$("#ampEhallRoleNav").length?$("#ampClassifyRoleNav"):$("#ampEhallRoleNav");return o.children().each(function(o){var p=$(this),l=p.attr("amp-role-id");l===e&&(s.index=o,s.pageContainer=p,n.length>0?s.container=$(n.children("[amp-role-id="+e+"]")):s.container=$(i.children("[amp-role-id="+e+"]")),i.length>0&&(s.classifyContainer=$(i.children("[amp-role-id="+e+"]"))),s.container!=a&&s.container.length&&(t=!0)),p.hasClass("amp-active")&&(r.index=o,r.pageContainer=p,n.length>0?r.container=$(n.children("[amp-role-id="+l+"]")):r.container=$(i.children("[amp-role-id="+l+"]")),i.length>0&&(r.classifyContainer=$(i.children("[amp-role-id="+l+"]"))))}),{loadedFlag:t,toShowData:s,toHideData:r}}function m(e,a,t){var n=0;if(e.hotRecNewAppList){var i=e.hotRecNewAppList;n=i.length}else e.hotRecNewAppList=null,n=0;for(var s=[],r="",o=!0,p=0;p<n;p++){var m=i[p];p<5&&s.push(m)}var c="推荐服务";"en_US"==AmpGlobal.currentLang&&(c=$.i18n("recommendedService")),s.length>0&&(r+=d(s,o,c),o=!1);var f="init"!==t?"amp-hide":"amp-active",g="";if(r){var v="推荐服务";"en_US"==AmpGlobal.currentLang&&(v=$.i18n("recommendedService")),g=$("#tpl-ehall-app-head").html().replace("@recommendedService",v)}if($("#ampRecommendSection").html('<div class="amp-animated ampPageBodyFlag '+f+'" amp-role-id="'+a+'"><div class="amp-ehall-apps ampPageContentFlag">'+r+"</div></div>"),$("#ampFudanEhallPage").find('div[amp-role-id="'+a+'"]').addClass("amp-active").siblings("div").removeClass("amp-active"),"init"!==t){var h=l(a);AmpUtils.animateMove(h.toShowData,h.toHideData)}$("#ampFudanEhallPage").on("click","div",function(){u($(this))})}function c(e,a,t){var n=0;if(e.hotRecNewAppList){var i=e.hotRecNewAppList;n=i.length}else e.hotRecNewAppList=null,n=0;for(var s=[],r=[],o=[],p="",m=0,c=!0,u=0;u<n;u++){var g=i[u];u<15?o.push(g):u>=15&&u<30?r.push(g):s.push(g)}var v="推荐服务";"en_US"==AmpGlobal.currentLang&&(v=$.i18n("recommendedService")),o.length>0&&(m++,p+=d(o,c,v),c=!1),r.length>0&&(m++,p+=d(r,c,v),c=!1),s.length>0&&(m++,p+=d(s,c,v),c=!1);var h="ampRecommendPage"+a,A={id:h};1===m&&(A.customClass="amp-hide");var C=AmpTemplate.getAppPageHtml(m,A),k="init"!==t?"amp-hide":"amp-active",b="";if(p){var S="推荐服务";"en_US"==AmpGlobal.currentLang&&(S=$.i18n("recommendedService")),b=$("#tpl-ehall-app-head").html().replace("@recommendedService",S)}if($("#ampRecommendSection").append('<div class="amp-animated ampPageBodyFlag '+k+'" amp-role-id="'+a+'"><div class="amp-ehall-apps ampPageContentFlag">'+p+"</div>"+C+"</div>"),"init"!==t){var y=l(a);AmpUtils.animateMove(y.toShowData,y.toHideData)}$("#"+h).on("click","div",function(){f($(this))})}function d(e,a,t){for(var n="",i="",s=e.length,r=0;r<s;r++){n+=AmpTemplate.getAppCardHtml({data:e[r],customClass:"amp-mr-2 amp-mb-2 amp-ehall-apps-card"});var o=19;if((r+1)%5===0&&0!==r&&(i+='<div class="amp-clearfix-child amp-ehall-apps-line" style="padding:0 '+o+'px;">'+n+"</div>",n=""),r===s-1)if(s<6){var p=(1048-202*s)/2;n&&(i+='<div class="amp-clearfix-child amp-ehall-apps-line" style="padding:0 '+p+'px;">'+n+"</div>");
}else n&&(i+='<div class="amp-clearfix-child amp-ehall-apps-line" style="padding:0 '+o+'px;">'+n+"</div>")}var l=a?"":"amp-hide amp-animate-move-right-out";return'<div class="amp-ehall-apps-content amp-animated '+l+'">'+i+"</div>"}function u(e){if(!e.hasClass("amp-active")){e.addClass("amp-active").siblings("div").removeClass("amp-active");var a=e.attr("amp-role-id");p(a)}}function f(e){if(!e.hasClass("amp-active")){var a=e.closest(".ampPageBodyFlag"),t=a.children(".ampPageContentFlag").children(),n=e.parent(),i=e.index(),s=$(t[i]),r=n.find(".amp-active"),o=r.index(),p=$(t[o]),l="",m="";i>o?(l="amp-animate-move-right-in",m="amp-animate-move-left-out"):(l="amp-animate-move-left-in",m="amp-animate-move-right-out"),p.removeClass("amp-animate-move-right-in amp-animate-move-left-in").addClass(m).removeClass("amp-hide"),setTimeout(function(){p.addClass("amp-hide"),s.removeClass("amp-animate-move-right-out amp-animate-move-left-out").addClass(l).removeClass("amp-hide"),r.removeClass("amp-active"),e.addClass("amp-active")},250)}}function g(){var e=window.innerHeight,a=$("#ampEhallArticle"),t=a.children(),n=0;t.each(function(){var e=$(this),a=e.outerHeight();n+=a});var i=$("#ampPageHeader").outerHeight();if(n+i<e){var s=e-n-i;s>144&&(s=.7*s);var r=parseInt(s/2,10)+"px";!AMPConfigure.showLoginPageFlag&&AMPConfigure.fudanEhallCustom?AmpUtils.IsPC()?$("#ampEhallHeader").css({"margin-top":e/4-60+"px","margin-bottom":e-(e/4-60)-240+"px"}):$("#ampEhallHeader").css({"margin-top":e/4-200+"px","margin-bottom":parseInt(s/2,10)-200+"px"}):AmpUtils.IsPC()?$("#ampEhallHeader").css({"margin-top":r,"margin-bottom":r}):$("#ampEhallHeader").css({"margin-top":e/4-200+"px","margin-bottom":parseInt(s/2,10)-200+"px"})}else AmpUtils.niceScrollInit(a.parent())}function v(){var e=AMPConfigure.ehallTitle,a=e.title,t=e.smallTitle,n=$("#ampEhallHeader");"en_US"==AmpGlobal.currentLang?(n.find("h3").html(t),n.find("h3").css("font-size","22px")):(n.find("h3").html(a),n.find("span").html(t))}function h(){$("#bannerSearchInput").keydown(function(e){var a=$("#bannerSearchInput").val();13==e.keyCode&&($("#ampServiceSearchInput").val(a),$("#ampPageHeaderSearch").click(),setTimeout(function(){$("#bannerSearchInput").val("")},100))}),$("#ampLoginInBottomDesc").on("click",".amp-fudan-gunlun-icon",function(){var e=1,a=$("#ampSlidePage").children(".amp-active"),t=a.index(),n=e>t?"down":"up",i=$("body").find('article[role="slide"][slide-index="'+(t+1)+'"]')[0];slide.slideAnimate(n,i)})}e.space={autoEhallIndex:0,autoClassifyIndex:0},e.init=function(){v(),g(),AmpClassify.setClassifyContainerMarginAndNiceScroll();var e=parseInt(AmpDataUtils.space.ampData.userType,10),a=AmpUtils.getUserRoleId(e);t(a),p(a,"init");var i=$("#ampEhallRoleNav").children(".amp-ehall-nav-item.amp-active");n(i),s(i),h(),AmpUtils.setIe9PlaceHolder()}}(window.AmpEhall=window.AmpEhall||{}),function(e,a){function t(e){var a=e.attr("amp-type"),t=e.attr("amp-appid"),s=e.attr("amp-title"),r=(e.attr("amp-favorite"),AmpUtils.moduleName(e)),o={appId:t,appType:a,appTitle:s,moduleName:r};e.hasClass("amp-folder-favorite-btn")?"已收藏"==$.trim(e.find("span").text())||"collected"==$.trim(e.find("span").text())?(i(o),AmpUtils.zhuge("取消收藏应用",{"应用ID":t,"应用名称":e.attr("amp-title"),"来源":r})):n(o):"true"===e.attr("amp-favorite")?(i(o),AmpUtils.zhuge("取消收藏应用",{"应用ID":t,"应用名称":s,"来源":r})):n(o),Wisedu.userActionDataSend("0")}function n(e){AmpOpenFavorite.open(e)}function i(a){AmpDataUtils.unFavoriteApp({appId:a.appId,type:a.appType},function(){var t="  取消收藏";"en_US"==AmpGlobal.currentLang&&(t=$.i18n("collectionCancelled")),AmpPrompt.show({content:a.appTitle+t}),e.favoriteSynchronous(a.appId,"cancel",a.appType),AmpPersonalCenter.getMyFavoriteApps()}),AmpOpenFavorite.unFavoriteCardApp(a)}function s(e,a){"cancel"===a?e.attr("amp-favorite","false"):e.attr("amp-favorite","true"),r(e,a)}function r(e,a){var t=e.attr("amp-appid");if(AmpDataUtils.space.allServiceData)for(var n=AmpDataUtils.space.allServiceData,i=n.searchResult,s=0;s<i.length;s++)if(i[s].type){var r=i[s].appList;i[s].appId==t&&("cancel"===a?i[s].favoriteApp=!1:i[s].favoriteApp=!0);for(var o=0;o<r.length;o++)r[o].appId==t&&("cancel"===a?r[o].favoriteApp=!1:r[o].favoriteApp=!0)}else i[s].appId==t&&("cancel"===a?i[s].favoriteApp=!1:i[s].favoriteApp=!0)}function o(e,a){"cancel"===a?e.attr("amp-favorite","false"):e.attr("amp-favorite","true");var t=$("#ampFolderFavoriteBtn");if(t.attr("amp-appid")==e.attr("amp-appid"))if("cancel"===a){var n="收藏";"en_US"==AmpGlobal.currentLang&&(n=$.i18n("collect")),t.addClass("amp-active").find("span").html(n)}else{var n="已收藏";"en_US"==AmpGlobal.currentLang&&(n=$.i18n("collected")),t.removeClass("amp-active").find("span").html(n)}r(e,a)}function p(e){if(e.hasClass("appTitleFlag")&&0===e.find("#ampAppFavIcon").length){var a=e.closest(".appFlag"),t=a.attr("amp-appid"),n=a.attr("amp-favorite"),i="amp-active";"true"!==n&&(i="");var s=parseInt(e.attr("amp-fav-icon-r"),10),r=parseInt(e.attr("amp-fav-icon-t"),10),o={};(s||0===s)&&(o.right=s+""),(r||0===s)&&(o.top=r+""),e.append(m(t,i,o))}}function l(e){$(e.relatedTarget).closest("#ampAppFavIcon").length>0||$("body").find("#ampAppFavIcon").remove()}function m(e,a,t){var n="";return t.right&&(n+="right: "+t.right+"px;"),t.top&&(n+="top: "+t.top+"px;"),'<div id="ampAppFavIcon" class="amp-app-card-favorite '+a+'" style="'+n+'"><i class="iconfont icon-aixin" amp-appid="'+e+'"></i></div>'}e.eventsListen=function(){var e=$("body");e.on("mouseover",".appFlag",function(e){var a=$(this),t=a.find(".appTitleFlag");t.length>0?p(t):a.hasClass("appTitleFlag")&&p(a)}),e.on("mouseout",".appFlag",function(e){l(e)}),e.on("mouseover",".amp-hover-app-card-group",function(e){var a=$(this),t=a.find(".appTitleFlag");t.length>0?p(t):a.hasClass("appTitleFlag")&&p(a)}),e.on("mouseout",".amp-hover-app-card-group",function(e){l(e)}),e.on("click","#ampAppFavIcon",function(e){AmpGlobal.loginFlag?t($(this).closest(".appFlag")):AmpUtils.goLoginPage(),e.stopPropagation()})},e.favoriteHandle=function(e){t(e)},e.favoriteSynchronous=function(e,a,t){"0"==t?$("body").find('.appFlag[amp-appid="'+e+'"]').each(function(){s($(this),a)}):$("body").find('.appFlag[amp-appid="'+e+'"]').each(function(){o($(this),a)})}}(window.AmpFavorite=window.AmpFavorite||{}),function(a,t){function n(e){var a=e.attr("amp-appid");AmpDataUtils.getFolderData(a,function(a){i(e,a)})}function i(e,a){var t=(e.attr("amp-appid"),a.appName),n=a.appList,i=n.length,r="收藏",o="amp-active",p=e.attr("amp-favorite");"en_US"==AmpGlobal.currentLang&&(r=$.i18n("collect")),"true"==p&&(r="已收藏",o="amp-favorite","en_US"==AmpGlobal.currentLang&&(r=$.i18n("collected")));for(var l="",m=0;m<i;m++){var c=n[m],d=AmpTemplate.getAppCardSingleHtml(c),u=AmpTemplate.getServiceAppCardHtml({data:c,favoriteClass:""});l+=AmpTemplate.getAppCardGroupHtml(d+u)}var f=AmpTemplate.getFolderHtml().replace("@title",t).replace("@tipTitle",t).replace("@appCount",i).replace("@appList",l).replace("@favoriteText",r).replace("@favoriteBtnClass",o);$("body").append(f),s(),AmpUtils.copyAppAttributesFromDomToDom(e,$("#ampFolderFavoriteBtn")),$("body").find(".ampLoadActiveFlag").addClass("amp-loaded-hide").removeClass("amp-loaded-active")}function s(){var a=$("#ampFolder");a.on("click",".icon-chacha",function(){r()}),a.on("click",".amp-folder-favorite-btn",function(){if(AmpGlobal.loginFlag){var a=$(this);AmpFavorite.favoriteHandle(a)}else AmpUtils.goLoginPage();e.stopPropagation()})}function r(){$("#ampFolder").remove(),$("body").find(".ampLoadActiveFlag").removeClass("amp-loaded-hide").addClass("amp-loaded-active")}a.open=function(e){n(e),AmpUtils.niceScrollInit($("#ampFolderAppList"))}}(window.AmpFolder=window.AmpFolder||{}),function(e,a){e.rotateYTimeStep=50,e.loginFlag=!1,e.showLoginPageFlag=!0,e.platformType="1",e.animateTimes=450,e.animateTimesFast=200,e.blurDegree=40,e.lang={zh:"zh_CN",en:"en_US"},e.currentLang=e.lang.zh,e.personalCenter={leftAsideWidth:424,leftAsideWidthPure:416,widgetWidth:556,rightAsideNormal:320,rightAsideMini:72,paddingLeft:16}}(window.AmpGlobal=window.AmpGlobal||{}),function(e,a){function t(a){var t=$(a.target||a.srcElement);"ampPageHeaderSearchClose"!==t.attr("id")&&(e.searchBoxFocus(),e.searchBoxBlur(),$("#ampServiceArticle").hasClass("amp-active")||(AmpServiceCenter.init(),e.openServiceSearch()))}function n(e){var a=e.keyCode;13===a&&AmpServiceCenter.init()}function i(e){var a=$("#ampPageHeader");"active"===e?a.addClass("ampServiceActiveFlag"):a.removeClass("ampServiceActiveFlag")}function s(e){c();var a=AmpUtils.getContainerPosition(e),t=$("#ampHeaderUserInfo");t.css({left:parseInt(a.right-t.outerWidth())+"px",top:parseInt(a.bottom+4,10)+"px"}).toggleClass("amp-active")}function r(e){var a=AmpUtils.getContainerPosition(e),t=$("#ampHeaderUserSkin");t.css({left:parseInt(a.right-344)+"px",top:parseInt(a.bottom+4,10)+"px"}).toggleClass("amp-active"),t.hasClass("amp-active")?e.find("i").addClass("amp-keep"):e.find("i").removeClass("amp-keep")}function o(e){var a=AmpUtils.getContainerPosition(e),t=$("#ampHeaderExpand");t.css({left:parseInt(a.right-20)+"px",top:parseInt(a.bottom+4,10)+"px"}).toggleClass("amp-active")}function p(e){var a=AmpUtils.getContainerPosition(e),t=$("#ampHeaderHelpInfo");t.css({left:parseInt(a.right-120)+"px",top:parseInt(a.bottom+4,10)+"px"}).toggleClass("amp-active"),t.hasClass("amp-active")?e.find("i").addClass("amp-keep"):e.find("i").removeClass("amp-keep")}function l(e){var a=AmpUtils.getContainerPosition(e),t=$("#ampInterNationUeBox"),n=$("#ampInternationTool"),i=n.find("span:not(.amp-hide)").width(),s=14;t.css({left:parseInt(a.right-(i+s))+"px",top:parseInt(a.bottom+20,10)+"px"}).toggleClass("amp-active")}function m(){$("#ampServiceLabelNav").find(".amp-active").removeClass("amp-active")}function c(){var e=$("#ampHeaderUserSkin"),a=$("#ampHeaderToolSkin"),t=e.hasClass("amp-active");t&&(e.removeClass("amp-active"),a.find("i").removeClass("amp-keep"))}function d(){var e=AmpUtils.getScreenWidthHeight(),a=($("#iframeList"),e.screenH-44),t=a;return{height:t,width:e.screenW}}function u(){var e=$("#ampHeaderExpand");e.removeClass("amp-active")}function f(a,t,n){var i=$("#ampHeaderUserSkin");i.find(".bh-skin-layer").addClass("bh-skin-layer-active"),AmpLoading.show(),I=!1;t.skinName,t.themeColor;e.loadingCurrentSkin(t)}function g(e){var a=AMPConfigure.portalSkin_custom,t=AMPConfigure.resSkinCssPath;if("undefined"!=typeof a&&(skinList=a.length,skinList>0))for(var n=0;n<skinList;n++){var i=a[n];if(i.enable&&i.skinColor==e){t="portal_custom/css/";break}}return t}function v(e,a){var t=$("#ampHeaderUserSkin");$("head").find("link").each(function(){var n=$(this),i=n.attr("href"),s=new RegExp(e+"/"+a,"");(/\/amp.min.css$/.test(i)||/\/skin.min.css$/.test(i)||/\/amp_custom.css$/.test(i))&&(s.test(i)||(n.remove(),t.find(".bh-skin-layer").removeClass("bh-skin-layer-active")))})}function h(e,a,t){var n=!1;if($("head").find("link").each(function(){var i=$(this),s=i.attr("href");new RegExp(a+"/"+t,"");(/\/amp.min.css$/.test(s)||/\/skin.min.css$/.test(s))&&s==e&&(n=!0)}),!n){var i=document.getElementsByTagName("head")[0],s=document.createElement("link");s.type="text/css",s.rel="stylesheet",s.href=e,i.appendChild(s),s.onload=function(){A(a,t)},(navigator.userAgent.indexOf("MSIE")>0||AmpUtils.isIE())&&(s.onreadystatechange=function(){"loaded"!==s.readyState&&"complete"!==s.readyState||A(a,t)})}}function A(e,a){var t=document.getElementsByTagName("head")[0];P++,2===P&&(I=!0,P=0,AmpLoading.close(),setTimeout(function(){if(v(e,a),AMPConfigure.portalTheme_custom){var n=document.createElement("link");n.type="text/css",n.rel="stylesheet",n.href="portal_custom/css/"+e+"/amp_custom.css",t.appendChild(n)}},100))}function C(){var e=$("#ampDesktopSet"),a=e.parent().parent();a.length&&a.hasClass("amp-active")&&$("#ampDesktopSet").find(".amp-desktop-set-close-icon").click()}function k(){var e=$("#ampServiceArticle");e.hasClass("amp-active")?(e.addClass("ampCurrentBootPageFlag"),$("#ampPageHeaderSearchClose").click(),setTimeout(function(){b()},450)):b()}function b(){var e=$("#ampBootPage"),a=$("#ampPersonalArticle"),t=$("#ampEhallBody"),n=$("#ampHeaderNav"),i=($("#ampServiceArticle"),n.find("i.amp-active").attr("id"));"ampPageHeaderHomeIcon"==i?t.addClass("amp-opcity-bottom"):"ampPageHeaderPersonalIcon"==i&&a.removeClass("amp-active").addClass("amp-hide");var s=$("#tpl-bootpage-img-gif").html();$("#ampBootMainSide").html(s),e.removeClass("amp-hide").addClass("amp-active"),AmpBootPage.init()}function S(e){var a=e;AmpDataUtils.setCurrentLocale(a,function(e){"success"==e.result&&(console.log("中英文切换成功！"),AmpGlobal.currentLang=a,AmpUtils.setCookie("amp.locale",a),localStorage.localeLang=a,AmpHeader.changeLanguage(),localStorage.changeLanguageFlag="true",window.location.reload())})}function y(){$("#ampSearchNameBox").remove()}function w(){for(var e="",a=window.location.host,t=window.location.pathname,n=t.split("/"),i="",s=0;s<n.length;s++)s==n.length-1?i+="/index_teacher.html":""!=n[s]&&(i+="/"+n[s]);e=a+i,window.location.href=window.location.protocol+"//"+e}e.space={showDetailFlag:"null",showIframeList:!1},e.eventsListen=function(){$("#ampPageHeaderSearch").on("click",function(a){var n=$(a.currentTarget),s=$(a.target||a.srcElement);"ampPageHeaderSearchClose"!=s.attr("id")&&n.find("#ampServiceSearch").hasClass("amp-hide")&&AmpUtils.zhuge("访问搜索中心",{"来源":"页面顶部搜索栏"}),$("#ampPersonalArticle").removeClass("ampLoadActiveFlag"),$("#ampServiceArticle").addClass("ampLoadActiveFlag"),$("#ampEhallBody").removeClass("ampLoadActiveFlag"),$("#ampExtend").addClass("amp-hide"),$("#ampInternationTool").addClass("amp-hide");var r=$("#iframeList"),o=r.css("display");"block"==o&&(e.space.showIframeList=!0,r.css("display","none"));var p=$("body").find('[amp-role="dialog"]');p.length?(p.removeClass("amp-active"),setTimeout(function(){p.remove(),i("active"),t(a)},AmpGlobal.animateTimes)):(i("active"),t(a),$("#ampServiceArticle").hasClass("amp-active")||m(),$("#ampServiceArticle").hasClass("amp-active")&&$("#ampPageHeader").addClass("amp-service-header"),(navigator.userAgent.indexOf("MSIE")>0||AmpUtils.isIE())&&($("#ampPersonalAsideLeftMyFavorite").getNiceScroll().remove(),$("#ampDesktopContent").getNiceScroll().remove(),$("#ampPersonalAsideRightTask").getNiceScroll().remove(),$("#ampTagMessages").getNiceScroll().remove(),$("#ampCategoryTabContent").getNiceScroll().remove())),C(),obj=$(a.srcElement||a.target),"ampServiceHistoryBox"!=obj.parent().parent().attr("id")&&"ampServiceHistoryBox"!=obj.parent().attr("id")&&"ampServiceHistoryBox"!=obj.attr("id")&&$("#ampServiceSearchInput").focus()}),$("#ampServiceSearch").on("keyup",".ampserviceSearchInputFlag",function(e){n(e)}),$("#ampPageHeaderSearchIcon").on("click",function(e){$("#ampPageHeaderSearch").hasClass("amp-active")&&AmpServiceCenter.init()}),$("#ampPageHeaderSearchClose").on("click",function(a){e.closeServiceSearch(),y(),$("#ampServiceArticle").removeClass("ampLoadActiveFlag"),$("#ampPageHeader").removeClass("amp-service-header"),i("restore"),AmpServiceCenter.showPage("hide"),e.searchRestore(),setTimeout(function(){var a=$("#ampPageHeader"),t=a.find("nav .amp-tab-item.amp-active").attr("id");if("ampPageHeaderPersonalIcon"==t?($("article.amp-personal.amp-hide").addClass("amp-active").removeClass("amp-hide"),$("#ampPersonalArticle").addClass("ampLoadActiveFlag"),(navigator.userAgent.indexOf("MSIE")>0||AmpUtils.isIE())&&(AmpUtils.niceScrollInit($("#ampPersonalAsideLeftMyFavorite")),AmpUtils.niceScrollInit($("#ampDesktopContent")),AmpUtils.niceScrollInit($("#ampPersonalAsideRightTask")),AmpUtils.niceScrollInit($("#ampTagMessages")),AmpUtils.niceScrollInit($("#ampCategoryTabContent"))),$("#ampInternationTool").removeClass("amp-hide"),AmpUtils.zhuge("进入个人中心",{"来源":"搜索中心点关闭搜索按钮"})):($("#ampEhallBody").find("article.amp-hide").removeClass("amp-hide").addClass("amp-active"),$("#ampEhallBody").addClass("ampLoadActiveFlag")),$("#ampPageHeaderExpandIcon").hasClass("amp-active")&&$("#iframeList").css("display","block"),$("#ampPageBgCover").addClass("amp-hide").removeClass("amp-active"),$("#ampSlidePage").removeClass("amp-hide"),$("#ampExtend").removeClass("amp-hide"),e.space.showIframeList){var n=$("#iframeList");n.css("display","block")}},450)}),$("#ampPageHeaderHomeIcon").on("click",function(a){AmpUtils.zhuge("访问办事大厅",{}),$("#bannerSearchInput").val(""),!AMPConfigure.showLoginPageFlag&&AMPConfigure.fudanEhallCustom&&$("#ampEhallSlideIndex").hasClass("amp-active")&&AmpUtils.animateLoginIn(),$("#ampLoginInArticle").hasClass("amp-active")&&AmpUtils.animateLoginIn(),$("#ampExtend").removeClass("amp-hide"),$("#ampInternationTool").addClass("amp-hide");var t=$("#iframeList");t.css("display","none"),e.space.showIframeList=!1,$("#ampPersonalArticle").removeClass("ampLoadActiveFlag").removeClass("amp-loaded-active"),$("#ampServiceArticle").removeClass("ampLoadActiveFlag").removeClass("amp-loaded-active"),$("#ampEhallBody").addClass("ampLoadActiveFlag"),$("#iframeList").css("display","none"),$("#ampEhallBody").removeClass("amp-hide"),setTimeout(function(){$("#ampPersonalArticle").removeClass("amp-active")},150),u(),m(),y(),e.closeServiceSearch(),$("#ampPageHeader").removeClass("amp-service-header");var n=$("#ampPageBgCover");$("#ampEhallBody").find("article.amp-hide").removeClass("amp-hide").addClass("amp-active"),n.hasClass("amp-hide")||(n.removeClass("amp-active").addClass("amp-hide"),$("#ampSlidePage").removeClass("amp-hide")),$("#ampServiceArticle").addClass("amp-hide").removeClass("amp-active");var i=$("#ampPersonalArticle");i.removeClass("amp-active"),AmpPersonalCenter.hideMainWidgets();var s=$("#ampEhallBody");s.removeClass("amp-hide"),$("#ampPageHeaderHomeIcon").addClass("amp-active"),$("#ampPageHeaderPersonalIcon").removeClass("amp-active"),$("#ampPageHeaderExpandIcon").removeClass("amp-active"),s.hasClass("ampLoadedFlag")||(AmpLoginIn.init(),AmpEhall.init(),s.addClass("ampLoadedFlag")),C()}),$("#ampExtend").on("click",".amp-extend-more",function(){o($("#ampExtendMore"))}),$("body").on("click",".extendItemFlag",function(){var e=$("#iframeList");e.css("display","block"),$("#ampPersonalArticle").removeClass("amp-active"),$("#ampEhallBody").addClass("amp-hide"),$("#ampLoadingPage").addClass("amp-hide");var a=$(this).attr("data-url"),t=$(this).attr("data-menu-id"),n=e.find('iframe[data-menu-id="'+t+'"]'),i=n.length;if(i)n.css("opacity","1"),n.siblings("iframe").css("opacity","0");else{e.children().css("opacity","0");var s="opacity:1;position: absolute;width:100%;",r=d();e.css({top:"44px",height:r.height+"px"}),s+="height:"+r.height+"px;";var o='<iframe data-menu-id="'+t+'"  data-type="loading" src="'+a+'" allowtransparency="true" frameborder="0" scrolling="yes" style="'+s+'"></iframe>';e.append(o)}var p=$(this).attr("data-name");AmpUtils.zhuge("打开拓展URL",{"拓展URL名称":p,"拓展URL地址":a})}),$("#ampPageHeader").on("click",".amp-service-searchHistory-item",function(){var e=$(this).text();$("#ampPageHeaderSearchInput").val(e),AmpServiceCenter.init()}),$("#ampPageHeaderPersonalIcon").on("click",function(a){var t="";$("#ampPageHeaderHomeIcon").hasClass("amp-active")&&$("#ampEhallBody").hasClass("amp-hide")?t="登陆后":$("#ampPageHeaderHomeIcon").hasClass("amp-active")&&$("#ampEhallBody").hasClass("ampLoadActiveFlag")?t="办事大厅点个人中心按钮":$("#ampServiceArticle").hasClass("amp-active")&&(t="搜索中心点个人中心按钮"),$("#ampExtend").removeClass("amp-hide"),$("#ampInternationTool").removeClass("amp-hide");var n=$("#iframeList");n.css("display","none"),e.space.showIframeList=!1,$("#ampPersonalArticle").addClass("ampLoadActiveFlag"),$("#ampServiceArticle").removeClass("ampLoadActiveFlag"),$("#ampEhallBody").removeClass("ampLoadActiveFlag"),$("#ampServiceArticle").removeClass("ampLoadActiveFlag").removeClass("amp-loaded-active"),$("#iframeList").css("display","none"),m(),u(),e.closeServiceSearch(),y(),$("#ampPageHeader").removeClass("amp-service-header");var i=$("#ampPageBgCover");if(i.hasClass("amp-hide")||i.removeClass("amp-active").addClass("amp-hide"),AmpUtils.niceScrollInit($("#ampDesktopContent")),AmpUtils.niceScrollInit($("#ampPersonalAsideRightTask")),AmpUtils.niceScrollInit($("#ampTagMessages")),AmpUtils.niceScrollInit($("#ampCategoryTabContent")),AmpGlobal.loginFlag){$("#ampPageBgImg").addClass("amp-page-img"),$("#ampEhallBody").addClass("amp-hide"),$("#ampServiceArticle").addClass("amp-hide").removeClass("amp-active");var s=$("#ampPersonalArticle");s.addClass("amp-active").removeClass("amp-hide"),s.hasClass("ampLoadedFlag")?AmpPersonalCenter.showMainWidgets():(AmpPersonalCenter.init(),s.addClass("ampLoadedFlag")),$("#ampPageHeaderHomeIcon").removeClass("amp-active"),$("#ampPageHeaderPersonalIcon").addClass("amp-active"),$("#ampPageHeaderExpandIcon").removeClass("amp-active"),AmpUtils.containerBlurAnimate($("#ampPageBgImg"),"restore"),"0"!=AmpGlobal.platformType&&AmpDataUtils.getUserFirstLogin(function(e){e.isFirstLogin,e.isReadGuidePage;if(e.isFirstLogin&&!e.isReadGuidePage){var a=$("#ampBootPage"),t=$("#tpl-bootpage-img-gif").html();$("#ampBootMainSide").html(t),s.removeClass("amp-active").addClass("amp-hide"),a.removeClass("amp-hide").addClass("amp-active"),AmpBootPage.init(),AmpUtils.zhuge("播放引导动画",{"来源":"首次进入"})}}),AmpUtils.zhuge("进入个人中心",{"来源":t})}else AmpUtils.goLoginPage();C()}),$("#ampNoLoginTool").on("click",function(){AmpUtils.goLoginPage()}),$("#ampHeaderToolUser").on("click",function(){s($("#ampHeaderToolUser"))}),$("#ampHeaderToolUserName").on("click",function(){s($("#ampHeaderToolUserName"))}),$("#ampHeaderToolSkin").on("click",function(){r($("#ampHeaderToolSkin"))}),$("#ampHeaderToolFeedback").on("click",function(){p($("#ampHeaderToolFeedback"))}),$("#ampShellHeaderToolFeedback").on("click",function(){c(),$(this).find("i").addClass("amp-keep"),AmpFeedback.window({uploadUrl:AMPConstant.requestPath+AMPConstant.APIList.feedbackImgUpload,submitUrl:AMPConstant.jsonpRequestPath+AMPConstant.APIList.feedbackSubmit})}),$("#ampInternationTool").on("click",function(){l($("#ampInternationTool"))}),$("body").on("click",".amp-internation-ue-box",function(e){var a=$(e.target||e.srcElement),t=a.closest("li");if(t.hasClass("ampItemLang")){var n=t.attr("data-lang");S(n);var i=t.children("span").text();AmpUtils.zhuge("切换中英文",{"选择语言":i})}}),$("body").on("click","#ampHeaderUserInfoLogoutBtn",function(e){var a=$(e.target||e.srcElement);"ampHeaderUserInfoLogoutBtn"===a.attr("id")&&AmpUtils.logout()}),$("body").on("click","#ampHeaderUserInfoAdminBtn",function(e){var a=$(e.target||e.srcElement);"ampHeaderUserInfoAdminBtn"===a.attr("id")&&window.open(AMPConstant.requestPath+"manage/index.html")}),$("body").on("click","#ampHeaderPersonalCenter",function(e){var a=$(e.target||e.srcElement);"ampHeaderPersonalCenter"===a.attr("id")&&window.open(AMPConfigure.personalCenterAuthserverUrl)}),$("body").on("click","#ampPortalSiteModel",function(e){var a=$(e.target||e.srcElement);if("ampPortalSiteModel"===a.attr("id")){var t="1",n={};n.siteType=t,AmpDataUtils.switchSkin(n,function(e){"success"==e.result&&w()})}}),$("#ampHeaderNoReadMessage").on("click",function(){window.open("portal/html/message/scenes_message_center.html")}),$("body").on("click",".amp-skin-close",function(e){$(e.target).closest(".amp-header-user-skin").removeClass("amp-active"),$("#ampHeaderToolSkin").find("i").removeClass("amp-keep")}),$("body").on("click",".amp-header-help-info",function(e){var a=$(e.target||e.srcElement);"ampHelpFeedbak"===a.attr("id")?AmpFeedback.window({uploadUrl:AMPConstant.requestPath+AMPConstant.APIList.feedbackImgUpload,submitUrl:AMPConstant.jsonpRequestPath+AMPConstant.APIList.feedbackSubmit}):"ampHelpBootpage"===a.attr("id")&&(k(),AmpUtils.zhuge("播放引导动画",{"来源":"重放引导动画"})),$("#ampHeaderHelpInfo").removeClass("amp-active"),$("#ampHeaderToolFeedback").find("i").removeClass("amp-keep")}),$(document).click(function(e){e=window.event||e,obj=$(e.srcElement||e.target);var a=obj.parent().attr("id");if("ampHeaderToolFeedback"!=a&&"ampHeaderHelpInfo"!=obj.closest(".amp-header-help-info").attr("id")&&($("#ampHeaderHelpInfo").removeClass("amp-active"),$("#ampHeaderToolFeedback").find("i").removeClass("amp-keep")),"ampExtendMore"!=obj.attr("id")&&"ampHeaderExpand"!=obj.attr("id")&&"ampHeaderExpand"!=obj.closest(".amp-header-expand").attr("id")&&u(),"ampHeaderToolSkin"!=a&&"ampHeaderUserSkin"!=obj.closest(".amp-header-user-skin").attr("id")&&c(),"ampInternationTool"!=obj.parent().attr("id")&&"ampInterNationUeBox"!=obj.closest(".amp-internation-ue-box").attr("id")&&$("#ampInterNationUeBox").removeClass("amp-active"),"ampServiceHistoryBox"!=obj.parent().parent().attr("id")&&"ampHistoryBox"!=obj.closest(".amp-service-history-dialog").attr("id")&&$("#ampHistoryBox").remove(),"ampMyFavoriteCreateFolder"!=obj.closest(".amp-myfavorite-create-folder").attr("id")&&"create"!=obj.closest(".myfavorite-create-folder").attr("amp-id")&&AmpMyfavoriteApp.removeCreateFolderDialog(obj),navigator.userAgent.indexOf("MSIE 9.0")>0&&("ampServiceSearchInput"==obj.attr("id")||"ampServiceArticle"!=obj.closest(".amp-service").attr("id")&&"ampPageHeader"!=obj.closest(".amp-header").attr("id")||AmpServiceCenter.searchBoxBlur()),"ampRecommendShowDesktop"!=obj.closest(".amp-recommend-show-desktopnav").attr("id")&&"ampDesktopTitle"!=obj.closest(".desktop-title").attr("id")&&$("#ampRecommendShowDesktop").hide(),"ampDesktopAddBtn"!=obj.attr("id")&&"ampDesktopAddBtn"!=obj.closest(".ampDesktopAddFlag").attr("id")&&"ampAdminNewDesktop"!=obj.closest(".amp-create-desktop").attr("id")&&"emptyDesktopCreate"!=obj.attr("id")){if($("#ampAdminNewDesktop").length>0){$("#ampDesktopAddBtn").removeClass("amp-btn-active");var t=$(".empty-desktop-create");t.length>0&&t.removeClass("amp-btn-active")}var n=$('div[amp-type="dialog"]');n.length>0&&n.remove()}}),$("body").on("click",".amp-header-user-skin",function(e){var t=($("#ampHeaderUserSkin"),$(e.target||e.srcElement)),n=$("#skinSwitchText"),i=$("#ampSkinContent"),s="",r="",o="",p="",l="";if(o=$("#skinSwitch").prop("checked"),o==a&&(o=localStorage.themeColor),"skinSwitch"==t.attr("id")){if(o){var m="开启";"en_US"==AmpGlobal.currentLang&&(m=$.i18n("openSkin")),n.text(m),r="dark",$("#ampPersonalArticle").removeClass("amp-personCenter-bg")}else{var m="关闭";"en_US"==AmpGlobal.currentLang&&(m=$.i18n("closeSkinCool")),n.text(m),r="white",$("#ampPersonalArticle").addClass("amp-personCenter-bg")}s=i.find(".ampSkinUseFlag").attr("amp-skin"),p=i.find(".ampSkinUseFlag").find(".skin-item-name").children("span").text(),l="开启"}else{if("skin-item-check"!=t.attr("class")&&"skin-item-check"!=t.parent().attr("class"))return;var c=t.closest(".amp-skin-item");c.siblings(".amp-skin-item").removeClass("ampSkinUseFlag").addClass("ampSkinCheckFlag"),c.addClass("ampSkinUseFlag").removeClass("ampSkinCheckFlag"),s=c.attr("amp-skin"),r=o?"dark":"white",p=c.find(".skin-item-name").children("span").text(),l="开启"}var d={};d.themeColor=r,d.skinName=s,f($(this),d),AmpDataUtils.switchSkin(d,function(e){"success"==e.result&&(localStorage.themeColor=r,localStorage.skinName=s,localStorage.userSkinHtml=$("#ampSkinContent").html())}),AmpUtils.zhuge("切换主题或皮肤",{"展示模式":l,"皮肤":p})}),$("body").on("click",".amp-wf-body",function(){var e=$(this).closest(".amp-widget").children().attr("widget_title");AmpUtils.zhuge("操作卡片",{"卡片名称":e})})},e.searchBoxFocus=function(){var e=316,a=$("#ampPageHeader"),t=a.children(".amp-header-logo").outerWidth(!0),n=a.children(".amp-header-nav").outerWidth(!0),i=t+n,s=i<=e?e:i+8;$("#ampPageHeaderSearch").addClass("amp-active").css("left",s+"px")},e.searchBoxBlur=function(){var e=$("#ampPageHeaderSearchInput");e.blur(function(){var a=$.trim(e.val());if(!a){var t="搜索服务";"en_US"==AmpGlobal.currentLang&&(t=$.i18n("searchService")),$(this).attr("placeholder",t)}AmpUtils.setIe9PlaceHolder()})},e.searchRestore=function(){$("#ampPageHeaderSearchInput").blur().val(""),$("#ampPageHeaderSearch").removeClass("amp-active").removeAttr("style")},e.changeLanguage=function(e){var t=$.i18n(),n="";e!=a?n=e:(n=AmpUtils.getCookie("amp.locale"),n="undefined"==n?"zh_CN":n),t.locale=n,t.load("portal/i18n/"+t.locale+".json",t.locale).done(function(){$("[data-i18n]").i18n()})},e.openServiceSearch=function(){var e=$("#ampPageHeaderSearch");e.find(".ampHeaderSearchFlag").addClass("amp-hide"),e.find(".ampServiceSearchFlag").removeClass("amp-hide"),$("#ampPageHeaderSearch").css("width","416px")},e.closeServiceSearch=function(){var e=$("#ampPageHeaderSearch");e.find(".ampHeaderSearchFlag").removeClass("amp-hide"),e.find(".ampServiceSearchFlag").addClass("amp-hide")};var P=0,I=!0;e.loadingCurrentSkin=function(e){var a=e.themeColor,t=e.skinName,n=g(t),i=self===parent?n+a+"/":"../css/"+a+"/";self!==parent&&(i=/\/model\./.test(window.location.href)?"../../css/"+a+"/":"../css/"+a+"/"),h(i+t+"/amp.min.css",a,t),h(i+t+"/skin.min.css",a,t)},e.initServiceCenterSousuo=function(){var e="搜索服务",t="历史";if("en_US"==AmpGlobal.currentLang&&(e="Search",t="History"),$("#tpl-serviceCenter-sousuo-input").html()!=a){var n=$("#tpl-serviceCenter-sousuo-input").html().replace("@placeholder",e).replace("@history",t);$("#ampServiceSearch").html(n)}}}(window.AmpHeader=window.AmpHeader||{});var AMP_SPACE={};$(function(){function e(){AmpUtils.setSessionStorageData("schoolId",AMPConfigure.schoolId),AmpUtils.setSessionStorageData("footer",AMPConfigure.footer.normal);var e=JSON.stringify(AMPConfigure);AmpUtils.setLocalStorageData("schoolConfig",e),AmpUtils.setSessionStorageData("schoolConfig",e),AmpUtils.setSessionStorageData("logo",AMPConfigure.logo.normal)}function a(e){var e=e,a="";switch(e){case"blue":a="indigo";break;case"cyan-arctic":a="teal";break;case"green-olive":a="millennium";break;case"red-strawberry":a="cherry";break;case"purple":a="magenta";break;case"yellow-fawn":a="golden";break;default:a=e}return a}function t(){AmpGlobal.showLoginPageFlag=AMPConfigure.showLoginPageFlag;var e=$("#ampEhallSlideIndex"),a=$("#ampClassifyArticle"),t=$("#ampLoginInArticle"),n=$("#ampEhallHeaderContent"),i=$("#ampPageBgImg");if(AmpGlobal.showLoginPageFlag)e.attr("slide-index","2"),a.attr("slide-index","3");else if(t.remove(),n.removeClass("amp-hide"),e.attr("slide-index","1"),e.addClass("amp-active"),a.attr("slide-index","2"),i.removeClass("amp-login-img").addClass("amp-page-img"),!AMPConfigure.showLoginPageFlag&&AMPConfigure.fudanEhallCustom){var s="",r="";r=AmpTemplate.getEhallFudanPageHtml();var o="搜索您需要的服务";"en_US"==AmpGlobal.currentLang&&(o=$.i18n("searchTheServicesYouNeed")),$("#tpl-ehall-fudan").length>0&&(s=$("#tpl-ehall-fudan").html().replace("@pageHtml",r).replace("@placeholderStr",o)),$("#ampEhallSlideIndex").html(s),$("#ampEhallHeaderContent").removeClass("amp-hide");var p=$("#tpl-header-fudan-tab").html();$("#ampHeaderNav").html(p),$("#ampExtend").css("margin-left","300px"),i.addClass("amp-login-img").removeClass("amp-page-img")}else $("#ampFuDanEhallArticle").remove(),$("#ampEhallHeaderContent").removeClass("amp-hide")}function n(e){var e=e.data,a=(e.length,""),t="",n="",i="",s=$("#ampExtend"),r=$(window).width(),o="";!AMPConfigure.showLoginPageFlag&&AMPConfigure.fudanEhallCustom?(o=r/2-468,s.addClass("amp-extend-fudan")):o=r/2-368;for(var p=Math.floor(o/100),l=0;l<e.length;l++){var m=e[l].name,c=e[l].url,d=e[l].wid;l<p?$("#tpl-header-extend-list").length>0&&(a+=$("#tpl-header-extend-list").html().replace("@menuId",d).replace("@menuUrl",c).replace("@dataName",m).replace(/@extendName/g,m)):t+=AmpTemplate.headerExpandItem(e[l])}n=AmpTemplate.headerExpandDialogHtm(t),""!==t?(i=$("#tpl-header-expand-more").html(),s.html(a+i),$("body").append(n)):$("#ampExtend").html(a)}function i(){var e=AmpTemplate.getHeaderInternationHtml();$("body").append(e)}function s(){AmpDataUtils.getCurrentLocale(function(e){if("success"==e.result){AmpGlobal.platformType=e.platformType,slide.init();var a=e.functionEnglishOn,t=e.localeLang;AmpUtils.setCookie("amp.locale",t),localStorage.localeLang=t,"true"==a?(AmpGlobal.currentLang=t,"zh_CN"==t?$("#ampInternationTool").find(".ampInterZhIcon").removeClass("amp-hide"):$("#ampInternationTool").find(".ampInterEnIcon").removeClass("amp-hide")):$("#ampInternationTool").addClass("amp-internation-tool-hide"),
AmpHeader.changeLanguage(t),AmpGlobal.loginFlag?r():(o(),AmpUtils.deleteSessionStorageData("ampUserId"),AmpUtils.deleteSessionStorageData("ampUserId"),AmpUtils.deleteSessionStorageData("ampUserName"),AmpUtils.deleteSessionStorageData("ampUserTypeName"),AmpUtils.deleteSessionStorageData("ampUserDepartment"),AmpUtils.deleteSessionStorageData("ampUserSex"),m("Other")),"0"==AmpGlobal.platformType&&($("#ampInternationTool").remove(),$("#ampHeaderToolSkin").remove()),"en_US"==t&&$("#ampPageHeaderPersonalIcon").attr("data-title","Personal center"),"en_US"==t&&$("#ampPageHeaderHomeIcon").attr("data-title","Service hall")}else console.log("国际化接口调用失败！");AmpHeader.initServiceCenterSousuo()})}function r(){AmpDataUtils.userDesktopInfo("",function(e){var t=e.siteType;if(AmpUtils.setSessionStorageData("ampUserId",$.trim(e.userId)),AmpUtils.setSessionStorageData("ampUserName",$.trim(e.userName)),AmpUtils.setSessionStorageData("userType",$.trim(e.userType)),AmpUtils.setSessionStorageData("userPhoto",$.trim(e.userPhoto)),AmpUtils.setSessionStorageData("roles",JSON.stringify(e.roles)),AmpUtils.setSessionStorageData("displayMode",$.trim(e.displayMode)),AmpUtils.setSessionStorageData("ampUserIp",$.trim(e.userIp)),AmpUtils.setSessionStorageData("ampUserID",$.trim(e.userID)),AmpUtils.setSessionStorageData("ampUserTypeName",$.trim(e.userTypeName)),AmpUtils.setSessionStorageData("ampUserDepartment",$.trim(e.userDepartment)),AmpUtils.setSessionStorageData("ampUserSex",$.trim(e.userSex)),localStorage.ampUserId=$.trim(e.userId),AMPConfigure.switchPortalSiteModel&&"1"==t||m("0"),l(e),AmpGlobal.loginFlag){var i=e.userName;$("#ampHasNoLogin").addClass("amp-hide"),$("#ampHasLogin").removeClass("amp-hide").find("span.amp-username").text(i),$("#ampHasLoginTool").removeClass("amp-hide"),$("#ampHeaderToolUserName").html(e.userName),e.userPhoto&&($("#ampHeaderToolUser").attr("src",e.userPhoto),$("#ampHeaderToolUser").attr("has-photo","1")),AmpUtils.zhuge(e.userId,{"名字":i,"性别":null==e.userSex?"":e.userSex,"所在部门":null==e.userDepartment?"":e.userDepartment,"用户类型":null==e.userTypeName?"":e.userTypeName,"所属学校":e.schoolName},"identify");var s=AmpTemplate.getHeaderUserInfoHtml();$("body").append(s),AmpDataUtils.getTopExtendList(function(e){null!=e.data&&e.data.length>0&&($("#ampExtend").removeClass("amp-hide"),n(e))});var r=$("#ampPersonalArticle"),o=$("#ampPersonalAsideLeftTabHead");"0"==AmpGlobal.platformType?(r.find("#ampPersonalAsideLeftMini").find('[amp-id="canUseCards"]').remove(),r.find("#ampPersonalAsideLeftNormal").find('[amp-id="canUseCards"]').remove(),o.find(".amp-tab-item").css({width:AmpGlobal.personalCenter.leftAsideWidthPure/2+"px"})):o.find(".amp-tab-item").css({width:AmpGlobal.personalCenter.leftAsideWidthPure/3+"px"}),AmpDataUtils.getUserSkin(function(e){var t=e.themeColor,n=e.skinName;if("default"!=t&&""!=t&&null!=t&&void 0!=t||(t=AMPConfigure.themeColor),"default"==n||""==n||null==n||void 0==n){n=AMPConfigure.portalSkin;var i={};i.themeColor=t,i.skinName=n,AmpDataUtils.switchSkin(i,function(e){"success"==e.result&&console.log("默认皮肤插入成功")})}else n=a(n);localStorage.themeColor=t,localStorage.skinName=n;var i={};i.skinName=n,i.themeColor=t;var s=AmpTemplate.getHeaderUserSkinHtml(i);$("body").append(s);var o=$("#skinSwitch"),p=$("#skinSwitchText"),l="开启",m="关闭";"en_US"==AmpGlobal.currentLang&&(m=$.i18n("closeSkinCool"),l=$.i18n("openSkin")),"dark"==t?(r.removeClass("amp-personCenter-bg"),o.prop("checked",!0),p.text(l)):(o.prop("checked",!1),r.addClass("amp-personCenter-bg"),p.text(m)),AmpHeader.loadingCurrentSkin(i)}),$("#ampPageHeaderPersonalIcon").click();var c="帮助",d="问题反馈",u="重放引导动画";"en_US"==AmpGlobal.currentLang&&(c=$.i18n("help"),d=$.i18n("problemFeedback"),u=$.i18n("replayBootAnimation"));var f="";$("#tpl-header-help-info").length>0&&(f=$("#tpl-header-help-info").html().replace("@help",c).replace("@problemFeedback",d).replace("@replayBootAnimation",u)),$("body").append(f),"0"==AmpGlobal.platformType&&$("#ampHelpBootpage").remove(),$("#ampServiceSearch").removeClass("amp-service-search-input-nologin")}p(e)})}function o(){$("#ampNoLoginTool").removeClass("amp-hide"),$("#ampPageHeaderHomeIcon").click(),p()}function p(e){void 0==e&&(e={});var a=parseInt(e.userType,10),t=(AmpUtils.getUserRoleId(a)," 个多类型服务");"en_US"==AmpGlobal.currentLang&&(t=" applications"),AmpDataUtils.getSearchApps({key:"",labels:[]},function(e){void 0!=e.searchResult&&$("#ampHeaderSearchResult").html(e.searchResult.length+t),void 0!=e.lastOnlineAppResult?0==e.lastOnlineAppResult.length?$("#ampHeaderNewAppLabel").html(""):$("#ampHeaderNewAppLabel").html("+"+e.lastOnlineAppResult.length).addClass("amp-active"):$("#ampHeaderNewAppLabel").html("")})}function l(e){var a=e.siteType;e.hasDefaultDesktopAuth;if(AMPConfigure.switchPortalSiteModel&&"1"==a){for(var t="",n=window.location.host,i=window.location.pathname,s=i.split("/"),r="",o=0;o<s.length;o++)o==s.length-1?r+="/index_teacher.html":""!=s[o]&&(r+="/"+s[o]);t=n+r,window.location.href=window.location.protocol+"//"+t}}function m(e){if(AMPConstant.operationAnalysisRequestPath){if("undefined"!=typeof Wisedu){Wisedu.userActionDataSend(e);var a=sessionStorage.ampUserIp,t=sessionStorage.userType;Wisedu.userActionDataSendNew(a,t)}}else"undefined"!=typeof Wisedu&&Wisedu.userActionDataSend(e)}t(),AmpHeader.eventsListen(),AmpUtils.bodyEventsListen(),AmpFavorite.eventsListen(),AmpApp.eventsListen(),AmpWidgetCustom.eventsListen(),AmpUtils.tooltipInit(),e(),i(),s()}),function(e,a){function t(){return'<div class="amp-loading-breath"><div></div><div></div></div>'}function n(){return'<div class="amp-loading-reverse"></div>'}e.show=function(e){var a={};e&&"breath"===e.type?a.html=t():a.html=n(),e&&e.container&&(a.customClass="amp-loading-in"),e&&e.customClass&&a.customClass&&(a.customClass+=" "+e.customClass);var i=AmpTemplate.getLoadingFrameHtml(a);e&&e.container?e.container.append(i):$("body").append(i)},e.close=function(e){var a=null;a=e&&e.container?e.container:$("body");var t=a.children('div[amp-role="loading"]');t.length>0?t.remove():a.find('div[amp-role="loading"]').remove()}}(window.AmpLoading=window.AmpLoading||{}),function(e,a){function t(){var e=AMPConfigure.ehallTitle,a=e.title,t=e.smallTitle,n=$("#ampLoginHeader");"en_US"==AmpGlobal.currentLang?(n.find("h3").html(t),n.find("h3").css("font-size","22px")):(n.find("h3").html(a),n.find("span").html(t))}function n(){var e,a=AMPConfigure.ehallTitle,t=a.title,n=a.smallTitle;e="en_US"==AmpGlobal.currentLang?$("#tpl-header-en").html().replace("@enTitle",n):$("#tpl-header").html().replace("@title",t).replace("@enTitle",n);var i=$("#ampEhallBody");i.append(e),setTimeout(function(){var e=$("#ampLoginHeader").offset();$("#ampTplHeader").css({top:e.top,left:e.left}),$("#ampEhallHeaderContent").css({left:e.left})},AmpGlobal.animateTimes+10)}e.init=function(){AmpGlobal.showLoginPageFlag&&(t(),e.setLoginConteinerMargin(),e.eventsListen(),e.hasLogin(),n())},e.setLoginConteinerMargin=function(){var e=window.innerHeight,a=$("#ampLoginRoleNav").outerHeight(!0),t=e-a-24,n=(parseInt(t/2,10),$("#ampLoginRoleNav")),i=$("#ampLoginRoleNav").height(),s=(e-128-i)/2;AmpUtils.IsPC()||(s/=2),n.css({"padding-top":s,"padding-bottom":s})},e.eventsListen=function(){$("#ampLoginArticle").on("click",".amp-has-nologin-btn",function(){AmpUtils.goLoginPage()}),$("#ampLoginInBottomDesc").on("click",".icon",function(){var e=1,a=$("#ampSlidePage").children(".amp-active"),t=a.index(),n=e>t?"down":"up",i=$("body").find('article[role="slide"][slide-index="'+(t+1)+'"]')[0];slide.slideAnimate(n,i)})},e.hasLogin=function(){var e=$("#ampHasNoLogin"),a=$("#ampHasLogin");if(AmpGlobal.loginFlag){var t=AmpUtils.getSessionStorageData("ampUserName");e.addClass("amp-hide"),a.removeClass("amp-hide"),a.find("span.amp-username").text(t)}else e.removeClass("amp-hide"),a.addClass("amp-hide")}}(window.AmpLoginIn=window.AmpLoginIn||{}),function(e,a){function t(e){AmpDataUtils.getUserFavFolders(function(a){n(a,e)})}function n(e,a){var t=e.userFavFolders,n=t.length,s="",r="amp-active",o="收藏夹";"en_US"==AmpGlobal.currentLang&&(o=$.i18n("favorite")),s+=$("#tpl-favorite-folder-item").html().replace("@folderId","0").replace("@folderName",o).replace("@activeClass",r);for(var p=0;p<n;p++){var l=t[p],m=l.folderName,c=l.wid;r="",s+=$("#tpl-favorite-folder-item").html().replace("@folderId",c).replace("@folderName",m).replace("@activeClass",r)}var d="新建",u="新建文件夹",f="5";"en_US"==AmpGlobal.currentLang&&(d=$.i18n("create"),u=$.i18n("newFolder"),f=$.i18n("folderLength")),s+=$("#tpl-favorite-folder-create").html().replace("@create",d).replace("@newFolder",u).replace("@folderLength",f).replace("@folderLength",f);var g="选择文件夹",v=a.appTitle;v.length>10&&(v=v.substr(0,10)+"...");var h="您收藏的<span class='appTitleColor' title='"+a.appTitle+"'>"+v+"</span>应用将会被放入指定文件夹中",A="收藏";"en_US"==AmpGlobal.currentLang&&(g=$.i18n("chooseFolder"),h=$.i18n("putInSpecificFolder"),A=$.i18n("collect"));var C=$("#tpl-app-favorite").html().replace("@folderContrent",s).replace("@appId",a.appId).replace("@appType",a.appType).replace("@appName",a.appTitle).replace("@chooseFolder",g).replace("@putInSpecificFolder",h).replace("@collect",A).replace("@moduleName",a.moduleName);$("body").append(C),i(),AmpUtils.niceScrollInit($("#ampFavoriteFolders")),AmpUtils.setIe9PlaceHolder()}function i(){var a=$("#ampFavorite");a.on("click",".amp-favorite-detail-folder-item",function(){l($(this))}),a.on("click",".icon-chacha",function(){$("#ampFavorite").remove()}),a.on("click",".amp-favorite-detail-btn",function(){var e=$(this).closest(".amp-favorite-detail-container").find(".favoriteDetailFolderInputFlag").hasClass("amp-active");e||r()}),a.on("blur",".amp-favorite-detail-input",function(e){o()}),a.on("compositionstart",".amp-favorite-detail-input",function(){e.space.inputLockFlag=!0}),a.on("compositionend",".amp-favorite-detail-input",function(){e.space.inputLockFlag=!1}),a.on("input",".amp-favorite-detail-input",function(a){if(!e.space.inputLockFlag){var t=$(a.currentTarget).closest(".amp-favorite-detail-input-container");s(t)}})}function s(e){var a=e.find(".amp-favorite-detail-input").val(),t=parseInt(a.length,10);e.find('span[amp-input-role="actual"]').text(t)}function r(){var a=$("#ampFavorite"),t=($("#ampFavoriteFolders"),$("#ampFavoriteFolders").find(".amp-favorite-detail-folder-item.amp-active")),n=t.attr("amp-folder-id"),i=a.attr("amp-favoriteapp-id"),s=a.attr("amp-favoriteapp-type"),r=a.attr("amp-favoriteapp-name"),o=t.find("span").text(),p=a.attr("amp-module-name");AmpDataUtils.favoriteApp({appId:i,type:s,favoriteFolderId:n},function(){var a="  收藏成功";"en_US"==AmpGlobal.currentLang&&(a=$.i18n("collectedSuccessfully")),AmpPrompt.show({content:r+a}),$("#ampFavorite").remove(),e.favoriteCardApp(n,i),AmpFavorite.favoriteSynchronous(i,"active",s),AmpPersonalCenter.getMyFavoriteApps(),AmpUtils.zhuge("收藏应用",{"应用ID":i,"应用名称":r,"收藏文件夹":o,"来源":p})})}function o(){var e=$("#ampFavoriteDetailFolderInput"),a=e.val();a=$.trim(a);var t={};if(!a){var n="请输入文件夹名称";return"en_US"==AmpGlobal.currentLang&&(n=$.i18n("enterFolderName")),AmpPrompt.show({content:n}),void e.focus()}AmpDataUtils.saveUserFavFolder(a,function(e){if("success"==e.result){var n="新建文件夹成功";"en_US"==AmpGlobal.currentLang&&(n=$.i18n("creatFolderSuccess")),AmpPrompt.show({content:n}),t.folderName=a,t.folderId=e.folderId,p(t),AmpUtils.zhuge("新建收藏文件夹",{"文件夹名称":a})}else{var i="创建文件夹失败！";"en_US"==AmpGlobal.currentLang&&(i=$.i18n("failedCreateFolder")),AmpPrompt.show({content:i})}})}function p(e){var a=$("#ampFavoriteFolders"),t=e.folderId,n=e.folderName,i=$("#tpl-favorite-folder-item").html().replace("@activeClass","amp-active").replace("@folderId",t).replace("@folderName",n);a.find(".favoriteDetailFolderInputFlag").removeClass("amp-active").before(i)}function l(e){var e=e;if(e.hasClass("favoriteDetailFolderInputFlag")){var a=$("#ampFavoriteFolders").find(".amp-favorite-detail-folder-item").length;if(a>11)return void AmpPrompt.show({content:$.i18n("folderOutOfLimit")});$("#ampFavoriteDetailFolderInput").val(""),$("#ampFavoriteDetailFolderInput").focus()}e.siblings(".amp-favorite-detail-folder-item").removeClass("amp-active"),e.addClass("amp-active")}function m(){$("body").on("click",".card-myfavorite-li-readd",function(e){var a=$(e.target),t=a.closest(".amp-hover-slow-motion").attr("amp-id");a.closest(".amp-hover-slow-motion").siblings("li").attr("amp-type","amp-hide"),a.closest(".amp-hover-slow-motion").attr("amp-type","amp-active"),$("#cardMyFavoriteContent").find(".card-myFavorite-content-item").attr("amp-isShow","amp-hide"),$("#cardMyFavoriteContent").find('.card-myFavorite-content-item[amp-classify="'+t+'"]').attr("amp-isShow","amp-active")})}e.space={inputLockFlag:!1},e.open=function(e){t(e)},e.unFavoriteCardApp=function(e){var a=$("#cardMyFavoriteContent"),t=$("#cardMyFavoriteContent").find('.appFlag[amp-appid="'+e.appId+'"]'),n=a.find('.card-myFavorite-content-item[amp-isshow="amp-active"]').attr("amp-classify");if(t.length>0){t.parent().remove();var i=$("#card-myfavorite-01"),s=i.find('li[amp-id="'+n+'"]'),r=s.find(".amp-app-count").text();s.find(".amp-app-count").text(parseInt(r)-1);var o="添加应用";if("en_US"==AmpGlobal.currentLang&&(o=$.i18n("addApps")),parseInt(r)-1==0){var p=$("#tpl-card-myfavrite-addapp").html().replace(/@addApp/g,o);a.find('.card-myFavorite-content-item[amp-isshow="amp-active"]').append(p)}}},e.favoriteCardApp=function(e,a){for(var t=AmpDataUtils.space.allServiceData.searchResult,n=$("#cardMyFavoriteContent"),i=0;i<t.length;i++){var s=t[i],r=s.appId;if(r==a){var o=AmpUtils.assemblyAppAttributesToStr(s),p=s.middleIcon,l=s.appName,m=$("#tpl-card-favorite-addApp").html().replace("@attributeBig",o).replace("@appItemmiddleIcon",p).replace("@titleappItemappName",l).replace("@appItemappName",l);n.find('.card-myFavorite-content-item[amp-classify="'+e+'"]').append(m);var c=$("#card-myfavorite-01"),d=c.find('li[amp-id="'+e+'"]'),u=d.find(".amp-app-count").text();d.find(".amp-app-count").text(parseInt(u)+1),parseInt(u)+1>0&&n.find('.card-myFavorite-content-item[amp-classify="'+e+'"]').find(".widget-recommend-item-nodata").remove();break}}},e.favoriteCardSyncAddNewFolder=function(e){var a=e.folderId,t=e.folderName,n=$("#card-myfavorite-01"),i=$("#cardMyFavoriteContent"),s="",r=$("#tpl-card-favorite-addNewFolder").html().replace("@folderId",a).replace("@folderName",t);s=$("#tpl-card-favorite-addNewFolderContent").html().replace("@folderId",a).replace("@activeClass","amp-hide"),n.length>0&&(n.find("ul").append(r),i.append(s),m())},e.favoriteCardSyncDelFolder=function(e){var a=$("#card-myfavorite-01"),t=a.find("ul"),n=$("#cardMyFavoriteContent"),i=!1;$.each(e,function(e){var a=$(this),s=a.attr("amp-id"),r=t.find('li[amp-id="'+s+'"]');"amp-active"==r.attr("amp-type")&&(i=!0),r.remove(),n.find('div.card-myFavorite-content-item[amp-classify="'+s+'"]').remove()}),i&&t.find('li[amp-id="0"]').click()}}(window.AmpOpenFavorite=window.AmpOpenFavorite||{}),function(e,a){function t(e){e.on("click",".amp-prompt-close",function(){s(e)})}function n(e){var a=e.outerWidth();e.css({top:"48px",left:"calc(50% - "+parseInt(a/2)+"px)",opacity:1})}function i(e){setTimeout(function(){e&&s(e)},p.hideWaitTime)}function s(e){e.css({opacity:0}),setTimeout(function(){e.remove()},AmpGlobal.animateTimes)}function r(e){var a="",t="";switch(e.state){case"warning":t="amp-warning";break;case"danger":t="amp-danger";break;default:t="amp-success"}return e.stateIconClass=a,e.promptStateClass=t,e}function o(){var e=$("body").find('div[amp-role="prompt"]');e.each(function(){var e=$(this),a=parseInt(e.css("top"),10),t=a+p.margin+p.height;e.css("top",t+"px")})}var p={hideWaitTime:3e3,height:38,margin:4};e.show=function(e){e=r(e);var a=AmpTemplate.getPromptHtml(e),s=$(a);o(),$("body").append(s),n(s),i(s),t(s)}}(window.AmpPrompt=window.AmpPrompt||{});var leaveSearchTimeout=null,leaveSearchFlag=!0;!function(serviceCenter,undefined){function initContainers(e){if(e&&e.labels){labels=e.labels;var a=$("#ampServiceLabelNav");a.find('li[amp-label-flag="all"]').removeClass("amp-active");for(var t=0;t<labels.length;t++)a.find("li[amp-label-id="+labels[t]+"]").addClass("amp-active")}}function clearContainer(e){"init"===e&&($("#ampServiceArticle").children("aside").html(""),$("#ampServiceLabelNav").html(""),$("#ampServiceCenterNewApps").html("")),$("#ampServiceCenterSearchApps").html("")}function getHotApps(e){}function getRecentUseApps(){AmpDataUtils.getrecUseServiceList(function(e){showRecentUseApps(e)})}function getCommendServiceApps(){var e=(parseInt(AmpDataUtils.space.ampData.userType,10),"all");AmpDataUtils.getEhallData(e,function(e){showCommendServiceApps(e)})}function showHotApps(e){for(var a="",t=e.length,n=0;n<t;n++){var i=e[n];a+=AmpTemplate.getSingleAppHtml(i,"single")}var s="热门服务";"en_US"==AmpGlobal.currentLang&&(s=$.i18n("popularService"));var r=AmpTemplate.getAsideAppsHtml({title:"cnStr",apps:a});$("#ampServiceArticle").children("aside").append(r)}function showRecentUseApps(e){var a="",t=e.recUseServiceList,n=t.length;if(0==n)return void getCommendServiceApps();for(var i=0;i<n&&i<10;i++){var s=t[i];a+=AmpTemplate.getSingleAppHtml(s,"single")}var r="最近使用";"en_US"==AmpGlobal.currentLang&&(r=$.i18n("recentlyUsedServices"));var o=AmpTemplate.getAsideAppsHtml({title:r,apps:a});$("#ampServiceArticle").children("aside").append(o)}function showCommendServiceApps(e){if(e.hotRecNewAppList!=undefined){for(var a="",t=e.hotRecNewAppList,n=t.length,i=0;i<n&&i<10;i++){var s=t[i];a+=AmpTemplate.getSingleAppHtml(s,"single")}var r="推荐服务";"en_US"==AmpGlobal.currentLang&&(r=$.i18n("recommendedService"));var o=AmpTemplate.getAsideAppsHtml({title:r,apps:a});$("#ampServiceArticle").children("aside").append(o)}}function getNewApps(e){AmpDataUtils.getSearchApps(e,function(e){showNewApps(e)})}function showNewApps(e){var a=null,t="",n=0;if(e.lastOnlineAppResult!=undefined){a=e.lastOnlineAppResult,n=a.length;for(var i=0;i<n;i++){var s="",r="",o="",p=a[i];s=AmpTemplate.getAppCardSingleHtml(p),r+=AmpTemplate.getServiceAppCardHtml({data:p}),o+=AmpTemplate.getHoverAppHtml({data:p}),t+='<div class="amp-hover-app-card-group amp-pull-left amp-service-center-app-group">'+s+o+"</div>"}var l="最新上架的服务";"en_US"==AmpGlobal.currentLang&&(l=$.i18n("newlyPublishedServices"));var m={title:l,apps:t,count:n},c=AmpTemplate.getBarAppsBlockHtml(m);$("#ampServiceCenterNewApps").html(c),0==n?$("#ampHeaderNewAppLabel").html(""):$("#ampHeaderNewAppLabel").html("+"+n).addClass("amp-active")}}function getSearchApps(e,a){serviceCenter.space.loadCompleteFlag=!1;var t=$.trim($("#ampServiceSearchInput").val()),n="",i=[],s=[],r=[],o=[];if(a&&a.labels)i=a.labels;else{var p="";$("#ampServiceLabelNav").find(".amp-active").each(function(){var e=$(this);"all"!==e.attr("amp-label-flag")&&("1"==e.attr("amp-label-type")?i.push(e.attr("amp-label-id")):"2"==e.attr("amp-label-type")?p=e.attr("amp-label-id"):p+="___"+e.attr("amp-label-id"));var a=$(this).closest(".amp-label-line").children("label").attr("amp-service-id");"1"===a?s.push(e.text()):"2"===a?r.push(e.text()):o.push(e.text())}),""!=p&&i.push(p)}""===t&&0===i.length&&(n="all"),setTimeout(function(){serviceCenter.space.loadCompleteFlag||AmpLoading.show({type:"reverse",container:$("#ampServiceSection")})},500),AmpDataUtils.getSearchApps({key:t,labels:i},function(t){serviceCenter.space.loadCompleteFlag=!0,AmpLoading.close(),showSearchApps(t.searchResult,e,n),showSearchLabels(t.serviceLabels),initContainers(a)}),(t||s.length>0||r.length>0&&o.length>0)&&AmpUtils.zhuge("搜索应用",{"服务角色":s.join(","),"一级服务分类":r.join(","),"二级服务分类":o.join(","),"搜索关键字":t})}function showSearchApps(e,a,t){var n=["A-D","E-H","I-L","M-P","Q-T","U-X","Y-Z","other"];"all"!==t&&(n=["other"]);for(var i=n.length,s={},r=0;r<i;r++){var o=s[n[r]]={};o.html="",o.count=0}var p={},l="";if(e){var m=e.length;if(m){for(var c=0;c<m;c++){var d="",u="",f="",g=e[c],v=g.pinyingFirstChar,h=g.type;if(d=AmpTemplate.getAppCardSingleHtml(g),u=AmpTemplate.getServiceAppCardHtml({data:g}),f+=AmpTemplate.getHoverAppHtml({data:g}),1==g.type)var A=AmpTemplate.getAppCardGroupHtml(d+u);else var A=$("#tpl-hover-service-center-app-card-group").html().replace("@content",d+f);var C="";if("all"!==t)C="other";else if(C=/[A-D]/.test(v)?"A-D":/[E-H]/.test(v)?"E-H":/[I-L]/.test(v)?"I-L":/[M-P]/.test(v)?"M-P":/[Q-T]/.test(v)?"Q-T":/[U-X]/.test(v)?"U-X":/[Y-Z]/.test(v)?"Y-Z":"other",1===h){var k=g.appId;AmpDataUtils.space.folderData[k]=g}s[C].html+=A,s[C].count++}for(var b=0;b<i;b++){var S=n[b],y=s[S];if("other"!==S||0!==y.count){var w="搜索结果";"en_US"==AmpGlobal.currentLang&&(w=$.i18n("searchResult"));var P=!1;"all"!==t&&(P=!0,S=w),p={title:S,apps:y.html,count:y.count,clearClass:P},l+=AmpTemplate.getBarAppsBlockHtml(p)}}}else l=getNoSearchDataHtml()}else l=getNoSearchDataHtml();var I=$("#ampServiceCenterNewApps");"all"!==t?I.addClass("amp-hide"):I.removeClass("amp-hide"),$("#ampServiceCenterSearchApps").append(l)}function getNoSearchDataHtml(){var e="没有找到相关的服务哦",a="搜索结果";"en_US"==AmpGlobal.currentLang&&(e=$.i18n("sorryWeCannotFind"),a=$.i18n("searchResult"));var t={title:a,apps:$("#tpl-search-no-data").html().replace("@sorryWeCannotFind",e),count:0,clearClass:!0};return AmpTemplate.getBarAppsBlockHtml(t)}function showSearchLabels(e){var a=$("#ampServiceLabelNav");if(0===a.text().length){var t=AmpTemplate.getLabelsHtml(e);a.html(t),a.on("click",".amp-label-line-item",function(){if($(this).hasClass("amp-active"))return!1;var a=$(this).attr("amp-label-type");if("2"==a){var t=$("#ampServiceLabelNav");t.find(".serviceCenterSubLabelFlag").remove()}serviceLabelSearch($(this)),$(this).hasClass("hasSubLabelFlag")&&showSubLabels(e,$(this))}),setSearchAppsContainerMinHeight()}}function serviceLabelSearch(e){var a=e.attr("amp-label-flag"),t=e.closest("ul"),n=e.attr("amp-label-type");if("all"!==a){var i=t.find('[amp-label-flag="all"]');i.removeClass("amp-active"),"1"==n?(e.toggleClass("amp-active"),0===t.find("li.amp-active").length&&i.addClass("amp-active")):(e.addClass("amp-active"),e.siblings("li").removeClass("amp-active"))}else t.find("li").removeClass("amp-active"),e.addClass("amp-active");serviceCenter.init()}function eventsListen(){$("#ampServiceCenterSearchApps").on("click",".ampClearFlag",function(){$("#ampServiceLabelNav").find("li").each(function(){var e=$(this);"all"!==e.attr("amp-label-flag")?e.removeClass("amp-active"):e.addClass("amp-active")});var e=$("#ampServiceSearchInput");e.val(""),serviceCenter.init(),$(".serviceCenterSubLabelFlag").hide()});var e="";$("#ampServiceSearch").on("input",".ampserviceSearchInputFlag",function(){if($("#ampHistoryBox").remove(),!$(this).prop("comStart")){var a=$(this).val();e=a,showSearchName(e)}}).on("compositionstart",".ampserviceSearchInputFlag",function(){$(this).prop("comStart",!0)}).on("compositionend",".ampserviceSearchInputFlag",function(){if($(this).prop("comStart",!1),!$(this).prop("comStart")){var a=$(this).val();e=a,showSearchName(e)}}),$("body").on("click",".amp-service-searchName-item",function(){var e=$(this).attr("amp-appname");$("#ampServiceSearchInput").val(e),$("#ampSearchNameBox").remove(),serviceCenter.init()}),$("#ampServiceSearch").on("click","#ampServiceSousuo",function(){serviceCenter.init()}),$("#ampServiceSearch").on("click",".amp-service-history-box",function(){showHistoryBox(),AmpUtils.zhuge("查看搜索记录",{})}),$("#ampServiceSearch").on("mouseover",function(){leaveSearchFlag=!1,clearTimeout(leaveSearchTimeout)}),$("#ampServiceSearch").on("mouseout",function(){leaveSearchFlag=!0,leaveSearchTimeout=setTimeout(function(){leaveSearchFlag===!0&&$("#ampHistoryBox").remove()},500)}),$("body").on("mouseover","#ampHistoryBox",function(){leaveSearchFlag=!1,clearTimeout(leaveSearchTimeout)}),$("body").on("mouseout","#ampHistoryBox",function(){leaveSearchFlag=!0,leaveSearchTimeout=setTimeout(function(){leaveSearchFlag===!0&&$("#ampHistoryBox").remove()},500)})}function setSearchAppsContainerMinHeight(){setTimeout(function(){var e=$("#ampServiceSection"),a=e.offset().top,t=window.innerHeight,n=t-a;e.css("min-height",n+"px")},AmpGlobal.animateTimes+10)}function showSubLabels(e,a){var a=a,t=a.attr("amp-label-id"),n="全部",i="二级分类";"en_US"==AmpGlobal.currentLang&&(n=$.i18n("all"),i=$.i18n("sub-category"));var s="",r=$("#tpl-sub-label-line").html(),o=$("#tpl-sub-label-line-item").html(),p="";if(e){var l=e.length;if(l>0){for(var m=0;m<l;m++)for(var c=e[m],d=c.labels,u=d.length,f=0;f<u;f++){var g=d[f],v=g.labelId,h=g.subLabelList;if(v==t)for(var A=0;A<h.length;A++)0===A&&(p+=o.replace("@labelName",n).replace("@labelId",v).replace("@active","amp-active").replace("@labelFlag","all")),p+=o.replace("@labelName",h[A].lableName).replace("@labelId",h[A].labelId).replace("@active","").replace("@labelFlag","")}s+=r.replace("@serviceId",v).replace("@labelName",i).replace("@labelList",p)}}var C=$("#ampServiceLabelNav");C.append(s)}function showSearchName(searchName){var re=new RegExp(searchName,"i"),searchVal=searchVal,allServiceSearchData="";null!=AmpDataUtils.space.allServiceData&&(allServiceSearchData=AmpDataUtils.space.allServiceData.searchResult);var allServiceSearchLen=allServiceSearchData.length,searchAppList=[];if($("#ampSearchNameBox").remove(),""!=searchName){for(var i=0;i<allServiceSearchLen;i++){var appName=allServiceSearchData[i].appName;re.test(appName)&&searchAppList.push(allServiceSearchData[i])}for(var searchBoxTpl="",searchItems="",j=0;j<searchAppList.length;j++){var appName=searchAppList[j].appName,regappName=appName.replace(eval("/("+searchName+")/ig"),"<span class='amp-service-search-color'>"+searchName+"</span>");searchItems+=$("#tpl-service-searchName-item").html().replace("@appName",regappName).replace("@searchname",appName).replace("@searchname",appName).replace("@mormalImg","portal/images/serviceCenter/u2595.png")}if(""==searchItems){var noData="无相关结果";"en_US"==AmpGlobal.currentLang&&(noData=$.i18n("noData")),searchItems=$("#tpl-service-searchName-nodata").html().replace("@noData",noData)}searchBoxTpl=$("#tpl-service-searchName").html().replace("@searchItems",searchItems),$("body").append(searchBoxTpl);var offserLeft=$("#ampServiceSearchInput").offset().left;offserLeft=AmpGlobal.loginFlag?offserLeft-6+"px":offserLeft+10+"px",$("#ampSearchNameBox").css("left",offserLeft),AmpUtils.niceScrollInit($("#ampSearchNameBox"))}}function showHistoryBox(){AmpDataUtils.userSearchHistory(function(e){var e=e.data,a="",t="";if(e.length>0)for(var n in e){var i=e[n].searchKey;t+=$("#tpl-service-searchName-item").html().replace("@searchname",i).replace("@searchname",i).replace("@appName",i).replace("@mormalImg","portal/images/serviceCenter/u2455.png")}else{var s="暂无数据";"en_US"==AmpGlobal.currentLang&&(s=$.i18n("noData")),t=$("#tpl-service-searchName-nodata").html().replace("@noData",s)}a=$("#tpl-service-history-box").html().replace("@searchItems",t),$("#ampSearchNameBox").remove(),$("#ampHistoryBox").remove(),$("body").append(a)})}serviceCenter.space={loadCompleteFlag:!0},eventsListen(),serviceCenter.init=function(e){var a=$("#ampServiceArticle");if(0===a.getNiceScroll().length&&AmpUtils.niceScrollInit($("#ampServiceRightContent")),a.hasClass("ampLoadedFlag"))clearContainer(),getSearchApps("",e);else{var t=parseInt(AmpDataUtils.space.ampData.userType,10),n=AmpUtils.getUserRoleId(t);clearContainer("init"),AmpGlobal.loginFlag?AmpDataUtils.getUserFirstLogin(function(e){e.isFirstLogin?getCommendServiceApps():getRecentUseApps()}):getCommendServiceApps(),getNewApps(n),getSearchApps("init",e),a.addClass("ampLoadedFlag")}serviceCenter.showPage("show"),AmpUtils.setIe9PlaceHolder(),serviceCenter.searchBoxBlur()},serviceCenter.searchBoxBlur=function(){var e=$("#ampServiceSearch").find(".ampserviceSearchInputFlag"),a=$.trim(e.val());if(!a){var t="搜索服务";"en_US"==AmpGlobal.currentLang&&(t=$.i18n("searchService")),e.attr("placeholder",t),AmpUtils.setIe9PlaceHolder()}},serviceCenter.showPage=function(e){var a=$("#ampServiceArticle"),t="blur",n=!0;if("show"===e){a.hasClass("amp-active")&&(n=!1),a.removeClass("amp-animate-move-top-out").addClass("amp-animate-move-top-in").addClass("amp-active").removeClass("amp-hide");var i=$("#ampServiceLabelNav");0==i.find("li.amp-active").length&&(i.find("li").removeClass("amp-active"),i.find('li[amp-label-flag="all"]').addClass("amp-active"),i.find(".serviceCenterSubLabelFlag").remove())}else t="restore",a.hasClass("amp-active")||(n=!1),a.removeClass("amp-animate-move-top-in").addClass("amp-animate-move-top-out").removeClass("amp-active");setTimeout(function(){if(n){var e=null;$("#ampPersonalArticle").hasClass("amp-active")?e=$("#ampPersonalArticle"):$("#ampPageHeaderHomeIcon").hasClass("amp-active")&&(e=$("#ampEhallBody").find("article.amp-active")),null!=e&&(e.removeClass("amp-active").addClass("amp-hide"),$("#ampSlidePage").addClass("amp-hide"),$("#ampPageBgCover").removeClass("amp-hide").addClass("amp-active"))}AmpUtils.niceScrollResize($("#ampServiceArticle"))},450)}}(window.AmpServiceCenter=window.AmpServiceCenter||{}),function(e,a){e.userInfo=function(){var e=AMPConstant.jsonpRequestPath+"userInfo.json";return AmpUtils.doJsonpAjax(e)},e.ehallAppData=function(e){var a="all",t=AMPConstant.jsonpRequestPath+AMPConstant.APIList.serviceRoleApp+"?serviceRoleId="+e+"&type="+a;return AmpUtils.doJsonpAjax(t)},e.searchAppData=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.serviceCenterData;return e.labels&&(a+="?"+e.labels,delete e.labels),AmpUtils.doJsonpAjax(a,e)},e.myFavoriteApps=function(){var e=AMPConstant.jsonpRequestPath+AMPConstant.APIList.userFavoriteApps;return AmpUtils.doJsonpAjax(e)},e.favoriteApp=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.favoriteApp;return AmpUtils.doJsonpAjax(a,e)},e.unFavoriteApp=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.unFaviroteApp;return AmpUtils.doJsonpAjax(a,e)},e.appIntroduction=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.appIntroduction;return AmpUtils.doJsonpAjax(a,e)},e.updateDesHasUpdateStatus=function(e){var a=AMPConstant.jsonpRequestPath+"updateDesHasUpdateStatus.json";return AmpUtils.doJsonpAjax(a,e)},e.appUnViewableDescription=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.appCheckforView;return AmpUtils.doJsonpAjax(a,e)},e.appRestoreViewableDescription=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.appCheckforView;return AmpUtils.doJsonpAjax(a,e)},e.appRestoreViewableDescription=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.appCheckforView;return AmpUtils.doJsonpAjax(a,e)},e.desktopData=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.getUserDesktop;return AmpUtils.doJsonpAjax(a,e)},e.noReadMessageData=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.manageAPIList.getTagsMessages;return AmpUtils.doJsonpAjax(a,e)},e.recentUseApps=function(){var e=AMPConstant.jsonpRequestPath+AMPConstant.APIList.recentUseApps;return AmpUtils.doJsonpAjax(e)},e.desktopCreat=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.createUserDesktop;return AmpUtils.doSendAjax(a,e)},e.deleteDesktop=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.deleteDesktop;return AmpUtils.doJsonpAjax(a,e)},e.restoreDesktop=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.restoreDesktop;return AmpUtils.doJsonpAjax(a,e)},e.editDesktop=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.editDesktop;return AmpUtils.doJsonpAjax(a,e)},e.editUserDesktopOrder=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.editUserDesktopOrder;return AmpUtils.doJsonpAjax(a,e)},e.getUserCategoryAppList=function(){var e=AMPConstant.jsonpRequestPath+AMPConstant.APIList.userCategoryAppList;return AmpUtils.doJsonpAjax(e)},e.getUserDesktopProperty=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.getUserDesktopProperty;return AmpUtils.doJsonpAjax(a)},e.updateUserDesktopSeq=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.updateUserDesktopSeq+"?desktopSeqJson="+e;return AmpUtils.doJsonpAjax(a)},e.deleteUserDesktopCard=function(e){
var a=e.desktopId,t=e.desktopType,n=e.cardWid,i=AMPConstant.jsonpRequestPath+AMPConstant.APIList.deleteUserDesktopCard+"?desktopId="+a+"&desktopType="+t+"&cardWid="+n;return AmpUtils.doJsonpAjax(i)},e.getRecommendCard=function(){var e=AMPConstant.jsonpRequestPath+AMPConstant.APIList.getRecommendCard;return AmpUtils.doJsonpAjax(e)},e.updateRecommendCardStatus=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.updateRecommendCardStatus+"?appPcCardRecommendJson="+e;return AmpUtils.doJsonpAjax(a)},e.userDesktopInfo=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.userDesktopInfo+"?type="+e;return AmpUtils.doJsonpAjax(a)},e.updatePcCardMarkStatus=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.updatePcCardMarkStatus+"?userPcCardRecordJson="+e;return AmpUtils.doJsonpAjax(a)},e.getTagsMessages=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.getTagsMessages;return AmpUtils.doJsonpAjax(a,e)},e.userCheckforView=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.userCheckforView+"?viewFlag="+e;return AmpUtils.doJsonpAjax(a)},e.getTaskSideCard=function(){var e=AMPConstant.jsonpRequestPath+AMPConstant.APIList.getTaskSideCard;return AmpUtils.doJsonpAjax(e)},e.getTaskSideCardOfUnreadMessage=function(){var e=AMPConstant.jsonpRequestPath+AMPConstant.APIList.getTaskSideCardOfUnreadMessage;return AmpUtils.doJsonpAjax(e)},e.getrecUseServiceList=function(){var e=AMPConstant.jsonpRequestPath+AMPConstant.APIList.recUseServiceList;return AmpUtils.doJsonpAjax(e)},e.sendRecUseApp=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.sendRecUseApp+"?appId="+e;return AmpUtils.doJsonpAjax(a)},e.updateUserDesktopStatus=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.updateUserDesktopStatus+"?desktopId="+e;return AmpUtils.doJsonpAjax(a)},e.getUserSkin=function(){var e=AMPConstant.jsonpRequestPath+AMPConstant.APIList.getUserSkin;return AmpUtils.doJsonpAjax(e)},e.switchSkin=function(e){var t=e.skinName,n=e.themeColor;if(e.siteType!=a)var i=AMPConstant.jsonpRequestPath+AMPConstant.APIList.switchSkin+"?siteType="+e.siteType;else var i=AMPConstant.jsonpRequestPath+AMPConstant.APIList.switchSkin+"?skinName="+t+"&themeColor="+n;return AmpUtils.doJsonpAjax(i)},e.userSearchHistory=function(){var e=AMPConstant.jsonpRequestPath+AMPConstant.APIList.userSearchHistory;return AmpUtils.doJsonpAjax(e)},e.getTopExtendList=function(){var e=AMPConstant.jsonpRequestPath+AMPConstant.APIList.getTopExtendList;return AmpUtils.doJsonpAjax(e)},e.getUserFirstLogin=function(){var e=AMPConstant.jsonpRequestPath+AMPConstant.APIList.getUserFirstLogin;return AmpUtils.doJsonpAjax(e)},e.setMsgsRead=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.setMsgsRead+"?msgIdsString="+e;return AmpUtils.doJsonpAjax(a)},e.setAllTagMsgsRead=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.setAllTagMsgsRead+"?typeId=-1";return AmpUtils.doJsonpAjax(a)},e.getTaskCount=function(e){var a=AMPConstant.taskCenterRequestPath+"sys/taskCenter/portalDataReceive/"+AMPConstant.APIList.getTaskCount;return AmpUtils.getTaskAjax(a)},e.getTaskDbLcData=function(e){var a=AMPConstant.taskCenterRequestPath+"sys/taskCenter/portalDataReceive/"+AMPConstant.APIList.getPortalDataTask+"?flag="+e;return AmpUtils.getTaskAjax(a)},e.getTaskZqfwData=function(e){var a=e.pageNumber,t=e.pageSize,n=AMPConstant.jsonpRequestPath+AMPConstant.APIList.readyAndOpenService+"?pageNumber="+a+"&pageSize="+t;return AmpUtils.doJsonpAjax(n)},e.updateUserReadGuidePage=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.updateUserReadGuidePage+"?isReadGuidePage="+e;return AmpUtils.doJsonpAjax(a)},e.getCurrentLocale=function(){var e=AMPConstant.jsonpRequestPath+AMPConstant.APIList.getCurrentLocale;return AmpUtils.doJsonpAjax(e)},e.checkLogin=function(){var e=AMPConstant.jsonpRequestPath+AMPConstant.APIList.checkLogin;return AmpUtils.doJsonpAjax(e)},e.setCurrentLocale=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.setCurrentLocale+"?lang="+e;return AmpUtils.doJsonpAjax(a)},e.getUserFavFolders=function(){var e=AMPConstant.jsonpRequestPath+AMPConstant.APIList.getUserFavFolders;return AmpUtils.doJsonpAjax(e)},e.saveUserFavFolder=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.saveUserFavFolder+"?folderName="+e;return AmpUtils.doJsonpAjax(a)},e.saveFavFolderOperates=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.saveFavFolderOperates+"?userFavFolderOperInfo="+e;return AmpUtils.doJsonpAjax(a)}}(window.AmpServices=window.AmpServices||{}),function(e,a){function t(e){for(var a=e.length,t=window.innerHeight,n=window.innerWidth,i=0;i<a;i++){var s=e[i],r=parseInt(s.getAttribute("slide-index"),10),o=s.getAttribute("slide-direction"),p="bh-slide-animate-v",l=0,m=0,c=0;1!==r?("vertical"===o?(l=t,p="bh-slide-animate-v"):(m=n,p="bh-slide-animate-h"),c=0):(p="vertical"===o?"bh-slide-animate-v":"bh-slide-animate-h",c=1),s.style.top=l+"px",s.style.left=m+"px",s.style.height=t+"px",s.style.width=n+"px",s.style.opacity=c,navigator.userAgent.indexOf("MSIE 9.0")>0?s.className+" "+p:s.classList.add(p)}"0"==AmpGlobal.platformType&&$("#ampLoginInBottomDesc").hide()}function n(e){if("0"!=AmpGlobal.platformType){for(var a=e.length,t="",n='<div class="@activeClass"></div>',s=0;s<a;s++){var r=0!==s?"":"amp-active";t+=n.replace("@activeClass",r)}var o=16,p=8,l=a*o+(a-1)*p,m="calc(50% - "+parseInt(l/2,10)+"px);";t='<div id="ampSlidePage" class="bh-slide-page amp-zIndex-lv1" style="top:'+m+'">'+t+"</div>",$("#ampEhallBody").append(t),i()}}function i(){$("#ampSlidePage").on("click","div",function(){var e=$(this);if(!e.hasClass("amp-active")){var a=e.index(),t=$("#ampSlidePage").children(".amp-active"),n=t.index(),i=a>n?"down":"up",s=$("body").find('article[role="slide"][slide-index="'+(n+1)+'"]')[0],r=$("body").find('article[role="slide"][slide-index="'+(a+1)+'"]')[0];p(i,s,r)}})}function s(){"0"!=AmpGlobal.platformType&&(document.addEventListener&&(document.addEventListener("DOMMouseScroll",o,!1),window.windowScrollHandle&&(b.addEventListener("touchmove",o,!1),S.addEventListener("touchmove",o,!1),y.addEventListener("touchmove",o,!1),window.addEventListener("touchload",s,!1)),window.getTouchstartXY&&(b.addEventListener("touchstart",r,!1),S.addEventListener("touchstart",r,!1),y.addEventListener("touchstart",r,!1))),window.onmousewheel=document.onmousewheel=o)}function r(e){g=e.touches[0].pageX,v=e.touches[0].pageY}function o(t){var n="",i="",s=t||window.event;if(s.wheelDelta!=a||s.detail!=a&&s.detail?(s.wheelDelta?i=s.wheelDelta:s.detail&&(i=s.detail),i&&(n=i>0?"up":"down")):(s.preventDefault(),h=s.changedTouches[0].pageX,A=s.changedTouches[0].pageY,C=h-g,k=A-v,k>0||0==k?(n="down",i="down"):k<0&&(n="up",i="up")),i){var r=s.target,o=null;if(o="slide"===r.getAttribute("role")?r:m(r,'[role="slide"]')){if("mac"===e.space.os&&i>=-3&&i<=3)return;p(n,o)}}}function p(t,n,i){if(!e.space.moveFlag){var s=0,r=parseInt(n.getAttribute("slide-index"),10);i!=a&&(s=parseInt(i.getAttribute("slide-index"),10));var o=n.parentNode,p=l(o),m=p.length,c="",d="",u="",f=0,g=window.innerHeight,v=0,h=0,A=null,C=null,k=null,b=null,S=window.innerHeight,y=null,w=null;if("up"===t){if(1===r)return;if(!AMPConfigure.showLoginPageFlag&&AMPConfigure.fudanEhallCustom&&AmpUtils.animateLoginIn(),f=r-1,c="top",d=g+"px",u="0px",AmpGlobal.showLoginPageFlag)if(s&&(f=s,d=2*g+"px"),2===f){var P=$("#ampEhallRoleNavPlaceHolder");P.length>0?(v=S+P.offset().top+"px",h=S+$("#ampEhallHeader").offset().top+"px"):(v=0,h=0),A=$("#ampEhallRoleNav"),C=$("#ampClassifyRoleNav"),k=$("#ampEhallHeaderContent"),b=$("#ampLoginHeaderContent"),y=$("#ampEhallArticle").parent(),w=$("#ampClassifyArticle"),w=$("#ampLoginArticle").parent()}else 1===f&&(AmpUtils.animateLoginIn(),h=S+$("#ampLoginHeader").offset().top+"px",v=$("#ampEhallRoleNav").offset().top+"px",b=$("#ampEhallHeaderContent"),k=$("#ampLoginHeaderContent"),C=$("#ampEhallRoleNav"),y=$("#ampLoginArticle").parent(),w=$("#ampEhallArticle").parent(),w=$("#ampClassifyArticle"));else{var P=$("#ampEhallRoleNavPlaceHolder");v=P.length>0?S+P.offset().top+"px":0,A=$("#ampEhallRoleNav"),C=$("#ampClassifyRoleNav"),y=$("#ampEhallArticle").parent(),w=$("#ampClassifyArticle")}}else if("down"===t){if(r===m)return;if(!AMPConfigure.showLoginPageFlag&&AMPConfigure.fudanEhallCustom&&AmpUtils.animateLoginOut(),f=r+1,c="top",d="-"+g+"px",u="0px",AmpGlobal.showLoginPageFlag)if(s&&(f=s,d="-"+2*g+"px"),2==f){AmpUtils.animateLoginOut();var P=$("#ampEhallRoleNavPlaceHolder");v=P.length>0?P.offset().top-S+"px":0,h=$("#ampEhallHeader").offset().top-S+"px",A=$("#ampEhallRoleNav"),C=$("#ampClassifyRoleNav"),b=$("#ampLoginHeaderContent"),k=$("#ampEhallHeaderContent"),y=$("#ampEhallArticle").parent(),w=$("#ampLoginArticle").parent()}else 3==f&&(AmpUtils.animateLoginOut(),v=$("#ampClassifyRoleNavPlaceHolder").offset().top-S+"px",h=$("#ampEhallHeader").offset().top+"px",A=$("#ampClassifyRoleNav"),C=$("#ampEhallRoleNav"),b=$("#ampEhallHeaderContent"),y=$("#ampClassifyArticle"),w=$("#ampEhallArticle").parent());else v=$("#ampClassifyRoleNavPlaceHolder").offset().top-S+"px",A=$("#ampClassifyRoleNav"),C=$("#ampEhallRoleNav"),y=$("#ampClassifyArticle"),w=$("#ampEhallArticle").parent()}else"left"===t?f=r+1:"right"===t&&(f=r+1);var i=o.querySelector('[slide-index="'+f+'"]');n.style[c]=d,n.style.opacity=0,navigator.userAgent.indexOf("MSIE 9.0")>0?n.className=n.className.replace("amp-active",""):n.classList.remove("amp-active"),i.style[c]=u,i.style.opacity=1,navigator.userAgent.indexOf("MSIE 9.0")>0?i.className=i.className+" amp-active":i.classList.add("amp-active");var I=$("#ampSlidePage"),U=I.children();$(U[f-1]).addClass("amp-active"),$(U[r-1]).removeClass("amp-active");var D=$("#ampEhallRoleNavAnimateBlock");if(AmpGlobal.showLoginPageFlag){var L=$("#ampTplHeader");3!==f?L.removeClass("amp-hide"):L.addClass("amp-hide"),1!==f?D.removeClass("amp-hide"):D.addClass("amp-hide"),setTimeout(function(){D.css("top",v),L.css("top",h)},10),C.addClass("amp-hide").removeClass("amp-active"),b.addClass("amp-hide").removeClass("amp-active")}else D.removeClass("amp-hide"),setTimeout(function(){D.css("top",v)},10),C.addClass("amp-hide");AmpUtils.niceScrollHide(w),e.space.moveFlag=!0,AmpGlobal.showLoginPageFlag?setTimeout(function(){e.space.moveFlag=!1,AmpUtils.niceScrollResize(y),3!==f&&(k.removeClass("amp-hide"),L.addClass("amp-hide")),1!==f&&(A.removeClass("amp-hide"),D.addClass("amp-hide"))},e.space.animateTime+80):setTimeout(function(){e.space.moveFlag=!1,AmpUtils.niceScrollResize(y),A.removeClass("amp-hide"),D.addClass("amp-hide")},e.space.animateTime+10)}}function l(e){for(var a=e.children,t=a.length,n=[],i=0;i<t;i++){var s=a[i];"slide"===s.getAttribute("role")&&n.push(s)}return n}function m(e,a){for(var t=c(a),n=e.parentNode;;){if(!n||n===document)return null;if(t(n))return n;n=n.parentNode}}function c(e){return e instanceof Function?e:function(a){return d(a,e)}}function d(e,a){if("."===a[0])return e.classList.contains(a.slice(1));if("["===a[0]){var t=a.match(/\[([a-zA-Z]*)="?([a-zA-Z]*)"?]/),n=t[1],i=t[2],s=e.attributes,r=s.length;if(r>0)for(var o=0;o<r;o++){var p=s[o];if(p.localName===n&&p.value===i)return!0;if(o===r-1)return!1}}return e.nodeName.toLowerCase()===a}function u(e,a){return e.querySelectorAll(a)}function f(){var e=(navigator.userAgent,"Mac68K"===navigator.platform||"MacPPC"===navigator.platform||"Macintosh"===navigator.platform||"MacIntel"===navigator.platform);return e?"mac":"window"}e.space={moveFlag:!1,animateTime:AmpGlobal.animateTimes,os:f(),macData:{wheelStart:!1,maxWheel:0,preDelta:0,state:"increase"}},e.init=function(){var e=u(document,'[role="slide"]');t(e),n(e),s()},e.slideAnimate=function(e,a){p(e,a)};var g,v,h,A,C,k,b=document.getElementById("ampClassifyArticle"),S=document.getElementById("ampEhallArticle"),y=document.getElementById("ampLoginRoleNav")}(window.slide=window.slide||{}),function(e,a){function t(e){var a=(new Date).getFullYear(),t=(new Date).getDate(),n=(new Date).getMonth(),i=new Date(e).getFullYear(),s=new Date(e).getDate(),r=new Date(e).getMonth();return(new Date(i,r,s).getTime()-new Date(a,n,t).getTime())/864e5}function n(e){var a=new Date(parseInt(e)),t=a.getMonth()+1,n=a.getDate(),i=a.getHours(),s=a.getMinutes();return t<10&&(t="0"+t),n<10&&(n="0"+n),i<10&&(i="0"+i),s<10&&(s="0"+s),t+"/"+n+" "+i+":"+s}function i(e){var a=e,e="",t=s(a);switch(a){case"indigo":e=""==t?"靛蓝":t;break;case"teal":e=""==t?"水鸭绿":t;break;case"millennium":e=""==t?"千禧绿":t;break;case"cherry":e=""==t?"樱桃红":t;break;case"magenta":e=""==t?"绛紫":t;break;case"golden":e=""==t?"香槟金":t}return e}function s(e){var a=AMPConfigure.portalSkin_custom,t="";if("undefined"!=typeof a&&(skinList=a.length,skinList>0))for(var n=0;n<skinList;n++){var i=a[n];if(i.enable&&i.skinColor==e){t=i.skinName;break}}return t}e.getAppCardHtml=function(t){var n=t.data,i=t.customClass,s=$("#tpl-app-card").html();i=i?i:"";var r=n.middleIcon,o=n.appName,p=AmpUtils.getCategoryListStr(n.categoryList),l=p,m=(n.favoriteCount,"");n.assessAvgScore!=a&&(m=e.getAppStarHtml(n.assessAvgScore));var c=e.getAppPermissionHtml(n.hasPermission),d=AmpUtils.assemblyAppAttributesToStr(n),u=(e.getAppDescHtml(n.description,d),n.appType),f="",g="热",v="新";"en_US"==AmpGlobal.currentLang&&(g=$.i18n("hot"),v=$.i18n("new")),f=3==u?$("#tpl-ehall-app-hot-flag-card").html().replace("@text",g):2==u?$("#tpl-ehall-app-new-flag-card").html().replace("@text",v):"",s=s.replace("@customClass",i).replace("@img",r).replace("@title",o).replace("@category",p).replace("@star",m).replace("@permission",c).replace("@attributes",d).replace("@ehallAppHotNewFlag",f).replace("@catetooltip",l).replace("@permissionBig",c);var h=e.getHoverAppHtml(t),A=$("#tpl-hover-app-card-group").html().replace("@content",s+h);return A},e.getAppDescHtml=function(e,a){return e?$("#tpl-ehall-app-card-desc").html().replace("@attributeBig",a):""},e.getHoverAppHtml=function(t){var n=t.data,i=t.customClass;$("#tpl-app-card").html();i=i?i:"";var s=n.middleIcon,r=n.appName,o=AmpUtils.getCategoryListStr(n.categoryList),p=o,l=n.favoriteCount,m="";n.assessAvgScore!=a&&(m=e.getAppStarHtml(n.assessAvgScore));var c=e.getAppNewPermissionHtml(n.hasPermission),d=AmpUtils.assemblyAppAttributesToStr(n),u="";n.appPc!=a&&n.appPc.isEnableDescription&&(u=e.getiIconHtml(d));var f="",g=n.appType,v="热",h="新",A="人收藏";"en_US"==AmpGlobal.currentLang&&(v=$.i18n("hot"),h=$.i18n("new"),A=$.i18n("collected")),f=3==g?$("#tpl-ehall-app-hot-flag-card").html().replace("@text",v):2==g?$("#tpl-ehall-app-new-flag-card").html().replace("@text",h):"";var C="";navigator.userAgent.indexOf("MSIE 9.0")>0&&(C="amp-app-card-hover-big-IE9");var k=(e.getAppDescHtml(n.description,d),$("#tpl-hover-app-card").html().replace("@permission",c).replace("@imgBig",s).replace("@starBig",m).replace("@titleBig",r).replace("@Bigtitle",r).replace("@categoryBig",o).replace("@favoriteCount",l).replace("@attributeBig",d).replace("@attributedescBig",d).replace("@catetooltip",p).replace("@iShowHtml",u).replace("@appCardHoverHotNewFlag",f).replace("@bibTitleTip",r).replace("@collected",A).replace("@classie9",C));return k},e.getServiceAppCardHtml=function(t){var n=t.data,i=t.customClass,s=$("#tpl-service-app-card").html();i=i?i:"";var r=n.middleIcon,o=n.appName,p=AmpUtils.getCategoryListStr(n.categoryList),l=p,m="";n.assessAvgScore!=a&&(m=e.getAppStarHtml(n.assessAvgScore));var c=e.getAppPermissionHtml(n.hasPermission),d=AmpUtils.assemblyAppAttributesToStr(n),u=n.appType,f="",g="热",v="新";return"en_US"==AmpGlobal.currentLang&&(g=$.i18n("hot"),v=$.i18n("new")),f=3==u?$("#tpl-ehall-app-hot-flag-card").html().replace("@text",g):2==u?$("#tpl-ehall-app-new-flag-card").html().replace("@text",v):"",s=s.replace("@customClass",i).replace("@img",r).replace("@title",o).replace("@category",p).replace("@star",m).replace("@permission",c).replace("@attributes",d).replace("@ehallAppHotNewFlag",f).replace("@catetooltip",l)},e.getAppCardSingleHtml=function(e){var a=$("#tpl-app-card-single").html(),t=e.middleIcon,n=e.appName;return a=a.replace("@img",t).replace("@title",n)},e.getFavAppCardSingleHtml=function(e){var a=$("#tpl-app-card-single-myfavorite").html(),t=e.middleIcon,n=e.appName;return a=a.replace("@img",t).replace("@title",n)},e.getiIconHtml=function(e){return $("#tpl-hover-app-card-i-icon").html().replace(" @attributedescBig",e)},e.getAppCardGroupHtml=function(e){var a=$("#tpl-app-card-group").html();return a.replace("@content",e)},e.getAppsCardGroupContainer1Html=function(e){var a=$("#tpl-bar-apps-block-1").html();return a.replace("@title",e.title).replace("@content",e.content)},e.getSingleAppHtml=function(t,n){var i="";if("single"==n){i=$("#tpl-app-single").html();var s=t.middleIcon,r=t.appName,o=AmpUtils.assemblyAppAttributesToStr(t),p="";t.appPc!=a&&t.appPc.isEnableDescription&&(p=e.getSingleClassifyIconHtml(o)),i=i.replace("@img",s).replace("@title",r).replace("@attributes",o).replace("@iShowIconHtml",p)}else if("complex"==n){i=$("#tpl-app-complex").html();var s=t.middleIcon,l=t.cardName,m=t.cardId,c=(t.appId,t.wid),o=(t.desktopId,AmpUtils.assemblyAppAttributesToStr(t));i=i.replace("@img",s).replace("@title",l).replace("@attributes",o).replace("@cardNickName",m).replace("@cardName",l).replace("@hasUnReadMark",t.hasUnReadMarkClass).replace("@hasBtnClass",t.hasBtnClass).replace("@cardWid",c)}return i},e.getSingleClassifyIconHtml=function(e){return $("#tpl-app-single-i-icon").html().replace("@attributedescBig",e)},e.getAppStarHtml=function(e){e=parseInt(e,10),e||(e=0);for(var a="",t=0;t<5;t++)a+=t<e?'<i class="iconfont icon-xingxing"></i>':'<i class="iconfont icon-xingxing xingxing-gray"></i>';return'<div class="amp-app-card-star amp-clearfix-child">'+a+"</div>"},e.getAppPermissionHtml=function(e){var t="";if(e!=a){var n="无权限";"en_US"==AmpGlobal.currentLang&&(n=$.i18n("unauthorized")),t=e?"":'<div class="amp-app-card-permission amp-pull-right">'+n+"</div>"}return t},e.getAppNewPermissionHtml=function(e){var t="";return e!=a&&(t=e?"":'<div class="triangle-bottomright"> <i class="iconfont icon-lock"></i></div>'),t},e.getAppPageHtml=function(e,a){for(var t='<div id="@id" class="amp-apps-page @customClass">@page</div>',n="",i=a&&a.id?a.id:"",s=a.customClass?a.customClass:"",r=0;r<e;r++){var o=0!==r?"":"amp-active";n+='<div class="'+o+'"></div> '}return t=t.replace("@page",n).replace("@id",i).replace("@customClass",s)},e.getEhallFudanPageHtml=function(e,a){for(var t=AMPConfigure.role_data,n=t.length,i="",s=0;s<n;s++){var r=t[s],o=r.id,p=s!==n-1?"":"amp-active";i+='<div amp-role-id="'+o+'" class="'+p+'"></div> '}return i},e.getRoleTabHtml=function(e){for(var a="",t='<div class="amp-ehall-nav-item @activeClass"><h3>@chTitle</h3><div>@enTitle</div></div>',n=e.length,i=0;i<n;i++){var s=e[i],r=i>0?"":"amp-active",o=s.title,p=s.enTitle?s.enTitle:"";a+=t.replace("@activeClass",r).replace("@chTitle",o).replace("@enTitle",p)}return a+='<nav class="amp-ehall-nav">'+a+"</nav>"},e.getRoleNavHtml=function(e){var a=AMPConfigure.role_data,t=a.length,n=e.customClass||"",i=e.roleId;t>=4&&(n+=" amp-ehall-nav-"+t);var s=$("#tpl-role-nav-item").html();"en_US"==AmpGlobal.currentLang&&(s=$("#tpl-role-nav-item-en").html());for(var r=e&&e.id?e.id:"",o="",p=0;p<t;p++){var l=a[p],m=l.name,c=l.englishName,d=l.id,u=d!==i?"":"amp-active";o+=s.replace("@chTitle",m).replace("@enTitle",c).replace("@activeClass",u).replace("@roleId",d)}var f=$("#tpl-role-nav").html().replace("@content",o).replace("@customClass",n).replace("@navId",r);return f},e.getBarAppsBlockHtml=function(e){var a=e.clearClass?"":"amp-hide",t=$("#tpl-bar-apps-block").html(),n="清空结果";return"en_US"==AmpGlobal.currentLang&&(n=$.i18n("deleteAllResults")),t.replace("@title",e.title).replace("@apps",e.apps).replace("@count",e.count).replace("@clearClass",a).replace("@deleteAllResults",n)},e.getLabelsHtml=function(e){var a="",t=$("#tpl-label-line").html(),n=$("#tpl-label-line-item").html(),i="全部";if("en_US"==AmpGlobal.currentLang&&(i=$.i18n("all")),e){var s=e.length;if(s>0)for(var r=0;r<s;r++){var o=e[r],p=o.serviceName;"en_US"==AmpGlobal.currentLang&&(1==o.serviceId?p=$.i18n("serviceRole"):2==o.serviceId?p=$.i18n("serviceType"):0==o.serviceId?p=$.i18n("serviceScene"):3==o.serviceId&&(p=$.i18n("serviceMethod")));for(var l=o.serviceId,m=o.labels,c=m.length,d="",u=0;u<c;u++){var f=m[u],g=f.lableName,v=f.labelId,h="";h=null!=f.subLabelList&&f.subLabelList.length>0?"hasSubLabelFlag":"",0===u&&(d+=n.replace("@labelName",i).replace("@labelId","all").replace("@active","amp-active").replace("@labelFlag","all").replace("@labelType",l).replace("@hasSubLabelFlag","")),d+=n.replace("@labelName",g).replace("@labelId",v).replace("@active","").replace("@labelFlag","").replace("@hasSubLabelFlag",h).replace("@labelType",l)}a+=t.replace("@serviceId",l).replace("@labelName",p).replace("@labelList",d)}}return a},e.getWidgetAddCardAsideHtml=function(){var e="添加应用";return"en_US"==AmpGlobal.currentLang&&(e=$.i18n("addApps")),$("#tpl-widget-add-card-aside").html().replace("@addApps",e)},e.getWidgetAddCardMainHtml=function(){var e="添加应用卡片",a=";";return"en_US"==AmpGlobal.currentLang&&(e=$.i18n("addAppCards"),a='style="margin-left: -44px"'),$("#tpl-widget-add-card-main").html().replace("@addAppCards",e).replace("@styleEn",a)},e.getWidgetDragCardMainHtml=function(){var e="从左侧选择需要的应用卡片";return"en_US"==AmpGlobal.currentLang&&(e=$.i18n("selectTheApp")),$("#tpl-widget-drag-card-main").html().replace("@selectTheApp",e)},e.getWidgetLostPermissionCard=function(e){var a=e.widgetId,t=e.widgetWid;return $("#tpl-widget-lost-permission-card").html().replace("@content","<"+a+"></"+a+">").replace("@widgetid",a).replace("@widgetWid",t)},e.getWidgetMainItemHtml=function(e){var a=e.widgetsJsonData?e.widgetsJsonData[e.widgetId]:"",t=" ";if(a){for(var n in a)t+=""+n+' = "'+a[n]+'" ';t+=' widget_title_enus  = "'+e.widgetTitleEnus+'" '}return $("#tpl-widget-main-item").html().replace("@content","<"+e.widgetId+t+" ></"+e.widgetId+">").replace("@widgetId",e.widgetId).replace("@widgetid",e.widgetId).replace("@dragClass",e.dragCardClass).replace("@widgetWid",e.widgetWid).replace("@recommedCard",e.recommCardClass).replace("@appId",e.appId).replace("@appKey",e.appKey)},e.getWidgetAsideNormalItemHtml=function(e){return $("#tpl-widget-aside-normal-item").html().replace("@content","<"+e+"></"+e+">").replace("@widgetId",e)},e.getPromptHtml=function(e){return AmpUtils.replaceHtmlAnnotation($("#tpl-prompt").html()).replace("@content",e.content).replace("@promptStateClass",e.promptStateClass).replace("@stateIconClass",e.stateIconClass)},e.getDetailHtml=function(){var e="服务说明",a="下次不再显示",t="登录",n="后查看使用权限";return"en_US"==AmpGlobal.currentLang&&(e=$.i18n("serviceDescription"),a=$.i18n("doNotShow"),t=$.i18n("login"),n=$.i18n("checkUsageRight")),$("#tpl-app-detail").html().replace("@serviceDescription",e).replace("@doNotShow",a).replace("@loginbtn",t).replace("@checkUsageRight",n)},e.getFolderHtml=function(){var e="共 ",a=" 个服务";return"en_US"==AmpGlobal.currentLang&&(e=$.i18n("aTotalOf"),a=$.i18n("services")),$("#tpl-folder").html().replace("@aTotalOf",e).replace("@services",a)},e.getApprovalCommentHtml=function(){var e="审批意见",a="关闭";return"en_US"==AmpGlobal.currentLang&&(e=$.i18n("approvalAdvice"),a=$.i18n("close")),$("#tpl-approval-comments").html().replace("@approvalAdvice",e).replace("@close",a)},e.getHeaderUserInfoHtml=function(){var e=AmpDataUtils.space.ampData,a="管理服务";"en_US"==AmpGlobal.currentLang&&(a=$.i18n("editServices"));var t=e.hasManagePermission?'<div id="ampHeaderUserInfoAdminBtn" class="amp-animate-all-fast" >'+a+"</div>":"",n=e.userPhoto,i="true",s="重新上传";n||(n="portal/images/icons/user-role-teacher.png",i="false",s="上传图像");var r="";if(AMPConfigure.personalCenterAuthserverUrl){var o="个人中心";"en_US"==AmpGlobal.currentLang&&(o=$.i18n("personalCenter")),$("#tpl-header-user-info-personal-center").length>0&&(r=$("#tpl-header-user-info-personal-center").html().replace("@personalCenter",o))}var p="";if(AMPConfigure.switchPortalSiteModel&&e.hasTeacherDesktopAuth){var l="教师门户";$("#tpl-portal-site-model").length>0&&(p=$("#tpl-portal-site-model").html().replace("@siteTypeName",l))}if($("#tpl-header-user-info").length>0){var m="安全退出";return"en_US"==AmpGlobal.currentLang&&(m=$.i18n("signOut")),$("#tpl-header-user-info").html().replace("@username",e.userName).replace("@adminBtn",t).replace("@userPhotoSrc",n).replace("@personalCenterHtml",r).replace("@signOut",m).replace("@hasPhoto",i).replace("@siteTypeHtml",p)}return""},e.getHeaderUserSkinHtml=function(e){var a=["teal","indigo","millennium","cherry","magenta","golden"],t=$.trim(e.skinName),n=e.themeColor,s="",r="",o="",p="皮肤",l="护眼模式",m="开启",c="关闭";"en_US"==AmpGlobal.currentLang&&(l=$.i18n("eyeShieldMode"),p=$.i18n("skin"),c=$.i18n("closeSkinCool"),m=$.i18n("openSkin")),$("#tpl-header-user-skin").length>0&&(r=$("#tpl-header-user-skin").html().replace("@skin",p).replace("@eyeShieldMode",l)),s="dark"==n?m:c;for(var d=0;d<a.length;d++){var u=$.trim(a[d]),f="",g="",v="";f=u==t?"ampSkinUseFlag":"ampSkinCheckFlag",g="portal/images/theme/"+u+"-gauss-small.jpg",v=u;var h="选用皮肤",A="使用中";"en_US"==AmpGlobal.currentLang?(h=$.i18n("selectSkin"),A=$.i18n("inUse"),v=v.toUpperCase()):v=i(u),$("#tpl-skin-item").length>0&&(o+=$("#tpl-skin-item").html().replace("@switchCheckFlag",f).replace("@smallImgSrc",g).replace("@skinName",v).replace("@skinbg",u).replace("@newSkinName",u).replace("@selectSkin",h).replace("@inUse",A),localStorage.userSkinHtml=o)}return r=r.replace("@skinSwitchText",s).replace(" @skinContent",o)},e.getHeaderInternationHtml=function(e){return $("#tpl-header-internation-ue").html()},e.getCategoryTabHtml=function(e){var a="搜索可用卡片";return"en_US"==AmpGlobal.currentLang&&(a=$.i18n("searchAvailableCards")),$("#tpl-category-tab").html().replace("@header",e.header).replace("@content",e.content).replace("@tabUlId",e.tabUlId).replace("@tabContentId",e.tabContentId).replace("@searchAvailableCards",a)},e.getCategoryTabHeadItemHtml=function(e){return $("#tpl-category-tab-head-item").html().replace("@id",e.id).replace("@name",e.name).replace("@customClass",e.customClass).replace("@hasUnReadMarkClass",e.hasUnReadMarkClass).replace("@appCount",e.appCount).replace("@titleName",e.name)},e.getCategoryTabHeadItemTplHtml=function(){return $("#tpl-category-tab-head-item").html()},e.getCategoryTabContentItemHtml=function(e){return $("#tpl-category-tab-content-item").html().replace("@id",e.key).replace("@content",e.content).replace("@customClass",e.customClass).replace("@num",e.id)},e.getLoadingFrameHtml=function(e){e.customClass?e.customClass:"";return $("#tpl-loading-frame").length>0?$("#tpl-loading-frame").html().replace("@content",e.html).replace("@customClass",e.customClass):""},e.getAsideAppsHtml=function(e){return $("#tpl-aside-appList").html().replace("@title",e.title).replace("@content",e.apps)},e.getWidgetDesktopCreatItemHtml=function(e){return $("#tpl-widget-desktop-creat-item").html().replace("@content","<"+e+"></"+e+">").replace("@widgetId",e)},e.getWidgetAddSmalltoolItemHtml=function(e,a){var a=a,t=a.title,n=(a.label,a.content),i="教务",s="学工",r="人事",o="添加小工具";"en_US"==AmpGlobal.currentLang&&(i=$.i18n("educationalAffairs"),s=$.i18n("studentAffairs"),r=$.i18n("personnel"),o=$.i18n("addGadgets"));var p=$("#tpl-add-smalltool-mb-content").html().replace("@title",t).replace("@content",n).replace("@educationalAffairs",i).replace("@studentAffairs",s).replace("@personnel",r).replace("@addGadgets",o);return $("#tpl-widget-add-smalltool-item").html().replace("@content","<"+e+"></"+e+">").replace("@widgetId",e).replace("@mbcontent",p)},e.getTagsMessages=function(e){var a=e.id,t=e.title,n=e.content,i=AmpUtils.getCutString({width:280,line:3,string:n,chFontSize:12,enFontSize:9}),s=i.string;s=null==s?"":s;var r=i.type,o=AmpUtils.convertTimeToRecently(e.time),p=e.type;return $("#tpl-tag-messages").html().replace(/@title/g,t).replace("@smallContent",s).replace("@fullContent",n).replace("@type",p).replace("@time",o).replace("@cutType",r).replace("@tipTitle",t).replace("@messageId",a)},e.getRecommendHtml=function(e){var a="推荐卡片-猜你需要的APP",t="平台管理员向你推荐了这个应用卡片，您可以选择是否保留在桌面上。",n="留下",i="我不需要",s="将卡片留在",r="新建的桌面";return"en_US"==AmpGlobal.currentLang&&(a=$.i18n("recommendedCard"),t=$.i18n("thePlatformAdministrator"),n=$.i18n("keep"),i=$.i18n("iDoNotNeedIt"),s=$.i18n("keepTheCardIn"),r=$.i18n("newDesktop")),$("#tpl-card-recommed").html().replace("@desktopnacContent",e).replace("@recommendedCard",a).replace("@thePlatformAdministrator",t).replace("@keep",n).replace("@iDoNotNeedIt",i).replace("@keepTheCardIn",s).replace("@newDesktop",r)},e.getRecommendDesktopNav=function(e){var a=e.desktopId,t=e.desktopName,n=e.desktopType,i=e.cardWid;return $("#tpl-recommend-desktop-nav").html().replace("@desktopId",a).replace("@desktopName",t).replace("@desktopName",t).replace("@desktopType",n).replace("@cardWid",i)},e.getPersonalEmptyPage=function(e){return $("#tpl-personal-empty-page").html().replace("@message",e)},e.getPersonalAsideRightZqfwEmptyPage=function(e){return $("#tpl-personal-aside-zqfw-empty-page").html().replace("@message",e)},e.getAdminNewDesktopHtm=function(){var e="新增桌面-管理员新增的桌面",a="平台管理员根据您的业务需要，为您设置了新的桌面，好好使用吧！",t="我知道了";return"en_US"==AmpGlobal.currentLang&&(e=$.i18n("newDesktops"),a=$.i18n("administratorSetNewDesktop"),t=$.i18n("iKnow")),$("#tpl-admin-new-desktop").html().replace("@newDesktops",e).replace("@administratorSetNewDesktop",a).replace("@iKnow",t)},e.createDesktopDialogHtm=function(){var e="新建的桌面",a="命名桌面",t="保存",n="取消",i="8";return"en_US"==AmpGlobal.currentLang&&(e=$.i18n("newDesktop"),a=$.i18n("desktopName"),t=$.i18n("save"),n=$.i18n("cancel"),i=$.i18n("desktopLength")),$("#tpl-create-desktop").html().replace("@newDesktop",e).replace("@desktopName",a).replace("@save",t).replace("@cancel",n).replace("@desktopLength",i)},e.headerExpandDialogHtm=function(e){var a="";return $("#tpl-header-expand").length>0&&(a=$("#tpl-header-expand").html().replace("@expandContent",e)),a},e.headerExpandItem=function(e){var a=e.wid,t=e.url,n=e.name,i="";return $("#tpl-header-expand-item").length>0&&(i=$("#tpl-header-expand-item").html().replace("@menuId",a).replace("@menuUrl",t).replace("@dataName",n).replace("@menuName",n)),i},e.getAsideRightTaskItem=function(a,t){var n=(a.author?a.author+"-":"")+(a.subject||""),i="",s="";a.isSingleData&&(i=e.getAsideRightTaskItemImgHtm()),a.isDisplayData&&(s=e.getAsideRightTaskItemDisplayDataHtm(a.dataNum));var r="请处理";"3"==t&&(r="待办");var o="审批意见",p="流程图",l="已完成";"en_US"==AmpGlobal.currentLang&&(r=$.i18n("ToDoOnly"),"3"==t&&(r=$.i18n("ToDo")),o=$.i18n("approvalAdvice"),p=$.i18n("flowChart"),l=$.i18n("completed"));var m="task-type-db";return"COMPLETE"==a.processStatus&&(r=l,m="task-type-ywc"),$("#tpl-aside-right-process-item").html().replace("@formUrl",a.formUrl).replace("@appId",a.appId).replace("@taskId",a.taskId).replace("@createTime",a.createTime).replace("@spyjAppId",a.appId).replace("@processInstanceId",a.processInstanceId).replace("@lctappId",a.appId).replace("@lctprocessInstanceId",a.processInstanceId).replace("@fulltaskTitle",n).replace("@taskTitle",n).replace("@imgHtm",i).replace("@isDisplayData",s).replace("@todoList",r).replace("@approvalAdvice",o).replace("@flowChart",p).replace("@taskTypeColor",m)},e.getAsideRightTaskItemImgHtm=function(e){return $("#tpl-aside-right-process-item-img").html()},e.getAsideRightTaskItemDisplayDataHtm=function(e){var a="条";return"en_US"==AmpGlobal.currentLang&&(a=$.i18n("items")),$("#tpl-aside-right-process-item-displayData").html().replace("@dataNum",e).replace("@items",a)},e.getAsideRightTaskZqfwItem=function(e){var a=e.openBeginTime,i=e.openEndTime,s=(new Date).getTime(),r=t(a),o="",p="",l="",m="开放",c="开放中",d="今天",u="结束",f="还剩",g="天";"en_US"==AmpGlobal.currentLang&&(m=$.i18n("open"),c=$.i18n("opening"),d=$.i18n("today"),u=$.i18n("finish"),f=$.i18n("leftFor"),g=$.i18n("open")),r>0?("en_US"==AmpGlobal.currentLang&&(f="",g=" Left"),o=n(a)+" "+m,p=f+r+g,l="tip amp-color-gray-lv3"):r<0?(o=n(i)+" "+u,
p=c,l="tip amp-color-success-new-lv1"):a>s?(o=n(a)+" "+m,p=d,l="tip amp-color-gray-lv3"):(o=n(i)+" "+u,p=c,l="tip amp-color-success-new-lv1");var v=AmpUtils.assemblyAppAttributesToStr(e);return $("#tpl-aside-right-process-item-zqfwData").html().replace("@middleIcon",e.middleIcon).replace("@appName",e.appName).replace("@displayDate",o).replace("@tipClass",l).replace("@tipTxt",p).replace("@attrStr",v)},e.getDesktopBlurHtm=function(a){var t=e.getDesktopBlurItemsHtm(a);return $("#tpl-personal-center-desktop-blur").html().replace("@content",t)},e.getDesktopBlurItemsHtm=function(e){var a=$("#tpl-personal-center-desktop-blur-item").html(),t="";if(e>1)for(var n=0;n<e;n++)t+=a;else t=a;return t},e.getCanUseAppGroup=function(){var e=$("#tpl-canUseApp-group-apps").html();return e},e.geMyfavoriteTabHtml=function(e){return $("#tpl-myfavorite-apps-tab").html().replace("@header",e.header).replace("@content",e.content).replace("@tabUlId",e.tabUlId)},e.getMyFavoriteCategoryTabContentItemHtml=function(e){return $("#tpl-canUseApp-tab-content-item").html().replace("@id",e.id).replace("@content",e.content).replace("@customClass",e.customClass).replace("@num",e.id).replace("@classify",e.key)}}(window.AmpTemplate=window.AmpTemplate||{}),function(e,a){function t(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function n(){if($("#user").find("img").attr("data-tooltip-title"))return void e.goLoginPage()}function i(e){var a=$(e.target||e.srcElement);0!==a.closest("#ampPageHeaderSearch").length||"ampPageHeaderSearch"===a.attr("id")||$("#ampServiceArticle").hasClass("amp-active")||AmpHeader.searchRestore(),0===a.closest("#ampHeaderToolUser").length&&0===a.closest("#ampHeaderToolUserName").length&&$("#ampHeaderUserInfo").removeClass("amp-active")}function s(e){var a=e.index,t=e.container,n=e.flag,i=e.intervalTimes,r=e.blurDegree,o=e.step,p=e.stopFlag;t.css({"-webkit-filter":"blur("+a+"px)","-moz-filter":"blur("+a+"px)","-ms-filter":"progid:DXImageTransform.Microsoft.Blur(PixelRadius="+a+")",filter:"blur("+a+"px)",filter:"progid:DXImageTransform.Microsoft.Blur(pixelRadius="+a+",   MakeShadow=false)"}),setTimeout(function(){if("blur"===n){if(p)return;e.index=a+o,e.index>r&&(e.index=r,e.stopFlag=!0)}else{if(p)return;a--,e.index=a-o,e.index<0&&(e.index=0,e.stopFlag=!0)}s(e)},i)}function r(e){var a=/\d+/,t=null;e.css("filter")&&"none"!==e.css("filter")?t=e.css("filter").match(a):e.css("-webkit-filter")?t=e.css("-webkit-filter").match(a):e.css("-ms-filter")?t=e.css("-ms-filter").match(a):e.css("-moz-filter")&&(t=e.css("-moz-filter").match(a));var n=0;return t&&(n=parseInt(t[0],10)),n}function o(e,a){var t=AmpGlobal.blurDegree,n="blur"===a?t:0;e.css({"-webkit-filter":"blur("+n+"px)","-moz-filter":"blur("+n+"px)","-ms-filter":"blur("+n+"px)",filter:"blur("+n+"px)",filter:"progid:DXImageTransform.Microsoft.Blur(pixelRadius="+n+",   MakeShadow=false)"})}function p(e){var a=$(e.target||e.srcElement);if(a.hasClass("tooltipFlag")){var t=a[0].offsetWidth,n=a[0].offsetHeight,i=a.offset(),s=a.hasClass("tooltipLeftFlag"),r=a.attr("data-tooltip-title");if(r){var o=AmpUtils.NewGuid(),p=c(r,o),l=p.outerWidth(!0),m=p.outerHeight(!0),d=s?0:parseInt(i.left+t/2),u=s?i.left:d-parseInt(l/2),f=i.top+n+4,g={left:u+"px",top:f+"px",height:0};u+l>$("body").width()&&(g={right:"0",top:f+"px",height:0}),p.css(g).show().animate({height:m+"px"},300),a.attr("data-tooltip-guid",o)}}}function l(e){var a=$(e.target||e.srcElement),t=a.attr("data-tooltip-guid"),n=$("body").find("#tooltip_"+t);n.animate({height:0},300).promise().done(function(){n.remove()})}function m(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function c(e,a){return $("body").append('<div id="tooltip_'+a+'" class="amp-tooltip">'+e+"</div>"),$("#tooltip_"+a)}function d(e){var a="normal",t="",n=e.width,i=e.line,s=e.string,r=null==s?0:s.length,o=e.chFontSize,p=(e.enFontSize,parseInt(n*i/o,10));if(r<=p)t=s;else{var l=/<[^>]+>/g,m=/<[^>]+> *<[^>]+>/g;s=s.replace(m,"");var c=f(s);a="cut";var d=s.replace(l,"");t=g(n*i-2*o,p,d,e),t=u(t,c),t+="..."}return{string:t,type:a}}function u(e,a){var t="",n=a.length;if(0===n)t=e;else{for(var i=e.split(""),s=i.length,r=0;r<n;r++){var o=a[r],p=o.index,l=o.tag;if(!(p<s)){if(/^<\//.test(l)){var m=a[r-1].index;i.splice(m,s-m)}break}/^<\//.test(l)?i[p-1]=i[p-1]+l:i[p]=l+i[p]}t=i.join("")}return t}function f(e){var a=/<[^>]+>/g,t=e.match(a),n=[];if(t)for(var i=t.length,s=0;s<i;s++){var r=t[s],o=e.indexOf(r);e=e.replace(r,""),n.push({index:o,tag:r})}return n}function g(e,a,t,n){var i=t.substring(0,a),s=t.substring(a,t.length),r=v(i,n),o="";if(r<e){var p=e-r;if(p>n.chFontSize){var l=parseInt(p/n.chFontSize,10);o=g(p,l,s,n)}}return i+o}function v(e,a){var t=e.match(/[^\x00-\xff]/g),n=t?t.length:0,i=e.match(/[A-Z@]/g),s=i?i.length:0,r=e.length-n-s,o=(n+s)*a.chFontSize+r*a.enFontSize;return o}function h(e){var a=new Date,t=a.getFullYear(),n=a.getMonth()+1,i=a.getDate(),s=new RegExp("(\\d*)-(\\d*)-(\\d*) (\\d*):(\\d*):(\\d*)"),r=e.match(s),o=r[1],p=r[2],l=r[3],m=r[4],c=r[5],d=864e5,u="",f=new Date(t+"/"+n+"/"+i).getTime(),g=new Date(o+"/"+p+"/"+l).getTime(),v=(f-g)/d;if(v<1){var h="今天";"en_US"==AmpGlobal.currentLang&&(h=$.i18n("today")),u=h}else if(v<2){var h="昨天";"en_US"==AmpGlobal.currentLang&&(h=$.i18n("yesterday")),u=h}else if(v<3){var h="前天";"en_US"==AmpGlobal.currentLang&&(h=$.i18n("theDayBeforeYesterday")),u=h}else u=p+"-"+l;return u+" "+m+":"+c}e.bodyEventsListen=function(){$("body").on("click",function(e){i(e)})},e.doSendAjax=function(e,a){var t=$.Deferred();return $.ajax({type:"GET",url:e,traditional:!0,data:a,dataType:"jsonp",cache:!1,jsonp:AMPConstant.jsonp,success:function(e){e.hasLogin||n(),t.resolve(e)},error:function(e){t.reject(e)}}),t.promise()},e.doJsonpAjax=function(e,a){var t=$.Deferred();return $.ajax({type:"GET",url:e,traditional:!0,data:a,dataType:"jsonp",cache:!1,jsonp:AMPConstant.jsonp,success:function(e){e.hasLogin||n(),t.resolve(e)},error:function(e){t.reject(e)}}),t.promise()},e.checkIsLogin=function(){},e.goLoginPage=function(){window.location.href=AMPConstant.requestPath+"login?service="+window.location.href},e.logout=function(){window.location.href=AMPConstant.requestPath+"logout?service="+window.location.href},e.getCutString=function(e){return d(e)},e.convertTimeToRecently=function(e){return h(e)},e.getUserRoleId=function(e){var a="1__0";if(e)switch(e){case 1:a="1__0";break;case 2:a="1__1";break;case 3:a="1__2";break;case 4:a="1__3";break;case 5:a="1__4"}else for(var t=AMPConfigure.role_data,n=t.length,i=0;i<n;i++){var s=t[i];if(s.active){a=s.id;break}}return a},e.loadWidgetJson=function(e){var a=$.Deferred(),t=e.appId,n=e.cardId,i=e.desktopNum,s="";return s="undefined"!=typeof AMPConfigure.desktop_custom&&AMPConfigure.desktop_custom.pccard_customization?"undefined"==typeof i||i?"pc_card/"+t+"/"+n+"/card.json":"portal_custom/pc_card_custom/"+t+"/"+n+"/card.json":"pc_card/"+t+"/"+n+"/card.json",$.ajax({type:"GET",url:s,dataType:"json",async:!1,success:function(t){a.resolve(t,e)},error:function(t){a.reject(t,e)}}),a.promise()},e.setContainerMinHeight=function(e,a){var t=0,n=a.diffHeight?parseInt(a.diffHeight,10):0,i=a.excludeContainers;if(i){var s=i.length;if(s>0)for(var r=0;r<s;r++)t+=i[r].outerHeight(!0)}var o=window.innerHeight,p=o-t-n;e.css("height",p+"px")},e.clickPage4RotateYState=function(a,t){var n=a.container,i=a.pageContainer,s=t.container,r=s.children(),o=r.length,p=t.pageContainer;r.each(function(a,t){e.setRotateYState($(this),"hide",a*AmpGlobal.rotateYTimeStep)}),setTimeout(function(){s.addClass("amp-hide"),n.removeClass("amp-hide"),0!==p.length&&0!==i.length&&(p.removeClass("amp-active"),i.addClass("amp-active")),setTimeout(function(){n.children().each(function(a){e.setRotateYState($(this),"show",a*AmpGlobal.rotateYTimeStep)})},50)},450+(o-3)*AmpGlobal.rotateYTimeStep)},e.setRotateYState=function(e,a,t){setTimeout(function(){"show"===a?e.removeClass("amp-rotateY-hide"):e.addClass("amp-rotateY-hide")},t)},e.animateMove=function(e,a){var t=e.container,n=e.index,i=e.pageContainer,s=a.index,r=a.container,o=a.pageContainer,p="",l="";n>s?(p="amp-animate-move-right-in",l="amp-animate-move-left-out"):(p="amp-animate-move-left-in",l="amp-animate-move-right-out"),r.removeClass("amp-animate-move-right-in amp-animate-move-left-in").addClass(l).removeClass("amp-hide"),setTimeout(function(){r.addClass("amp-hide"),t.removeClass("amp-animate-move-right-out amp-animate-move-left-out").addClass(p).removeClass("amp-hide"),0!==o.length&&0!==i.length&&$("#ampEhallBody").find(".amp-ehall-nav").each(function(e){var a=$(this).children();$(a[s]).hasClass("amp-active")&&r.hasClass("amp-hide")?($(a[s]).removeClass("amp-active"),$(a[n]).addClass("amp-active")):t.addClass("amp-hide")})},250)},e.getCategoryListStr=function(e){var a="";if(e){var t=e.length;if(t>0)for(var n=0;n<t;n++)a+=0!==n?"/"+e[n].categoryName:e[n].categoryName}return a},e.niceScrollInit=function(e,a){e.niceScroll({zindex:1e3,cursorwidth:"4px"})},e.niceScrollResize=function(e){e.getNiceScroll().resize()},e.niceScrollHide=function(e){e.getNiceScroll().hide()},e.customScrollInit=function(e){e.mCustomScrollbar({theme:"minimal-dark"})},e.assemblyAppAttributesToStr=function(a){var t=a.appId,n=a.appKey,i="appShow?appId="+t,s=a.appName,r=a.favoriteApp,o=a.hasPermission,p=a.appPc,l="",m="",c="",d="",u="";p?(l=p.isEnableDescription,m=p.descriptionAuth,c=p.isOpenInNewTab,d=p.isHasHead,u=p.isThirdParty):(l=a.isEnableDescription,m=a.descriptionAuth,c=a.isOpenInNewTab);var f=a.unviewableDescription,g=a.type,v=a.opening,h=a.maintaining,A=a.middleIcon,C=a.version,$=e.getCategoryListStr(a.categoryList),k=' amp-appid="'+t+'"';return k+=' amp-appkey="'+n+'"',k+=' amp-full-screen="'+c+'"',k+=' amp-url="'+i+'"',k+=' amp-title="'+s+'"',k+=' amp-favorite="'+r+'"',k+=' amp-haspermission="'+o+'"',k+=' amp-hasdescription="'+l+'"',k+=' amp-descriptionauth="'+m+'"',k+=' amp-unviewabledescription="'+f+'"',k+=' amp-type="'+g+'"',k+=' amp-opening="'+v+'"',k+=' amp-maintaining="'+h+'"',k+=' amp-img="'+A+'"',k+=' amp-version="'+C+'"',k+=' amp-category="'+$+'"',k+=' amp-hashead="'+d+'"',k+=' amp-isThirdParty="'+u+'"'},e.copyAppAttributesFromDomToDom=function(e,a){a.attr("amp-appid",e.attr("amp-appid")),a.attr("amp-appkey",e.attr("amp-appkey")),a.attr("amp-url",e.attr("amp-url")),a.attr("amp-title",e.attr("amp-title")),a.attr("amp-type",e.attr("amp-type")),a.attr("amp-hashead",e.attr("amp-hashead")),a.attr("amp-isthirdparty",e.attr("amp-isthirdparty")),a.attr("amp-modulename",e.attr("amp-modulename"))},e.loadWidgetComponentHtml=function(e,a){var t=e.appId,n=e.cardId,i=e.desktopNum,s=n;if(s&&"undefined"!==s){var r="card-link-"+s;if(!($("#"+r).length>0)){var o=document.createElement("link");o.id=r,o.rel="import";var p="";p="undefined"!=typeof AMPConfigure.desktop_custom&&AMPConfigure.desktop_custom.pccard_customization?"undefined"==typeof i||i?"pc_card/"+t+"/"+n+"/card.html":"portal_custom/pc_card_custom/"+t+"/"+n+"/card.html":"pc_card/"+t+"/"+n+"/card.html",o.href=p,document.getElementsByTagName("head")[0].appendChild(o),$("body").on("widgetComplete",s,function(){return a(s)})}}},e.replaceHtmlAnnotation=function(e){var a=new RegExp("<![^>]*?>"),t=e.replace(a,"");return t},e.currentPageBlurAnimate=function(a){var t=null,n=$("body").find('article.amp-active[amp-page-flag="true"]');1===n.length?t=n:n.each(function(){var e=$(this),a=e.attr("id");return"ampServiceArticle"===a?(t=e,!1):void("ampEhallArticle"!==a&&"ampClassifyArticle"!==a&&(t=e))}),t&&e.containerBlurAnimate(t,a)},e.containerBlurAnimate=function(e,a){var t=AmpGlobal.blurDegree,n="blur"===a?1:t,i=AmpGlobal.animateTimes,o=60,p=i*o/1e3,l=i/p,m=parseInt(o/p,10),c=r(e);if("blur"===a){if(c===t)return}else if(!c)return;var d={index:n,container:e,flag:a,intervalTimes:l,blurDegree:t,step:m,stopFlag:!1};s(d)},e.setContainerBlue=function(e,a){o(e,a)},e.synchronousAppAttributes=function(e,a){$("body").find('.appFlag[amp-appid="'+e+'"]').each(function(){var e=$(this);for(var t in a){var n=a[t];e.attr(t,n)}}),$("body").find('.ampAppdescFlag[amp-appid="'+e+'"]').each(function(){var e=$(this);for(var t in a){var n=a[t];e.attr(t,n)}})},e.getContainerPosition=function(e){var a=e.offset(),t=e.outerWidth(),n=e.outerHeight();return{top:a.top,left:a.left,right:a.left+t,bottom:a.top+n,width:t,height:n}},e.NewGuid=function(){return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},e.encode=function(e){return $("<div/>").text(e).html()},e.decode=function(e){return $("<div/>").html(e).text()},AmpUtils.tooltipInit=function(){var e=$("body");e.on("mouseover",".tooltipFlag",function(e){p(e)}),e.on("mouseout",".tooltipFlag",function(e){l(e)})},AmpUtils.NewGuid=function(){return m()+m()+"-"+m()+"-"+m()+"-"+m()+"-"+m()+m()+m()},e.setLocalStorageData=function(e,a){var t=window.localStorage;t.setItem(e,a)},e.getLocalStorageData=function(e){var a=window.localStorage;return a.getItem(e)},e.setSessionStorageData=function(e,a){sessionStorage.setItem(e,a)},e.getSessionStorageData=function(e){return sessionStorage.getItem(e)},e.deleteSessionStorageData=function(e){sessionStorage.removeItem(e)},e.animateLoginOut=function(){$("#ampPageBgImg").animate({opacity:"0.5"},10,"swing",function(){$(this).removeClass("amp-login-img").addClass("amp-page-img").animate({opacity:"1"},10,"linear")})},e.animateLoginIn=function(){$("#ampPageBgImg").animate({opacity:"0.5"},10,"swing",function(){$(this).removeClass("amp-page-img").addClass("amp-login-img").animate({opacity:"1"},10,"linear")})},e.getByteLen=function(e){for(var a=0,t=0;t<e.length;t++){var n=e.charAt(t);a+=null!=n.match(/[^\x00-\xff]/gi)?2:1}return a},e.isIE=function(){return!!(window.ActiveXObject||"ActiveXObject"in window)},AmpUtils.getScreenWidthHeight=function(){return{screenH:window.screen.availHeight,screenW:window.screen.availWidth}},e.getTaskAjax=function(e){var a=$.Deferred();return $.ajax({type:"get",url:e,dataType:"jsonp",jsonp:"callback",cache:!1,success:function(e){e.hasLogin||n(),a.resolve(e)},error:function(e){a.reject(e)}}),a.promise()},e.setScroll=function(e,a){return a=a||550,"hidden"===e.css("overflow-y")?void setTimeout(function(){e.getNiceScroll().resize()},a):void setTimeout(function(){AmpUtils.niceScrollInit(e)},a)},e.checkEvent=function(e,a,t){if(e&&a){t=t||50;var n=20;if(e())a();else{var i=null,s=function(){i=setTimeout(function(){e()?(clearTimeout(i),a()):(n--,clearTimeout(i),0!==n&&s())},t)};s()}}},e.getJsonpAppPath=function(){return AMPConstant.jsonpRequestPath},e.setIe9PlaceHolder=function(){navigator.userAgent.indexOf("MSIE 9.0")>0&&$("input,text,textarea").placeholder()},e.setCookie=function(e,a){document.cookie=e+"="+escape(a)+";path=/;expires="+new Date(2099,12,31).toGMTString()},e.getCookie=function(e){var a=document.cookie,t=a.indexOf(e);if(t!=-1){t+=e.length+1;var n=a.indexOf(";",t);n==-1&&(n=a.length);var i=unescape(a.substring(t,n))}return i},e.IsPC=function(){for(var e=navigator.userAgent,a=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],t=!0,n=0;n<a.length;n++)if(e.indexOf(a[n])>0){t=!1;break}return t},e.zhuge=function(e,a,t){},e.dataAnalysis=function(e,a,t,n){"undefined"!=typeof tracker&&(t?n?tracker.identify(e,a,n):tracker.identify(e,a):tracker.track(e,a))},e.moduleName=function(e){var a="",t=e.closest("#ampEhallBody");if(t.hasClass("ampLoadActiveFlag")){var n=t.find("article.amp-active").attr("id");"ampEhallSlideIndex"===n?a="办事大厅-推荐服务":"ampClassifyArticle"===n&&(a="办事大厅-应用分类查看")}var i=e.closest("#ampPersonalAsideLeft");i.length>0&&(a="个人中心-左侧边栏-"+i.find("div#ampPersonalAsideLeftNormal").find("div.amp-active").find("span").html());var s=e.closest(".amp-widget");s.length>0&&(a="个人中心-"+s.children().attr("widget_title")+"卡片");var r=e.closest("#ampPersonalAsideRight");r.length>0&&(a="个人中心-右侧边栏-周期服务");var o=e.closest(".amp-aside-apps");o.length>0&&(a="搜索中心-"+o.children("h5").text());var p=e.closest("#ampServiceRightContent");return p.length>0&&(a="搜索中心-应用列表"),a}}(window.AmpUtils=window.AmpUtils||{}),function(e,a){function t(){$("body").on("click",function(e){var a=$(e.target||e.srcElement),t=a.closest(".amp-wf-head-set"),n=$("body");0===t.length?(n.find(".amp-wf-head.amp-active").removeClass("amp-card-wf-head-keep").removeClass("amp-active"),n.find(".amp-wf-setting.amp-active").removeClass("amp-active")):n.find(".amp-wf-head.amp-active").each(function(){var e=$(this);e.find(".amp-wf-head-set")[0]!==t[0]&&(e.removeClass("amp-card-wf-head-keep").removeClass("amp-active"),e.closest("amp-w-frame").parent().children("amp-w-setting").children(".amp-wf-setting").toggleClass("amp-active"))})})}e.eventsListen=function(){t()},e.getDesktopId=function(){return $("#ampDesktopNav").children(".amp-active").attr("amp-desktop-id")}}(window.AmpWidgetCustom=window.AmpWidgetCustom||{}),function(e,a){function t(e){var a=null;e.pcAppCategory&&(a=i(e.pcAppCategory)),n(a),f(),sessionStorage.setItem("allCanUseApps",JSON.stringify(a));var t=e.appFolderList;sessionStorage.setItem("appFolderListData",JSON.stringify(t))}function n(e){var a=d(e);$("#ampPersonalAsideLeftAllCanUseApps").html(a),AmpUtils.niceScrollInit($("#ampPersonalAsideLeftAllCanUseAppsTabContent")),setTimeout(function(){try{$("#ampPersonalAsideLeftAllCanUseApps").find("input").placeholder()}catch(e){}},0)}function i(e){var a={},t=a.classify=[],n=a.data={};if(e)for(var i=e.length,s=0;s<i;s++){var r=e[s],o=r.categoryId,p=r.appList.length;r.appCount=p,t.push(o),n[o]=r}return a}function s(e,a){var t=$("#ampPersonalAsideLeftAllCanUseAppsTabContent"),n=JSON.parse(sessionStorage.getItem("allCanUseApps")),i=p(n,e,a);t.children('[amp-classify="'+e+'"]').html(i),$("#ampPersonalAsideLeftAllCanUseAppsTabUl").find("li").each(function(){var e=$(this).attr("amp-id"),a=$(this).attr("amp-subid"),t=o(n,e,a);$(this).find(".amp-app-count").text(t)})}function r(){var e="暂无可用应用";"en_US"==AmpGlobal.currentLang&&(e=$.i18n("noAvailableApps"));var a=e;return AmpTemplate.getPersonalEmptyPage(a)}function o(e,t,n){var i=$.trim($("#ampPersonalAsideLeftAllCanUseAppsSearchInput").val()),s=e.data,r=s[t],o=r.subCategoryList,p=[];if(n!=a){for(var l=0;l<o.length;l++)if(o[l].categoryId==n){p=c(o[l].appList,i);break}}else if("all"==t)p=c(r.appList,i);else{p=c(r,i);var m=[],d=[];if(p.length==a)m.push(p.appList);else if(n==a){if("object"==typeof p[0]&&isNaN(p[0].length))for(var l=0;l<p.length;l++)d.push(p[l]);else{var u=p[0];if(u!=a)if(u.length!=a)for(var f=0;f<u.length;f++)d.push(u[f]);else d.push(u);for(var l=1;l<p.length;l++){var g=p[l].appList;if("object"==typeof g&&!isNaN(g.length))for(var v=0;v<g.length;v++)d.push(g[v])}}m.push(d)}p=A(m)}var h=p.length;return h}function p(t,n,i){var s=$.trim($("#ampPersonalAsideLeftAllCanUseAppsSearchInput").val()),o=t.data,p=o[n],d={};if(i!==a){for(var u=p.subCategoryList,f={},g=0;g<u.length;g++)u[g].categoryId===i&&(f=u[g].appList);d=c(f,s)}else d="all"==n?c(p.appList,s):c(p,s);if(""==s&&(e.space.searchFilterFlag=!1),!e.space.searchFilterFlag&&"all"==n){var v=JSON.parse(sessionStorage.getItem("appFolderListData")),A=v.length;A>0&&(d=d.concat(v),h(v))}var C=d.length;if(0===C)return r(d);var k="";if("all"==n||i!=a)k=l(d);else if(d.appList!=a)k=l(d.appList);else if(1==d.length&&"undefined"==typeof d[0].appList)k=l(d);else{for(var b=!1,g=0;g<d.length;g++)if(d[g].appList!=a){b=!0;break}k=b?m(d):l(d)}return k}function l(e){for(var t="",n="",i=e.length,s=$("#tpl-app-single-canUseApp").html(),r=0;r<i;r++){var o=e[r],p=o.middleIcon,l=o.appName,m=AmpUtils.assemblyAppAttributesToStr(o);o.appPc!=a&&o.appPc.isEnableDescription&&(t=$("#tpl-single-hover-app-card-i-icon").html().replace("@attributedesc",m)),o.type&&(t=""),n+=s.replace("@attributes",m).replace("@img",p).replace("@title",l).replace("@iShowIconHtml",t).replace("@appBelongFlag","canUseAppFlag").replace("@top","2").replace("@dragAppFlag","")}return n}function m(e){for(var t="",n="",i="",s="",r=$("#tpl-app-single-canUseApp").html(),o=e.length,p=0;p<o;p++){var l=e[p];if(l.appList==a)if("object"==typeof l&&isNaN(e[0].length)){var m=l.middleIcon,c=l.appName,d=AmpUtils.assemblyAppAttributesToStr(l);l.appPc!=a&&l.appPc.isEnableDescription&&(t=$("#tpl-single-hover-app-card-i-icon").html().replace("@attributedesc",d)),l.type&&(t=""),s+=r.replace("@attributes",d).replace("@img",m).replace("@title",c).replace("@iShowIconHtml",t).replace("@appBelongFlag","canUseAppFlag").replace("@top","2").replace("@dragAppFlag","")}else for(var u=0;u<l.length;u++){var m=l[u].middleIcon,c=l[u].appName,d=AmpUtils.assemblyAppAttributesToStr(l[u]);l[u].appPc!=a&&l[u].appPc.isEnableDescription&&(t=$("#tpl-single-hover-app-card-i-icon").html().replace("@attributedesc",d)),l.type&&(t=""),s+=r.replace("@attributes",d).replace("@img",m).replace("@title",c).replace("@iShowIconHtml",t).replace("@appBelongFlag","canUseAppFlag").replace("@top","2").replace("@dragAppFlag","")}else{for(var f=l.categoryName,g=(l.categoryId,l.appList),v="",h=0;h<g.length;h++){var m=g[h].middleIcon,c=g[h].appName,d=AmpUtils.assemblyAppAttributesToStr(g[h]);g[h].appPc!=a&&g[h].appPc.isEnableDescription&&(t=$("#tpl-single-hover-app-card-i-icon").html().replace("@attributedesc",d)),l.type&&(t=""),v+=r.replace("@attributes",d).replace("@img",m).replace("@title",c).replace("@iShowIconHtml",t).replace("@top","8").replace("@dragAppFlag","")}i+=AmpTemplate.getCanUseAppGroup().replace("@subCategoryName",f).replace("@canUseAppListHtml",v)}}return n=s+i}function c(e,t){var n=new RegExp(t),i=[];if(t)if(e.subCategoryList!==a&&null!==e.subCategoryList&&e.subCategoryList.length>0){for(var s=e.appList.length,r=0;r<s;r++){var o=e.appList[r],p=o.appName;n.test(p)&&i.push(o)}for(var r=0;r<e.subCategoryList.length;r++){for(var o=e.subCategoryList[r],l=o.appList,m=[],c=0;c<l.length;c++){var d=l[c],p=l[c].appName;n.test(p)&&m.push(d)}m.length>0&&(o.appList=m,i.push(o))}}else{var s=e.length;s==a&&(e=e.appList,s=e.length);for(var r=0;r<s;r++){var o=e[r],p=o.appName;n.test(p)&&i.push(o)}}else if(e.subCategoryList!==a&&null!==e.subCategoryList&&e.subCategoryList.length>0){i.push(e.appList);for(var r=0;r<e.subCategoryList.length;r++)i.push(e.subCategoryList[r])}else i=e;return i}function d(e){if(!e)return r();for(var a=e.classify,t=e.data,n=a.length,i="",s="",o=AmpTemplate.getCategoryTabHeadItemTplHtml(),p=$("#tpl-canUseApp-tab-content-item").html(),l={},m=0;m<n;m++){var c=a[m],d=t[c],u=d.categoryName,f="",g=d.appCount,v="",h="",A="";if(h=null!=d.subCategoryList&&d.subCategoryList.length>0?"hasSubCategory":"",A=null!=d.subCategoryList&&d.subCategoryList.length>0?"closeSubCategory":"",i+=o.replace("@id",c).replace("@name",u).replace("@customClass",f).replace("@hasUnReadMarkClass",v).replace("@appCount",g).replace("@hasSubCategoryFlag",h).replace("@subCategoryState",A).replace("@titleName",u),"all"!=c&&(l=d.subCategoryList,null!=l))for(var C=l.length,k=0;k<C;k++){var b=l[k];i+=$("#tpl-sub-category-tab-head-item").html().replace("@id",c).replace("@subId",b.categoryId).replace("@name",b.categoryName).replace("@appCount",b.appList.length)}s+=p.replace("@customClass","").replace("@classify",c).replace("@content","").replace("@id","")}var S="搜索可用服务";"en_US"==AmpGlobal.currentLang&&(S=$.i18n("searchAvailableServices"));var y=$("#tpl-canUseApp-tab").html().replace("@header",i).replace("@content",s).replace("@searchAvailableServices",S);return y}function u(e,a){for(var t=a.length,n=0;n<t;n++){var i=a[n],s=i.appId;e[s]=i}}function f(){var a=$("#ampPersonalAsideLeftAllCanUseApps");a.on("click","li",function(){g($(this))}),a.on("click",".icon-wenti1",function(e){AmpDetail.open($(this).closest(".appFlag")),e.stopPropagation()}),$("#ampPersonalAsideLeftAllCanUseAppsSearchIcon").on("click",function(){e.space.searchFilterFlag=!0,v()}),$("#ampPersonalAsideLeftAllCanUseAppsSearchInput").on("keyup",function(a){if(13===a.keyCode){e.space.searchFilterFlag=!0,$("#ampPersonalAsideleftCanuseappDelete").css("display","block"),v();var t=$.trim($("#ampPersonalAsideLeftAllCanUseAppsSearchInput").val());t&&AmpUtils.zhuge("搜索可用应用",{"关键字":t})}}),$("#ampPersonalAsideLeftAllCanUseAppsDeleteIcon").on("click",function(a){$("#ampPersonalAsideLeftAllCanUseAppsSearchInput").val(""),$(this).parent().css("display","none"),e.space.searchFilterFlag=!1,v()})}function g(e){if(!e.hasClass("amp-active")){var a=$("#ampPersonalAsideLeftAllCanUseApps"),t=a.find("li.openSubCategory");!e.hasClass("amp-canuseapp-sub-category")&&t.length>0&&(k(t),t.removeClass("openSubCategory").addClass("closeSubCategory")),e.hasClass("hasSubCategory")&&(e.hasClass("closeSubCategory")?(C(e),e.removeClass("closeSubCategory").addClass("openSubCategory")):(k(e),e.removeClass("openSubCategory").addClass("closeSubCategory"))),e.siblings(".amp-active").removeClass("amp-active"),e.addClass("amp-active");var n=e.attr("amp-id"),i=e.attr("amp-subid"),r=$("#ampPersonalAsideLeftAllCanUseAppsTabContent");r.children(".amp-category-content-item").addClass("amp-hide"),r.children('[amp-classify="'+n+'"]').removeClass("amp-hide"),s(n,i)}}function v(){var e=$("#ampPersonalAsideLeftAllCanUseAppsTabUl").children(".amp-active").attr("amp-id");s(e)}function h(e){for(var e=e,a=e.length,t=0;t<a;t++){var n=e[t].appId;AmpDataUtils.space.folderData[n]=e[t]}}function A(e){for(var t=[],n=e.length,i=0;i<n;i++){var s=e[i];if(s.appList==a)for(var r=0;r<s.length;r++){var o=s[r];t.push(o)}else for(var p=0;p<s.appList.length;p++){var o=s.appList[p];t.push(o)}}var l={},m=[];u(l,t);for(var c in l){var d=l[c];m.push(d)}return m}function C(e){var e=e,a=e.attr("amp-id"),t=$("#ampPersonalAsideLeftAllCanUseAppsTabUl"),n=t.find(".amp-canuseapp-sub-category[amp-id="+a+"]");t.find("li.amp-canuseapp-sub-category").addClass("amp-hide"),n.each(function(e){var a=$(this);setTimeout(function(){a.removeClass("amp-hide")},150*e)})}function k(e){var e=e,a=e.attr("amp-id"),t=$("#ampPersonalAsideLeftAllCanUseAppsTabUl").find(".amp-canuseapp-sub-category[amp-id="+a+"]");t.length;t.each(function(e){var a=$(this);setTimeout(function(){a.addClass("amp-hide")},150*e)})}e.space={searchFilterFlag:!1},e.show=function(e){s(e)},e.saveData=function(e){t(e)}}(window.AmpCanUseApps=window.AmpCanUseApps||{}),function(e,a){function t(e){var a=null;e.pcCardCategory&&(a=l(e.pcCardCategory)),n(a),d(),sessionStorage.setItem("canUseCardsData",JSON.stringify(a)),AmpUtils.setIe9PlaceHolder()}function n(e){var a=s(e);$("#ampPersonalAsideLeftCanUseCards").html(a),i()||AmpPersonalCenter.showCanUseCardEmptyPage()}function i(){var e=!1,a=$("#ampDesktopNav"),t=a.find(".amp-tab-item").filter("[amp-desktop-id]").length;return t>0&&(e=!0),e}function s(e){if(!e)return p();var a=e.data,t=(a.length,r(a));if(t){var n='<span class="amp-admin-new-desktopnav"></span>';$('.amp-tab-item[amp-id="canUseCards"]').append(n),$('.amp-aside-box-mini-item[amp-id="canUseCards"]').addClass("amp-left-top")}var i="",s="",l=!0;for(var m in a){var c=a[m],d=l?"amp-active":"",u=c.hasUnReadMark,f=u?"tabhasUnReadMark":"",g=o(c);s+=AmpTemplate.getCategoryTabHeadItemHtml({id:m,name:c.categoryName,customClass:d,hasUnReadMarkClass:f,appCount:g});var v=c.appList,h="",A=[];$.each(v,function(e,a){var t=a.appPcCardList;if(t){var n=a.middleIcon;$.each(t,function(e,a){a.middleIcon=n,A.push(a)})}}),h+=AmpPersonalCenter.getCanUseAppsHtml(A,"complex");var C=l?"":"amp-hide";i+=AmpTemplate.getCategoryTabContentItemHtml({id:"ampCategoryContentCanUseItem"+m,content:h,customClass:C,key:m}),l=!1}var k="canUseTabListId",b=AmpTemplate.getCategoryTabHtml({header:s,content:i,tabUlId:k});return b}function r(e){var a=!1;return $.each(e,function(e,t){if(t.hasUnReadMark)return a=!0,!1}),a}function o(e){var a=0,t=e.appList;if(appListLen=t.length,appListLen>0)for(var n in t)t[n].appPcCardList&&(a+=t[n].appPcCardList.length);return a}function p(){var e="暂无可用卡片";"en_US"==AmpGlobal.currentLang&&(e=$.i18n("noAvailableCards"));var a=e;return AmpTemplate.getPersonalEmptyPage(a)}function l(e){var a={},t=a.classify=[],n=a.data={};if(e){e.splice(0,0,m(e));for(var i=e.length,s=0;s<i;s++){var r=e[s],o=r.categoryId,p=r.appList.length;r.appCount=p,t.push(o),n[o]=r}}return a}function m(e){var a=new Object,t=[],n=!1,i="全部";if("en_US"==AmpGlobal.currentLang&&(i=$.i18n("all")),a.categoryName=i,a.categoryId="all",e){for(var s={},r=e.length,o=0;o<r;o++)c(s,e[o].appList),e[o].hasUnReadMark&&(n=!0);for(var p in s){var l=s[p];t.push(l)}a.appList=t,n&&(a.hasUnReadMark=!0)}return a}function c(e,a){for(var t=a.length,n=0;n<t;n++){var i=a[n],s=i.appId;e[s]=i}}function d(){$("#ampPersonalAsideLeftCanUseCards");$("#ampPersonalAsideLeftAllCanUseCardsSearchIcon").on("click",function(){u()}),$("#ampPersonalAsideLeftAllCanUseCardsSearchInput").on("keyup",function(e){if(13===e.keyCode){$("#ampPersonalAsideleftCanusecardDelete").css("display","block"),u();var a=$.trim($("#ampPersonalAsideLeftAllCanUseCardsSearchInput").val());a&&AmpUtils.zhuge("搜索可用卡片",{"关键字":a})}}),$("#ampPersonalAsideLeftAllCanUseCardsDeleteIcon").on("click",function(e){$("#ampPersonalAsideLeftAllCanUseCardsSearchInput").val(""),$(this).parent().css("display","none"),u()})}function u(){var e=$("#canUseTabListId").children(".amp-active").attr("amp-id");f(e)}function f(e){var a=$("#ampCategoryTabContent"),t=JSON.parse(sessionStorage.getItem("canUseCardsData")),n=v(t,e);a.children('[amp-id="'+e+'"]').html(n),$("#canUseTabListId").find("li").each(function(){var e=$(this).attr("amp-id"),a=g(t,e);$(this).find(".amp-app-count").text(a)})}function g(e,a){var t=$.trim($("#ampPersonalAsideLeftAllCanUseCardsSearchInput").val()),n=e.data,i=n[a],s=h(i.appList,t),r=s.length;return r}function v(e,a){var t=$.trim($("#ampPersonalAsideLeftAllCanUseCardsSearchInput").val()),n=e.data,i=n[a],s=h(i.appList,t),r=s.length;if(0===r)return p();var o="",l=[];return $.each(s,function(e,a){var t=a.appPcCardList;if(t){var n=a.middleIcon;$.each(t,function(e,a){a.middleIcon=n,l.push(a)})}}),o+=AmpPersonalCenter.getCanUseAppsHtml(l,"complex")}function h(e,a){var t=new RegExp(a),n=[];if(a)for(var i=e.length,s=0;s<i;s++){var r=e[s],o=r.appName;t.test(o)&&n.push(r)}else n=e;return n}e.show=function(e){f(e)},e.saveData=function(e){t(e)},e.cardtabChange=function(e){if(!e.hasClass("amp-active")){e.siblings(".amp-active").removeClass("amp-active"),e.addClass("amp-active");var a=e.attr("amp-id"),t=$("#ampCategoryTabContent");t.children(".amp-category-content-item").addClass("amp-hide"),t.children('[amp-id="'+a+'"]').removeClass("amp-hide"),f(a)}}}(window.AmpCanUseCard=window.AmpCanUseCard||{}),function(e,a){function t(e){var a=e.attr("amp-id");$("#ampPersonalAsideLeftMini").find(".amp-active").removeClass("amp-active");var t=$("#ampPersonalAsideLeftTabHead").find('[amp-id="'+a+'"]');AmpPersonalCenter.asideLeftTabChange(t)}function n(){var e=416,a=$("#ampDesktopContent").offset().left,t=$("#ampDesktopNav").css("padding-left"),n=$("#ampPersonalAsideLeftTabContent"),i=$("#ampPersonalAsideLeftTabHead"),s=$("#ampPersonalAsideLeftClose"),r=parseInt(e),o=parseInt(a)+parseInt(t);o<r?(n.addClass("amp-aside-covered-bg"),i.find(".amp-tab-item").addClass("amp-aside-covered-bg"),s.addClass("amp-aside-covered-bg")):(n.removeClass("amp-aside-covered-bg"),i.find(".amp-tab-item").removeClass("amp-aside-covered-bg"),s.removeClass("amp-aside-covered-bg"))}$("#ampPersonalAsideLeftMini").on("click",".amp-aside-box-mini-item",function(){localStorage.leftAsideOpenFlag="1",AmpPersonalCenter.setCustomDesktopCenter("left","normal"),t($(this));var e=1e3;setTimeout(function(){n(),"0"!=AmpGlobal.platformType&&(AmpPersonalCenter.showRecommendCrad(),AmpPersonalCenter.setCreateDesktopPosition(),AmpPersonalCenter.initSortingCards()),AmpPersonalCenter.setDesktopBlurHtm(),AmpPersonalCenter.showAdminNewDesktop()},e),AmpUtils.setIe9PlaceHolder()}),$("#ampPersonalAsideLeftClose").on("click",function(){localStorage.leftAsideOpenFlag="0",AmpUtils.setIe9PlaceHolder(),navigator.userAgent.indexOf("MSIE 9.0")>0?setTimeout(function(){AmpPersonalCenter.setCustomDesktopCenter("left","mini")},450):AmpPersonalCenter.setCustomDesktopCenter("left","mini");var e=1e3;setTimeout(function(){setTimeout(function(){var e=$("#ampTabContentItem0");if(e.find(".recommedCard").length>0){var a=e.find(".recommedCard:first").offset().top;$("#ampDesktopContent").animate({
scrollTop:a-240},300)}},200),"0"!=AmpGlobal.platformType&&(AmpPersonalCenter.showRecommendCrad(),AmpPersonalCenter.setCreateDesktopPosition(),AmpPersonalCenter.initSortingCards()),AmpPersonalCenter.setDesktopBlurHtm(),AmpPersonalCenter.showAdminNewDesktop()},e),AmpPersonalCenter.setPcDesktopToolAddOrDrag(!0)})}(window.AmpPersonalLeftAside=window.AmpPersonalLeftAside||{}),function(e,a){function t(a){e.space.lazyComplete=!1;var t={};t.typeName="未读消息",t.start=a,AmpDataUtils.getTagsMessages(t,function(a){n(a),e.space.lazyComplete=!0})}function n(e){var a=$("#ampTagMessages"),t=e.data,n=t.children,s=(t.count,"");0===n.length?(c(),0===a.children(".amp-message-item").length&&(s=i())):s=d(n),a.children(".amp-personal-empty-page").length>0?a.html(s):a.append(s),AmpUtils.setScroll(a,1)}function i(){var e="暂无未读消息";return"en_US"==AmpGlobal.currentLang&&(e=$.i18n("noUnreadMessages")),AmpTemplate.getPersonalEmptyPage(e)}function s(){m();var e=$("#ampTagMessages");e.on("click",".amp-arrow",function(e){o($(this).closest(".amp-message-item").children(".amp-message-description")),e.stopPropagation()}),e.on("click",".icon-chacha",function(e){r($(this).closest(".amp-message-item")),e.stopPropagation()}),$("#ampPersonalMessageHeader").on("click","span",function(){var e=$(this).attr("amp-type");"allRead"===e?(c(),u()):(g(),AmpUtils.zhuge("查看消息中心",{"来源":"个人中心-右侧边栏-点上方的消息栏目时触发"}))})}function r(e){$clickItem=e;var a=$clickItem.attr("amp-message-id");AmpDataUtils.setMsgsRead(a,function(a){if("success"==a.result){var t=$("#messageSumCount"),n=t.text();t.text(parseInt(n)-1),e.addClass("amp-animate-move-right-out"),setTimeout(function(){e.remove()},AmpGlobal.animateTimes)}})}function o(e){var a=p(e);"init"===a?setTimeout(function(){l(e)},10):l(e)}function p(e){var a="hasInit";if(!e.attr("small-height")){a="init";var t=e.children(".amp-message-small"),n=e.children(".amp-message-full"),i=t.outerHeight(),s=n.outerHeight();e.css({height:i+"px"}).attr("small-height",i+"px").attr("full-height",s+"px")}return a}function l(e){var a=e.closest(".amp-message-item");if(a.hasClass("amp-show-full")){var t=e.attr("small-height");e.css({height:t}),setTimeout(function(){a.removeClass("amp-show-full")},AmpGlobal.animateTimes)}else{var n=e.attr("full-height");e.css({height:n}),a.addClass("amp-show-full")}}function m(){$("#ampTagMessages").on("scroll",function(){var a=$(this),n=a.height(),i=a.get(0).scrollHeight,s=a.scrollTop();if(i-n-s-45<=0){var r=a.children().length;e.space.lazyComplete&&t(r)}})}function c(){$("#ampTagMessages").off("scroll")}function d(e){for(var a="",t=e.length,n=0;n<t;n++)a+=AmpTemplate.getTagsMessages(e[n]);return a}function u(){var e=$("#ampTagMessages"),a=window.innerHeight,t=e.offset().top;e.getNiceScroll().hide();var n=[];e.children(".amp-message-item").each(function(e){var i=$(this),s=i.offset().top,r=i.outerHeight(),o=s+r;o>=t&&s<=a&&n.unshift(i)});for(var s=n.length,r=100,o=0;o<s;o++){var p=n[o];f(p,o,r)}setTimeout(function(){AmpDataUtils.setAllTagMsgsRead(function(a){if("success"==a.result){var t=$("#messageSumCount");t.text(0);var n=i();e.html(n),e.getNiceScroll().show()}})},r*s+AmpGlobal.animateTimes)}function f(e,a,t){setTimeout(function(){e.addClass("amp-animate-move-right-out")},a*t)}function g(){window.open("portal/html/message/scenes_message_center.html")}e.space={lazyComplete:!0},s(),e.show=function(){t(0)}}(window.AmpMessage=window.AmpMessage||{}),function(e,a){function t(){var a=$("#ampPersonalAsideLeftMyFavorite");a.on("click","li",function(){var a=$(this).attr("amp-id");"favoriteset"==a?l($(this)):$(this).hasClass("amp-hide")?e.favTabChange($("#myFavoriteTabListId").find('li[amp-id="0"]')):e.favTabChange($(this))}),a.on("click",".amp-app-delete",function(e){var a=$(e.target||e.srcElement),t=a.closest("li");t.addClass("amp-hide"),t.attr("amp-folder-delete","true")}),$("body").on("click",".amp-favorite-icon-jia",function(){$("#ampPageHeaderSearch").click()})}function n(){var t="请移动到正确的目标文件夹",n="归入文件夹成功";"en_US"==AmpGlobal.currentLang&&(t=$.i18n("moveCorrectFolder"),n=$.i18n("belongToFolderSuccess"));var i=$("#ampPersonalAsideLeftMyFavorite");navigator.userAgent.indexOf("MSIE")>=0?$("#myFavoriteTabListId").mouseenter(function(n){var s=$(n.target||n.srcElement),r=s.closest("li"),o=$("#myFavoriteTabListId"),p=o.find("li.amp-active"),l=r.attr("amp-id");r.addClass("amp-drag-active"),e.space.dragingFlag&&l!=a&&""!=l&&i.hasClass("isEditState")&&r.hasClass("amp-drag-active")&&(e.space.dragFolderId=l,e.space.dragingFlag=!1,setTimeout(function(){r.removeClass("amp-drag-active")},1e3),l!=p.attr("amp-id")&&"create"!=l||AmpPrompt.show({content:t})),r.removeClass("amp-drag-active")}):($("#myFavoriteTabListId").mouseup(function(a){var n=$(a.target||a.srcElement),s=n.closest("li"),r=$("#myFavoriteTabListId"),o=r.find("li.amp-active"),p=s.attr("amp-id");console.log(e.space.dragingFlag),navigator.userAgent.indexOf("MSIE 9.0")>0&&s.addClass("amp-drag-active"),e.space.dragingFlag&&i.hasClass("isEditState")&&s.hasClass("amp-drag-active")&&(setTimeout(function(){s.removeClass("amp-drag-active")},1e3),p!=o.attr("amp-id")&&"create"!=p||AmpPrompt.show({content:t}),e.space.dragFolderId=p,e.space.dragingFlag=!1),navigator.userAgent.indexOf("MSIE 9.0")>0&&s.removeClass("amp-drag-active")}),$("#myFavoriteTabListId .amp-favorite-edit").hover(function(){$(this).addClass("amp-drag-active")},function(){$(this).removeClass("amp-drag-active")}))}function i(){var e=JSON.parse(sessionStorage.getItem("myFavoriteAppsData")),a=e.userFavFolders,t=a.length,n=e.searchResult,i="",s="",o={};o.searchApps=n,o.userFavFolders=a;var p=r(o);if(s=p.classifyHtml,i=p.contentsHtml,t>0)for(var l=0;l<t;l++){var m=a[l];o.folderList=m;var c=r(o);s+=c.classifyHtml,i+=c.contentsHtml}var d="新建文件夹";"en_US"==AmpGlobal.currentLang&&(d=$.i18n("createNewFolder")),s+=$("#tpl-myfavorite-create-folder").html().replace("@createNewFolder",d),i+=AmpTemplate.getMyFavoriteCategoryTabContentItemHtml({id:"ampCategoryContentMyFavoriteItemcreate",content:"",customClass:"",key:"create"});var u="myFavoriteTabListId",f=AmpTemplate.geMyfavoriteTabHtml({header:s,content:i,tabUlId:u});return f}function s(){var e="新建文件夹",a="新建文件夹",t="文件夹可以放置您需要放置的应用",n="确定",i="取消",s="5";"en_US"==AmpGlobal.currentLang&&(e=$.i18n("createNewFolder"),a=$.i18n("newFolder"),t=$.i18n("folderCan"),n=$.i18n("confirm"),i=$.i18n("cancel"),s=$.i18n("folderLength"));var r=$("#tpl-myfavorite-create-folder-page").html().replace("@createNewFolder",e).replace("@newFolder",a).replace("@folderCan",t).replace("@confirm",n).replace("@cancel",i).replace("@folderLength",s);$("body").append(r);var o=$("#ampMyFavoriteCreateFolder");$("#ampPersonalAsideLeftMyFavorite").find('li[amp-id="create"]').offset();o.css({left:"120px",top:"108px"})}function r(e){var t=e.searchApps,n=e.folderList,i=e.userFavFolders,s=t,r=s.length,p="",l="",m="",e={},c="",d="",u=0,f="",g="",v=!1,h="amp-active";if(n==a){for(var A=[],C=0;C<t.length;C++)"0"==t[C].favoriteFolderId&&A.push(t[C]);u=t.length,c="0",d="收藏夹","en_US"==AmpGlobal.currentLang&&(d=$.i18n("favorite")),f="amp-active",g="amp-active",m=S(t,i)}else{c=n.wid,d=n.folderName,f="",g="amp-hide",v=!0;for(var k=[],b=0;b<r;b++)t[b].favoriteFolderId==c&&k.push(t[b]);u=k==a?0:k.length,m=o(k,!0,!0)}return h=v?"amp-active":"amp-hide",l+=$("#tpl-myfavorite-app-tab-item").html().replace("@id",c).replace("@name",d).replace("@appCount",u).replace("@activeClass",f).replace("@ampFavoriteType",v).replace("@showiconFlag",h),p+=AmpTemplate.getMyFavoriteCategoryTabContentItemHtml({id:"ampCategoryContentMyFavoriteItem"+c,content:m,customClass:g,key:c}),e.classifyHtml=l,e.contentsHtml=p,e}function o(e,t,n){var i="",s="",r=e==a?0:e.length,o=$("#tpl-app-single-canUseApp").html(),p="";if(n&&(p=$("#tpl-app-single-myfaviriteDragApp").html()),r)for(var l=0;l<r;l++){var m=e[l],c=m.middleIcon,d=m.appName,u=AmpUtils.assemblyAppAttributesToStr(m);m.type&&b(m),m.appPc!=a&&m.appPc.isEnableDescription&&(i=$("#tpl-single-hover-app-card-i-icon").html().replace("@attributedesc",u)),m.type&&(i=""),s+=o.replace("@attributes",u).replace("@img",c).replace("@title",d).replace("@iShowIconHtml",i).replace("@appBelongFlag","myFavoriteFlag").replace("@dragAppFlag",p)}var f="添加应用";return"en_US"==AmpGlobal.currentLang&&(f=$.i18n("addApps")),t&&(s+=$("#tpl-favorite-tool").html().replace("@addApps",f)),s}function p(e){var a=e.folderId,t=e.folderName,n="",i="",s="",r="添加应用";"en_US"==AmpGlobal.currentLang&&(r=$.i18n("addApps")),s=$("#tpl-favorite-tool").html().replace("@addApps",r),n=$("#tpl-myfavorite-app-tab-item").html().replace("@activeClass","amp-active").replace("@id",a).replace("@name",t).replace("@appCount",0).replace("@ampFavoriteType",!0).replace("@showiconFlag","amp-active"),i=AmpTemplate.getMyFavoriteCategoryTabContentItemHtml({id:"ampCategoryContentMyFavoriteItem"+a,content:s,customClass:"amp-active",key:a}),$("#ampPersonalAsideLeftMyFavorite").find('li[amp-id="create"]').removeClass("amp-active").before(n),$("#ampMyFavoriteCategoryTabContent").find('div[amp-classify="create"]').removeClass("amp-active").before(i),$("#ampMyFavoriteCreateFolder").remove()}function l(e){var a=$("#ampPersonalAsideLeftMyFavorite"),t=($("#ampMyfavoriteSetBtn"),a.find("li[amp-folder=true]")),n=$("#myFavoriteTabListId"),i=t.find(".amp-app-delete"),s=t.find(".amp-app-count");v(!0),k(!0),e.hasClass("favoriteArrangeFlag")?(i.removeClass("amp-hide"),s.addClass("amp-hide"),e.addClass("amp-hide").siblings("li").removeClass("amp-hide"),a.addClass("isEditState"),n.find("li").addClass("amp-favorite-edit"),d(),v(!1)):e.hasClass("favoriteCancelFlag")?(c("cancle"),g(),k(!1)):e.hasClass("favoriteSaveFlag")&&(m(),g(),k(!1))}function m(){var e=$("#ampPersonalAsideLeftMyFavorite"),a=$("#ampMyFavoriteCategoryTabContent"),t=e.find('li[amp-folder-delete="true"]'),n=a.find('.myFavoriteFlag[isdragfavoriteappflag="true"]'),i="",s="",r="",o=[];$.each(t,function(e){var a=$(this),t=a.attr("amp-id");s+="'"+t+"',",o.push(a.find(".amp-left-aside-canuseapp-name").text())}),s=s.substr(0,s.length-1),$.each(n,function(e){var a=$(this),t=a.attr("amp-appid"),n=a.closest(".amp-category-content-item").attr("amp-classify");a.attr("isdragfavoriteappflag","false"),r+="{'appId':'"+t+"','folderId':'"+n+"'},"}),r=r.substr(0,r.length-1),i='{"deleteFolderIds":['+s+"],updateAppFavs:["+r+"]}",AmpDataUtils.saveFavFolderOperates(i,function(e){"success"==e.result&&(c("save"),s&&AmpUtils.zhuge("删除收藏文件夹",{"文件夹名称":o.join(",")}),r&&AmpUtils.zhuge("整理收藏夹",{}))}),AmpOpenFavorite.favoriteCardSyncDelFolder(t)}function c(e){var a=$("#ampPersonalAsideLeftMyFavorite"),t=$("#ampMyfavoriteSetBtn"),n=a.find("li[amp-folder=true]"),i=$("#myFavoriteTabListId"),s=$("#ampMyFavoriteCategoryTabContent"),r=n.find(".amp-app-delete"),o=n.find(".amp-app-count");"cancle"==e?(a.find('li[amp-folder-delete="true"]').removeClass("amp-hide").removeAttr("amp-folder-delete"),A(i,s)):"save"==e&&a.find('li[amp-folder-delete="true"]').remove(),r.addClass("amp-hide"),o.removeClass("amp-hide"),t.find("li").addClass("amp-hide"),t.find("li.favoriteArrangeFlag").removeClass("amp-hide"),a.removeClass("isEditState"),i.find("li").removeClass("amp-favorite-edit")}function d(){var e=$("#ampMyFavoriteCategoryTabContent").find(".amp-category-content-item").not(".amp-hide"),a=$("#myFavoriteTabListId");e&&e[0]&&a&&a[0]&&("true "===e.attr("is-sortable-init")&&"true"===a.attr("is-sortable-init")||(u(e,a),e.attr("is-sortable-init","true"),e.attr("is-sortable-init","true")))}function u(a,t){e.space.elRightSort=Sortable.create(t[0],{filter:".myfavorite-create-folder,.amp-active",group:{name:"favoriteApp",put:!1,pull:!1},animation:100,sort:!1,scroll:!1}),e.space.elLeftSort=Sortable.create(a[0],{group:{name:"favoriteApp",put:!1,pull:[!0,"clone"]},forceFallback:!0,animation:100,sort:!1,scroll:!1,filter:".amp-favorite-icon-jia,.amp-canUseApp-group-app",onMoveToSelf:function(e){var a=$(e.dragged);a.addClass("sortable-clonen"),a.removeClass("amp-drag-app-bg"),a.find("img").hide(),a.find("h5").hide()},onMove:function(e){$(e.dragged)},onStart:function(a){var t=$(a.item);t.removeClass("sortable-clonen"),t.addClass("amp-drag-app-bg"),e.space.dragingFlag=!0,n()},onEnd:function(e){var a=$(e.item);a.removeClass("sortable-clonen"),a.removeClass("amp-drag-app-bg"),a.find("img").show(),a.find("h5").show(),f(e)}})}function f(t){$("#myFavoriteTabListId .amp-hover-slow-motion").unbind("mouseenter").unbind("mouseleave");var n=t.item,i=$(n),s=e.space.dragFolderId,r=$("#myFavoriteTabListId"),o=r.find("li.amp-active"),p=$("#ampMyFavoriteCategoryTabContent"),l=o.attr("amp-id"),m="请移动到正确的目标文件夹",c="归入文件夹成功";if("en_US"==AmpGlobal.currentLang&&(m=$.i18n("moveCorrectFolder"),c=$.i18n("belongToFolderSuccess")),s||AmpPrompt.show({content:m}),""!=s&&s!=a&&s!==l){i.attr("isDragFavoriteAppFlag","true");var d=p.find('.amp-category-content-item[amp-classify="'+s+'"]'),u=p.find('.amp-category-content-item[amp-classify="'+l+'"]'),f=r.find('li[amp-id="'+s+'"]').find(".amp-app-count"),g=f.text(),v=o.find(".amp-app-count").text(),A=parseInt(v)-1;f.text(parseInt(g)+1),o.find(".amp-app-count").text(A),d.find(".amp-favorite-icon-jia").before(n),h(n,u),A||0==u.find(".amp-favorite-icon-jia").length&&C(u),AmpPrompt.show({content:c}),e.space.dragFolderId=""}}function g(){e.space.elLeftSort.option("disabled",!0),e.space.elRightSort.option("disabled",!0)}function v(e){var a=e?"amp-active":"amp-hide",t="amp-active"==a?"amp-hide":"amp-active",n=$("#myFavoriteTabListId");n.find('li[amp-id="create"]').addClass(a).removeClass(t),n.find('li[amp-id="create"]').removeClass("amp-active")}function h(e,a){var t=e.outerHTML;"0"==a.attr("amp-classify")?a.children(".appTitleFlag:last").after(t):a.find(".amp-favorite-icon-jia").before(t),a.find('.myFavoriteFlag[isdragfavoriteappflag="true"]').attr("is-old-folder-drag-app","true").removeAttr("isdragfavoriteappflag").addClass("amp-hide")}function A(e,a){var t=a.find('.myFavoriteFlag[is-old-folder-drag-app="true"]');$.each(t,function(a){var t=$(this),n=t.closest(".amp-category-content-item"),i=n.attr("amp-classify"),s=e.find('li[amp-id="'+i+'"]'),r=s.find(".amp-app-count").text();s.find(".amp-app-count").text(parseInt(r)+parseInt(1)),t.removeClass("amp-hide").removeAttr("is-old-folder-drag-app")});var n=a.find('.myFavoriteFlag[isdragfavoriteappflag="true"]');$.each(n,function(a){var t=$(this),n=t.closest(".amp-category-content-item"),i=n.attr("amp-classify"),s=e.find('li[amp-id="'+i+'"]'),r=s.find(".amp-app-count").text();s.find(".amp-app-count").text(parseInt(r)-parseInt(1)),t.remove(),n.find(".myFavoriteFlag").length<1&&C(n)})}function C(e){var a="",t="添加应用";"en_US"==AmpGlobal.currentLang&&(t=$.i18n("addApps")),a=$("#tpl-favorite-tool").html().replace("@addApps",t),e.append(a)}function k(e){var a=$("#ampMyFavoriteCategoryTabContent");e?a.find(".myFavoriteFlag").removeClass("appFlag"):a.find(".myFavoriteFlag").addClass("appFlag")}function b(e){var a=e.appId;AmpDataUtils.space.folderData[a]=e}function S(e,a){for(var e=e,a=a,t=a.length,n="",i="",s=[],r=[],p=0;p<e.length;p++){var l=e[p].favoriteFolderId;"0"==l&&s.push(e[p])}for(var m=0;m<t;m++){for(var c=a[m],d=c.wid,u=c.folderName,f=[],g={},v=0;v<e.length;v++){var l=e[v].favoriteFolderId;d==l&&f.push(e[v])}f.length>0&&(g.folderName=u,g.appList=f,r.push(g))}for(var h=0;h<r.length;h++){var A="",f=r[h].appList,u=r[h].folderName;A=h==r.length-1?o(f,!0,!1):o(f,!1,!1),n+=AmpTemplate.getCanUseAppGroup().replace("@subCategoryName",u).replace("@canUseAppListHtml",A)}return i+=n?o(s,!1,!0):o(s,!0,!0),i+n}e.space={dragFolderId:"",dragingFlag:!1,elLeftSort:"",elRightSort:""},e.initMyFavoriteApps=function(a){sessionStorage.setItem("myFavoriteAppsData",JSON.stringify(a)),e.initMyFavApps(),t(),AmpUtils.niceScrollInit($("#ampMyFavoriteCategoryTabContent"))},e.removeCreateFolderDialog=function(a){var t=$("#ampMyFavoriteCreateFolder");t.length>0&&(t.remove(),a.closest("li.amp-hover-slow-motion").length<1&&e.favTabChange($("#myFavoriteTabListId").find('li[amp-id="0"]')))},e.initMyFavApps=function(){var e=i(),a="整理",t="保存",n="取消";"en_US"==AmpGlobal.currentLang&&(a=$.i18n("organize"),t=$.i18n("save"),n=$.i18n("cancel"));var s=$("#tpl-myfavorite-set").html().replace("@organize",a).replace("@save",t).replace("@cancel",n);$("#ampPersonalAsideLeftMyFavorite").html(e+s)},e.favTabChange=function(e){if(!e.hasClass("amp-active")){var a=$("#ampMyFavoriteCreateFolder");if(a.length>0&&$("#ampMyFavoriteCreateFolder").remove(),"create"==e.attr("amp-id")){var t=$("#myFavoriteTabListId").find('li[amp-folder="true"]').length;if(t>9)return void AmpPrompt.show({content:$.i18n("folderOutOfLimit")});s()}e.siblings(".amp-active").removeClass("amp-active"),e.addClass("amp-active");var n=e.attr("amp-id"),i=$("#ampMyFavoriteCategoryTabContent");i.children(".amp-category-content-item").addClass("amp-hide").removeClass("amp-active"),i.children('[amp-classify="'+n+'"]').removeClass("amp-hide"),d()}},e.saveFolder=function(){var e=$("#ampFolderInput").val();e=$.trim(e);var a={};if(!e){var t="请输入文件夹名称";return"en_US"==AmpGlobal.currentLang&&(t=$.i18n("enterFolderName")),void AmpPrompt.show({content:t})}var n=encodeURI(e);AmpDataUtils.saveUserFavFolder(n,function(t){var n="新建文件夹成功";"en_US"==AmpGlobal.currentLang&&(n=$.i18n("creatFolderSuccess")),AmpPrompt.show({content:n}),a.folderName=e,a.folderId=t.folderId,p(a),AmpOpenFavorite.favoriteCardSyncAddNewFolder(a),AmpUtils.zhuge("新建收藏文件夹",{"文件夹名称":e})})}}(window.AmpMyfavoriteApp=window.AmpMyfavoriteApp||{}),function(e,a){function t(a){var t=null,i=0;if(a){var p=oe(a);if(!p)return!1;t=a.desktopUserList,t=re(t),i=t.length}0===i&&"0"!=AmpGlobal.platformType&&n();for(var l={},m="",c="",d=!0,u=0;u<i;u++){var f=t[u],g=f.desktopId,v=(f.desktopId,f.desktopName),h=f.desktopType,A=f.appPcCardList,C=A?A.length:0,b=0!==u?"":"amp-active",S=1==f.isNew?' <span class="amp-admin-new-desktopnav"></span>':"";if("0"==AmpGlobal.platformType){if("1"==h)continue;b=d?"amp-active":""}m+='<div class="amp-tab-item amp-left-tab-item '+b+'" amp-desktop-id="'+g+'" amp-desktop-type="'+h+'" title="'+v+'">'+v+S+"</div>";var y=x({widgets:A,widgetsLen:C,desktopNum:u});if(0==u){if("0"!=AmpGlobal.platformType){var w=a.appPcCardBizList;if(w){var P=w.length,I="recommedCard";y+=x({widgets:w,widgetsLen:P,recommCardClass:I})}}}else if("0"!=AmpGlobal.platformType){var U={};U.desktopId=g,U.desktopName=v,U.desktopType=h,c+=AmpTemplate.getRecommendDesktopNav(U)}"0"!=AmpGlobal.platformType&&("undefined"!=typeof AMPConfigure.desktop_custom&&AMPConfigure.desktop_custom.pccard_customization&&0==u?y=y:(y+=AmpTemplate.getWidgetAddCardMainHtml(),y+=AmpTemplate.getWidgetDragCardMainHtml())),y='<div id="ampTabContentItem'+u+'" class="amp-tab-content-item amp-active amp-animated amp-animate-move-bottom-in" amp-desktop-id="'+g+'"  amp-desktop-type="'+h+'">'+y+"</div>";var D=$("#ampDesktopContent");0===u?(D.off("animationend").on("animationend",".amp-tab-content-item",function(){"0"!=AmpGlobal.platformType&&(o(),k(),setTimeout(function(){e.showRecommendCrad(),e.showAdminNewDesktop()},0))}),D.html(y),AmpWidgetUtils.addLoadingToWidget(D)):("0"==AmpGlobal.platformType&&("0"==h&&d&&(D.html(y),AmpWidgetUtils.addLoadingToWidget(D)),d=!1),l[g]=y)}if("0"!=AmpGlobal.platformType){var L=$("#tpl-personalCenterSet-btn").html();m+=L}$("#ampDesktopNav").html(m),sessionStorage.setItem("ampDesktopData",JSON.stringify(l)),sessionStorage.setItem("recommendDesktopNavHtml",c),setTimeout(function(){e.space.desktopRefresh?r():s()},10)}function n(){var e=$("#ampDesktopNav"),a=$("#ampDesktopContent"),t="";if("0"!=AmpGlobal.platformType){var n=$("#tpl-personalCenterSet-btn").html();t+=n}e.html(t),e.addClass("amp-active");var i="新建桌面",s="开启全新服务体验";"en_US"==AmpGlobal.currentLang&&(i=$.i18n("createANewDesktop"),s=$.i18n("openANewServiceExperience"));var r=$("#tpl-desktop-ampty-page").html().replace("@openANewServiceExperience",s).replace("@createANewDesktop",i);a.html(r)}function i(e){AmpMyfavoriteApp.initMyFavoriteApps(e),s()}function s(){e.space.loadState++,e.space.loadState===e.space.loadCompleteState&&(AmpLoading.close(),$("#ampPersonalAsideLeft").removeClass("amp-hide"),$("#ampPersonalAsideRight").removeClass("amp-hide"),r(),e.space.favEmpty&&ee(),(navigator.userAgent.indexOf("MSIE")>0||AmpUtils.isIE())&&($("#ampDesktopContent").getNiceScroll().remove(),AmpUtils.niceScrollInit($("#ampDesktopContent"))),se(),pe())}function r(){S(),X(),p(),e.setCustomDesktopCenter()}function o(){var e=E();e&&N();$("#ampDesktopContent"),$("#ampDesktopNav")}function p(){var a=$("#ampDesktopContent"),t=$("#ampDesktopNav"),n=t.find(".amp-active").attr("amp-desktop-id"),i=a.children('[amp-desktop-id="'+n+'"]'),s=i.children(),r=150,p=E();s.each(function(e){var a=$(this);if(p){if(a.hasClass("amp-widget-add"))return!0;a.hasClass("ampLoadingDragCompleteFlag")&&a.removeClass("amp-widget-drag-hide")}else a.hasClass("ampLoadingDragCompleteFlag")&&a.addClass("amp-widget-drag-hide");a.removeClass("amp-hide"),setTimeout(function(){"true"===a.find("amp-w-frame").attr("has-scroll")&&AmpUtils.niceScrollInit(a.find(".amp-wf-body"))},460)}),navigator.userAgent.indexOf("MSIE")>0&&navigator.userAgent.indexOf("MSIE 9.0")>0&&"0"!=AmpGlobal.platformType&&(o(),k(),setTimeout(function(){e.showRecommendCrad(),e.showAdminNewDesktop()},0));var l=s.length;setTimeout(function(){var e=parseInt($("#ampDesktopContent").width()/540),a=AmpTemplate.getDesktopBlurHtm(e);$("#ampDesktopContent").append(a),s.each(function(e){var a=$(this);if(a.hasClass("recommedCard")){var t="newRecommendCard"+e;$(a).addClass(t);var n=a.children().attr("widget_title");"en_US"==AmpGlobal.currentLang&&(n=a.children().attr("widget_title_enus"));var i='<div class="widget-name-title"><span>'+n+"</span></div>";$("body").append(i);var s=$(".widget-name-title span").width()+25+"px";$("body").append('<style type="text/css">.'+t+":after {left:"+s+";} </style>"),$("body").find(".widget-name-title").remove()}})},l*r),setTimeout(function(){e.openAsideBoxConfig()},l*r),"0"==AmpGlobal.platformType&&a.find(".amp-widget").find(".amp-wf-head").removeClass("amp-card-move-flag")}function l(){$("#ampDesktopNav").on("click",".amp-tab-item",function(){var e=$(this);if(e.hasClass("ampDesktopAddFlag"))y($(this));else if(e.hasClass("ampDesktopSetFlag"))navigator.userAgent.indexOf("MSIE")>0||AmpUtils.isIE()?$("#ampPersonalArticle").addClass("amp-hide").removeClass("amp-active"):$("#ampPersonalArticle").addClass("amp-hide").removeClass("amp-active"),setTimeout(function(){AmpDesktopSet.init()},AmpGlobal.animateTimes);else{if(e.hasClass("amp-desktop-admin"))return;e.hasClass("amp-desktop-add-input-container")||(m($(this)),I()),AmpUtils.zhuge("切换桌面",{"桌面名称":e.text()})}}),$("#ampDesktopContent").on("click",".empty-desktop-create",function(){y($(this))}),$("#ampPersonalAsideLeftTabHead").on("click",".amp-tab-item",function(){g($(this),!0),"canUseCards"==$(this).attr("amp-id")&&N(),R($(this))}),$("#ampPersonalAsideLeftCanUseCards").on("click","li",function(){AmpCanUseCard.cardtabChange($(this));$(this);"canUseTabListId"==$(this).parent().attr("id")&&(N(),J($(this)),D())}),$("#ampDesktopContent").on("click",".amp-widget-add",function(){e.setPcDesktopToolAddOrDrag(!1),U()}),$("#ampPersonalAsideLeftCanUseCards").on("click touchend",".amp-app-complex-add",function(){var e=ae($(this));e&&H($(this))}),$("#ampPersonalAsideLeftCanUseCards").on("click touchend",".amp-app-complex-del",function(){var e=ae($(this));e||M($(this))}),$("#ampDesktopContent").on("click",".amp-recommend-no-need",function(){W()}),$("#ampDesktopContent").on("click",".recommend-keep-title",function(){z()}),$("#ampDesktopContent").on("click",".desktop-title",function(){$("#ampRecommendShowDesktop").toggle()}),$("#ampDesktopContent").on("click",".recommend-keep-desktop-nav",function(){q($(this))}),$("#ampDesktopContent").on("click",".amp-recommend-i-know",function(){K($(this))}),$("#ampDesktopNav").on("click",".amp-create-btn-cancel",function(){te($(this))}),$("#ampDesktopNav").on("click",".amp-create-btn-save",function(){ne($(this))}),$("#ampCreateDesktopInput").on("change",function(){}),$("#ampDesktopContent").scroll(function(){ie()}),$("#ampDesktopContent").scroll(function(){var e=$("#ampDesktopContent").scrollTop();e>0?($("#amp-desktopBlur").css("opacity","1"),$("#amp-desktopBlur").css("height","20px")):$("#amp-desktopBlur").css("height","0")}),$("body").on("click",".amp-myfavorite-create-folder",function(e){var a=$(e.target||e.srcElement),t=$("#ampMyFavoriteCreateFolder");"ampFolderCancle"==a.attr("id")&&(t.remove(),AmpMyfavoriteApp.favTabChange($("#myFavoriteTabListId").find('li[amp-id="0"]'))),"ampFolderSave"==a.attr("id")&&AmpMyfavoriteApp.saveFolder()})}function m(e){var a=$("#ampDesktopNav"),t=a.find(".amp-active"),n=t.attr("amp-desktop-id"),i=e.attr("amp-desktop-id");if("undefined"!=typeof AMPConfigure.desktop_custom&&AMPConfigure.desktop_custom.pccard_customization){var s=$("#ampPersonalAsideLeftTabHead").find('.amp-tab-item[amp-id="canUseCards"]').hasClass("amp-active");s&&a.find(".amp-tab-item:first").attr("amp-desktop-id")==i&&$("#ampPersonalAsideLeftTabHead").find('[amp-id="myFavorite"]').click()}t.removeClass("amp-active"),e.addClass("amp-active");var o=$("#ampDesktopContent"),p=o.children('[amp-desktop-id="'+n+'"]');p.removeClass("amp-active"),p.find(".amp-widget").addClass("amp-hide");var l=o.children('[amp-desktop-id="'+i+'"]');if(l.addClass("amp-active"),0!==l.length)l.removeClass("amp-hide");else{var m=JSON.parse(sessionStorage.getItem("ampDesktopData"))[i];o.append(m),AmpWidgetUtils.addLoadingToWidget(o)}c(i),r(),1==e.find("span").length&&Q(i)}function c(t){var n=$("#ampDesktopContent"),i=e.space.sessionStorageRecommendData,s=i.length;if(s>0)for(var r in i){var o=i[r],p=o.desktopId,l=o.cardWid,m=(o.cardId,o.desktopRecommendCardHtm);if(p==t){var c=n.children('[amp-desktop-id="'+t+'"]').children(),d=c.filter('[widget-wid="'+l+'"]').length;if(0==d){var u="";for(var r in c){var f=c[r];r==c.length-3?(u+=m,f.outerHTML!=a&&(u+=f.outerHTML)):f.outerHTML!=a&&(u+=f.outerHTML)}n.children('[amp-desktop-id="'+t+'"]').html(u)}}}}function d(){var e=sessionStorage.getItem("canUseCards"),a=$("#ampPersonalAsideLeftCanUseCards"),t=$(e).find("ul li").length;if(0==t||!t){var n="暂无应用卡片";"en_US"==AmpGlobal.currentLang&&(n=$.i18n("noAppCards"));var i=n,s=AmpTemplate.getPersonalEmptyPage(i);e=s}a.html(e),Z(),D()}function u(e){var a=e.cardId,t=!1,n=$("#ampDesktopNav"),i=$("#ampDesktopContent"),s=n.find(".amp-active").attr("amp-desktop-id"),r=i.children('[amp-desktop-id="'+s+'"]'),o=r.children();return o.each(function(e){var n=$(this),i=n.attr("widget-id");if(a==i)return t=!0,!1}),t}function f(e,a){return a=a||550,"hidden"===e.css("overflow-y")?void setTimeout(function(){e.getNiceScroll().resize()},a):void setTimeout(function(){AmpUtils.niceScrollInit(e)},a)}function g(a,t){var n=a.attr("amp-id"),i={myFavorite:"#ampPersonalAsideLeftMyFavorite",allCanUseApps:"#ampPersonalAsideLeftAllCanUseAppsTabContent"}[n];if("undefined"!=typeof AMPConfigure.desktop_custom&&AMPConfigure.desktop_custom.pccard_customization&&"canUseCards"==n&&$("#ampDesktopNav").find(".amp-tab-item:first").hasClass("amp-active"))return void AmpPrompt.show({content:"当前桌面不能添加卡片，请选择其他桌面添加！"});if(a.hasClass("amp-active"))return v(a),h(a),i&&f($(i)),void("canUseCards"==n&&(e.setPcDesktopToolAddOrDrag(!1),D()));var s=a.closest(".amp-tab"),r=s.find(".amp-tab-content"),o=s.find(".amp-tab-item.amp-active"),p=o.attr("amp-id");o.removeClass("amp-active"),r.children('[amp-id="'+p+'"]').addClass("amp-hide"),a.addClass("amp-active"),r.children('[amp-id="'+n+'"]').removeClass("amp-hide");var l=null;if("allCanUseApps"===n){var m=$("#ampPersonalAsideLeftAllCanUseAppsTabUl");0===m.children("amp-active").length&&m.children('[amp-id="all"]').click(),l=$("#ampPersonalAsideLeftAllCanUseAppsTabContent"),scrollCateUlPan=$("#ampPersonalAsideLeftAllCanUseAppsTabUl")}else if("canUseCards"===n){e.setPcDesktopToolAddOrDrag(!1),D();var c=$("#ampPersonalAsideLeftCanUseCards");0===$.trim(c.html()).length&&d();var u=c.find("ul li:first");J(u),l=$("#ampPersonalAsideLeftCanUseCards #ampCategoryTabContent"),scrollCateUlPan=$("#ampPersonalAsideLeftCanUseCards #canUseTabListId")}else l=$("#ampPersonalAsideLeftMyFavorite");l&&(t?(f(l,1),f(scrollCateUlPan,1)):(f(l),f(scrollCateUlPan)))}function v(e){var a=e.attr("amp-id");if("allCanUseApps"===a){var t=$("#ampPersonalAsideLeftAllCanUseAppsTabUl");0===t.children(".amp-active").length&&t.children('[amp-id="all"]').click()}}function h(e){var a=e.attr("amp-id");if("canUseCards"===a){var t=$("#canUseTabListId");t.children('[amp-id="all"]').hasClass("amp-active")&&t.children('[amp-id="all"]').click()}}function A(){$("body").on("widgetRemove",function(e,a){var t=(a.desktopId,a.desktopType,a.widgetId,a.cardWid,a.cardName),n=a.desktopName;AmpDataUtils.deleteUserDesktopCard(a,function(e){if("success"===e.result){var a="删除成功";"en_US"==AmpGlobal.currentLang&&(a=$.i18n("deletedSuccessfully")),AmpPrompt.show({content:a}),N(),AmpUtils.zhuge("删除桌面卡片",{"桌面名":n,"卡片名":t,"来源":"卡片右上方点删除"})}})})}function C(e,a){return e+=$("#tpl-widget-main-item").html().replace("@content","").replace("@widgetId","ampEmptyWidgetPlaceholderFlag")}function k(){var e=$("#ampDesktopNav"),a=e.find(".amp-active").attr("amp-desktop-id"),t=e.find(".amp-active").attr("amp-desktop-type"),n={};n.desktopId=a,n.desktopType=t;var i=$("#ampDesktopContent"),s=i.children(".amp-active");"true"!==s.attr("is-sortable-init")&&(navigator.userAgent.indexOf("MSIE")>0&&navigator.userAgent.indexOf("MSIE 9.0")>0&&(document.body.onselectstart=document.body.ondrag=function(){return!1}),b(s[0]),s.attr("is-sortable-init","true"));var r=window.navigator.userAgent;r.indexOf("Safari")>0&&s.find(".amp-widget-drag").length>1&&s.find(".amp-widget-drag:eq(1)").addClass("amp-hide")}function b(e){Sortable.create(e,{filter:".amp-card-hasno-drag",handle:".amp-card-wf-head",animation:150,draggable:".amp-widget-only-drag",scroll:!1,ghostClass:"amp-sort-ghost-class",dragClass:"amp-sort-drag-class",onEnd:function(){var e=$("#ampDesktopNav"),a=$("#ampDesktopContent"),t=e.find(".amp-active").attr("amp-desktop-id"),n=e.find(".amp-active").attr("amp-desktop-type"),i=a.children('[amp-desktop-id="'+t+'"]'),s=i.children().not(".recommedCard"),r={};r.desktopId=t,r.desktopType=n,j(s,r),ie()}})}function S(){var e=$("#ampDesktopNav"),a=e.find(".amp-tab-item").filter('[amp-desktop-type="1"]').length;a>=3&&e.find(".ampDesktopAddFlag").remove()}function y(e){if(!e.hasClass("amp-btn-active")){$(".ampDesktopAddFlag")&&1==$(".ampDesktopAddFlag").length&&$(".ampDesktopAddFlag").addClass("amp-btn-active"),$(".empty-desktop-create")&&1==$(".empty-desktop-create").length&&$(".empty-desktop-create").addClass("amp-btn-active");var a=AmpTemplate.createDesktopDialogHtm();$("#ampDesktopNav").append(a),$("#ampCreateDesktopInput").focus().select();var t=$("#ampDesktopNav").find(".ampDesktopAddFlag").offset().left-$("#ampPersonalAsideLeft").width()-16;$("#ampAdminNewDesktop").css("left",""+t+"px")}}function w(e,a){var t="",n=e.desktopId,i=a,s=1;t+='<div class="amp-tab-item amp-active" amp-desktop-id="'+n+'" amp-desktop-type="'+s+'">'+i+"</div>";$("#ampDesktopNav").children().filter('[amp-desktop-type="0"]:first');$("#ampDesktopNav").find(".amp-tab-item.amp-active").removeClass("amp-active"),$(".ampDesktopBtn:first").before(t);var r=$("#ampDesktopNav [amp-desktop-id]").length-1,o="",p=1;o+=AmpTemplate.getWidgetDragCardMainHtml(),o+=AmpTemplate.getWidgetAddCardMainHtml(),o=C(o,p),o='<div id="ampTabContentItem'+r+'" class="amp-tab-content-item amp-active amp-animated amp-animate-move-bottom-in" amp-desktop-id="'+n+'" amp-desktop-type="'+s+'">'+o+"</div>";var l=$("#ampDesktopContent");l.find(".amp-tab-content-item").removeClass("amp-active").addClass("amp-hide"),l.append(o),P(),S(),X(),N()}function P(){var e=$("#ampDesktopNav"),a=$("#ampDesktopContent"),t=e.find(".amp-active").attr("amp-desktop-id"),n=a.find('.amp-tab-content-item[amp-desktop-id="'+t+'"]');n.find(".amp-widget-add").addClass("amp-hide").removeClass("amp-animate-move-bottom-in"),n.find(".amp-widget-drag").removeClass("amp-widget-drag-hide"),
U()}function I(){var e=$("#ampPersonalAsideLeft"),a=$("#ampDesktopNav"),t=$("#ampDesktopContent"),n=a.find(".amp-active").attr("amp-desktop-id"),i=t.find('.amp-tab-content-item[amp-desktop-id="'+n+'"]');e.hasClass("amp-mini")&&(i.find(".amp-widget-add").removeClass("amp-hide").addClass("amp-animate-move-bottom-in"),i.find(".amp-widget-drag").addClass("amp-widget-drag-hide"))}function U(){var e=$("#ampPersonalAsideLeft"),a=$("#ampPersonalAsideLeftTabHead").find('[amp-id="canUseCards"]');e.hasClass("amp-mini")?($("#ampPersonalAsideLeftMini .amp-aside-box-mini-item").click(),a.click()):a.hasClass("amp-active")||a.click()}function D(){var e=$("#ampDesktopContent"),a=$("#ampPersonalAsideLeftCanUseCards"),t=a.find(".amp-category-content-item").not(".amp-hide"),n=e.children(".amp-active"),i=a.find("ul");t&&t[0]&&n&&n[0]&&("true"===t.attr("is-sortable-init-side")&&"true"===n.attr("is-sortable-init-side")||(L(t,n),t.attr("is-sortable-init-side","true")),"true"===n.attr("is-sortable-init-side")&&"true"===i.attr("is-sortable-init-side")||(T(i,n),n.attr("is-sortable-init-side","true")))}function L(a,t){Sortable.create(a[0],{filter:".ampHasAddedFlag,.amp-card-hasno-drag",group:{name:"card",pull:"clone",put:!1},animation:100,sort:!1,scroll:!1,onMoveToSelf:function(e){var a=$(e.dragged);a.removeClass("amp-sorting-crad-change-big"),a.find("h5").removeClass("apphasUnReadMark"),a.find(".amp-app-complex-btn").addClass("amp-app-complex-add")},onMove:function(e){var a=$(e.dragged);a.addClass("amp-sorting-crad-change-big"),a.find("h5").removeClass("apphasUnReadMark"),a.find(".amp-app-complex-btn").removeClass("amp-app-complex-add")},onEnd:function(a){var t=a.item,n=$(t),i=$(a.clone),s=$(a.item);i.find(".amp-app-complex-btn").removeClass("amp-app-complex-add").addClass("amp-app-complex-del"),s.find(".amp-app-complex-btn").removeClass("amp-app-complex-add").addClass("amp-app-complex-del"),i.addClass("ampHasAddedFlag"),s.addClass("ampHasAddedFlag");var r=[],o=0,p=F(n);r.push(p),o=r.length;var l="dragToDesktop",m=x({widgets:r,widgetsLen:o,dragCardClass:l}),c=$("#ampDesktopNav"),d=$("#ampDesktopContent"),u=c.find(".amp-active").attr("amp-desktop-id"),f=c.find(".amp-active").attr("amp-desktop-type"),g=d.children('[amp-desktop-id="'+u+'"]');0!=g.find(".amp-app-complex").length?g.find(".amp-app-complex").after(m).remove():g.find(".amp-widget-add").before(m),setTimeout(function(){e.showRecommendCrad()},450),d.find(".dragToDesktop").removeClass("amp-hide").addClass("amp-animate-move-bottom-in");var v=d.children('[amp-desktop-id="'+u+'"]'),h=v.children().not(".recommedCard"),A={};A.desktopId=u,A.desktopType=f,j(h,A),ie()}}),navigator.userAgent.indexOf("MSIE 9.0")<0&&Sortable.create(t[0],{group:{name:"card",put:[a[0].id]},forceFallback:!0,animation:100,scroll:!1,filter:".amp-card-hasno-drag"})}function T(e,a){var e=e,a=a;Sortable.create(e[0],{group:{name:"card",pull:"clone",put:!1},animation:100,sort:!1,scroll:!1,filter:".amp-card-hasno-drag",onMoveToSelf:function(e){$(e.dragged).removeClass("amp-sorting-crad-change-big"),$(e.dragged).find("h5").removeClass("tabhasUnReadMark")},onMove:function(e){$(e.dragged).addClass("amp-sorting-crad-change-big"),$(e.dragged).find("h5").removeClass("tabhasUnReadMark")},onEnd:function(e){var a=$(e.item).attr("amp-id"),t=$("#ampCategoryTabContent"),n=t.children('[amp-id="'+a+'"]').children();n=n.find(".amp-app-complex-add").closest(".amp-app-complex");var i=[],s=0,r=[];n.each(function(){var e=$(this);e.addClass("ampHasAddedFlag");var a=F(e);i.push(a),r.push(e.attr("card-name"))}),s=i.length;var o="dragToDesktop",p=x({widgets:i,widgetsLen:s,dragCardClass:o}),l=$("#ampDesktopNav"),m=$("#ampDesktopContent"),c=l.find(".amp-active").attr("amp-desktop-id"),d=l.find(".amp-active").attr("amp-desktop-type"),u=l.find(".amp-active").text(),f=m.children('[amp-desktop-id="'+c+'"]');f.find("li.amp-sorting-crad-change-big").after(p).remove(),m.find(".dragToDesktop").removeClass("amp-hide").addClass("amp-animate-move-bottom-in"),n.find(".amp-app-complex-btn").removeClass("amp-app-complex-add").addClass("amp-app-complex-del");var g=m.children('[amp-desktop-id="'+c+'"]'),v=g.children().not(".recommedCard"),h={};h.desktopId=c,h.desktopType=d,h.desktopName=u,h.cardName=r,j(v,h),ie()}}),navigator.userAgent.indexOf("MSIE 9.0")<0&&Sortable.create(a[0],{group:{name:"card",put:[e[0].id]},animation:100,scroll:!1,onStart:function(){alert("拖拽开始了哦")}})}function F(e){var a=e.attr("amp-appid"),t=e.attr("cardnickname"),n=e.attr("card-name"),i=e.attr("app-card-wid"),s={appId:a,cardName:n,cardId:t,cardWid:i};return s}function x(e){for(var a=e.widgets,t=e.widgetsLen,n=e.dragCardClass,i=e.recommCardClass,s=e.desktopNum,r="",o={},p=0;p<t;p++){var l=a[p],m=l.cardName,c=l.cardNameEnus,d=l.cardId,u=l.cardWid||l.wid,f=l.hasAuthLose,g=l.appId,v=l.cardId,h=l.appKey,A=!0,C={};if(C.appId=g,C.cardId=v,C.desktopNum=s,AmpUtils.loadWidgetJson(C).done(function(e,a){m&&(e.widget_title=m),o[a.cardId]=e}).fail(function(e,a){A=!1}),!A)return;AmpUtils.loadWidgetComponentHtml(C,function(e){AmpWidgetUtils.loadWidgetComplete(e,"main")}),r+=f?AmpTemplate.getWidgetLostPermissionCard({widgetId:d,widgetWid:u}):AmpTemplate.getWidgetMainItemHtml({widgetId:d,dragCardClass:n,widgetWid:u,recommCardClass:i,widgetsJsonData:o,appId:g,appKey:h,widgetTitle:m,widgetTitleEnus:c})}return r}function H(a){var a=a;a.removeClass("amp-app-complex-add").addClass("amp-app-complex-del"),a.closest(".amp-app-complex").addClass("ampHasAddedFlag"),_(a),setTimeout(function(){var t=[],n=0,i=a.parent(),s=F(i);t.push(s),n=t.length;var r="dragToDesktop",o=x({widgets:t,widgetsLen:n,dragCardClass:r}),p=$("#ampDesktopNav"),l=$("#ampDesktopContent"),m=p.find(".amp-active").attr("amp-desktop-id"),c=p.find(".amp-active").attr("amp-desktop-type"),d=l.children('[amp-desktop-id="'+m+'"]'),u=p.find(".amp-active").text();setTimeout(function(){var a=d.children().filter(".recommedCard");a.length>0?(a.first().before(o),setTimeout(function(){e.showRecommendCrad()},450)):d.find(".amp-desktop-tool:first").before(o),l.find(".dragToDesktop").removeClass("amp-hide").addClass("amp-animate-small-to-big"),setTimeout(function(){l.find(".dragToDesktop").removeClass("amp-animate-small-to-big").removeClass("dragToDesktop"),B()},500);var t=l.children('[amp-desktop-id="'+m+'"]'),n=t.children().not(".recommedCard"),s={};s.desktopId=m,s.desktopType=c,s.desktopName=u,s.cardName=i.children("h5").text(),j(n,s)},100),$("body").find(".clone-img").remove()},500)}function M(a){var a=a;a.removeClass("amp-app-complex-del").addClass("amp-app-complex-add"),a.closest(".amp-app-complex").removeClass("ampHasAddedFlag");var t=(a.parent().attr("cardnickname"),a.parent().attr("app-card-wid")),n=a.parent().text(),i=$("#ampDesktopNav"),s=$("#ampDesktopContent"),r=i.find(".amp-active").attr("amp-desktop-id"),o=i.find(".amp-active").attr("amp-desktop-type"),p=i.find(".amp-active").attr("title"),l=s.children('[amp-desktop-id="'+r+'"]'),m=l.children('[widget-wid="'+t+'"]'),c=m.hasClass("recommedCard");if(m.addClass("amp-animate-big-to-small"),m.hide(100,function(){$(this).remove(),setTimeout(function(){e.showRecommendCrad()},150)}),c){var d={};d.cardWid=t,O(d)}else{var u={};u.desktopId=r,u.desktopType=o,u.cardWid=t,u.desktopName=p,AmpDataUtils.deleteUserDesktopCard(u,function(e){if("success"===e.result){var a="删除成功";"en_US"==AmpGlobal.currentLang&&(a=$.i18n("deletedSuccessfully")),AmpPrompt.show({content:a}),AmpUtils.zhuge("删除桌面卡片",{"桌面名":p,"卡片名":n,"来源":"左侧可用卡片中点-按钮"})}})}}function N(e){var a=($("#ampDesktopContent"),$("#ampPersonalAsideLeftCanUseCards")),t=a.find(".amp-category-content-item").not(".amp-hide"),n=t.children();n.each(function(){e=$(this);var a=e.attr("app-card-wid"),t=!1,n=$("#ampDesktopNav"),i=$("#ampDesktopContent"),s=n.find(".amp-active").attr("amp-desktop-id"),r=i.children('[amp-desktop-id="'+s+'"]'),o=r.children();o.each(function(n){var i=$(this),s=i.attr("widget-wid");return a==s&&(t=!0),t?(e.find(".amp-app-complex-btn").addClass("amp-app-complex-del").removeClass("amp-app-complex-add"),e.addClass("ampHasAddedFlag"),!0):(e.find(".amp-app-complex-btn").addClass("amp-app-complex-add").removeClass("amp-app-complex-del"),e.removeClass("ampHasAddedFlag"),!0)})})}function R(e){var a=E(),t=$("#ampDesktopNav"),n=$("#ampDesktopContent"),i=t.find(".amp-active").attr("amp-desktop-id"),s=n.find('.amp-tab-content-item[amp-desktop-id="'+i+'"]');a?(s.find(".amp-widget-add").addClass("amp-hide").removeClass("amp-animate-move-bottom-in"),s.find(".amp-widget-drag").removeClass("amp-widget-drag-hide")):(s.find(".amp-widget-add").removeClass("amp-hide").addClass("amp-animate-move-bottom-in"),s.find(".amp-widget-drag").addClass("amp-widget-drag-hide")),s.children().hasClass("ampEmptyWidgetPlaceholderFlag")&&s.find(".ampEmptyWidgetPlaceholderFlag").removeClass("amp-hide")}function E(){var e=!1,a=$("#ampPersonalAsideLeftTabHead"),t=a.children(".amp-active").attr("amp-id");return"canUseCards"==t&&(e=!0),e}function G(){var e=!1,a=$("#ampDesktopNav"),t=$("#ampDesktopContent"),n=a.find(".amp-active").attr("amp-desktop-id"),i=a.find(".amp-tab-item:first").attr("amp-desktop-id"),s=t.children('[amp-desktop-id="'+n+'"]');return n==i&&s.children().hasClass("recommedCard")&&(e=!0),e}function _(e){var a=e,t=a.siblings(".amp-app-complex-img"),n=t.clone().addClass("clone-img").css("opacity","0.7"),i=$("#ampDesktopContent"),s=$("#ampDesktopNav"),r=s.find(".amp-active").attr("amp-desktop-id"),o=i.children('[amp-desktop-id="'+r+'"]'),p=o.find(".amp-widget-drag-icon").offset().top,l=o.find(".amp-widget-drag-icon").offset().left;n.css({"z-index":9e3,display:"block",position:"absolute",top:t.offset().top+"px",left:t.offset().left+"px",width:t.width()+"px",height:t.height()+"px"}),$("body").append(n),n.animate({top:p,left:l,width:50,height:50},"slow")}function j(e,t){var n=t.desktopId,i=t.desktopType,s=t.desktopName,r=t.cardName,o="",p=0,l="";if(e.each(function(){var e=$(this).attr("widget-wid");e!=a&"@widgetWid"!=e&&(p++,cardSeq=p,l+='{"cardWid":"'+e+'","cardSeq":'+parseInt(cardSeq)+"},")}),l=l.substr(0,l.length-1),""!=l){l="["+l+"]";var o="",m='{"desktopId":"'+n+'","desktopType":"'+parseInt(i)+'","target":"'+o+'","desktopUserLayoutList":'+l+"}",t="desktopUserEntityJson="+m;AmpDataUtils.editDesktop(t,function(e){"success"===e.result&&AmpUtils.zhuge("添加卡片到桌面",{"桌面名":s,"卡片名":r.join(",")})})}}function B(){var e=$("#ampDesktopNav"),a=$("#ampDesktopContent"),t=e.find(".amp-active").attr("amp-desktop-id"),n=a.find('.amp-tab-content-item[amp-desktop-id="'+t+'"]').find(".amp-widget-add").hasClass("amp-hide");n&&V()}function W(){var e=$("#ampDesktopContent"),a=e.find(".recommedCard:first"),t=a.attr("widget-wid"),n={};n.cardWid=t,O(n)}function O(a){var t=$("#ampDesktopContent"),n=t.find(".recommedCard:first"),i=a.cardWid,s=0,r='{"cardWid":"'+i+'","status":'+parseInt(s)+"}";AmpDataUtils.updateRecommendCardStatus(r,function(a){if("success"===a.result){var t="删除成功";"en_US"==AmpGlobal.currentLang&&(t=$.i18n("deletedSuccessfully")),AmpPrompt.show({content:t}),n.remove(),e.showRecommendCrad()}})}function z(){var a=$("#ampDesktopContent"),t=$("#ampDesktopNav"),n=t.find(".amp-active").attr("amp-desktop-id"),i=t.find(".amp-active").attr("amp-desktop-type"),s=a.find(".recommedCard:first"),r=s.attr("widget-wid"),o=a.find(".recommedCard:first").index()+1,p=1,l='{"desktopId":"'+n+'","desktopType":'+parseInt(i)+',"status":'+parseInt(p)+',"cardWid":"'+r+'","cardSeq":'+parseInt(o)+"}";AmpDataUtils.updateRecommendCardStatus(l,function(a){if("success"===a.result){var t="添加成功";"en_US"==AmpGlobal.currentLang&&(t=$.i18n("addedSuccessfully")),AmpPrompt.show({content:t}),s.removeClass("recommedCard"),e.showRecommendCrad()}})}function q(a){var t=$("#ampDesktopContent"),n=($("#ampDesktopNav"),t.find(".recommedCard:first")),i=n.attr("widget-wid"),s=n.attr("widget-id"),r=n.attr("app-id"),o=a.attr("desktop-id"),p=a.attr("desktop-type"),l=1,m='{"desktopId":"'+o+'","desktopType":'+parseInt(p)+',"status":'+parseInt(l)+',"cardWid":"'+i+'"}';n.remove(),n.removeClass("recommedCard"),e.showRecommendCrad();var c=[],d={};d.appId=r,d.cardId=s,d.cardWid=i,c.push(d);var u=c.length,f=x({widgets:c,widgetsLen:u}),g={};g.desktopId=o,g.desktopRecommendCardHtm=f,g.cardWid=i,g.cardId=s,e.space.sessionStorageRecommendData.push(g),$("#ampRecommendShowDesktop").hide(),AmpDataUtils.updateRecommendCardStatus(m,function(a){if("success"===a.result){var t="添加成功";"en_US"==AmpGlobal.currentLang&&(t=$.i18n("addedSuccessfully")),AmpPrompt.show({content:t}),n.removeClass("recommedCard"),e.showRecommendCrad()}})}function J(e){var a=e.hasClass("tabhasUnReadMark");if(!a)return!1;var t=e.attr("amp-id"),n=$("#ampCategoryTabContent"),i=n.children('[amp-id="'+t+'"]').children().find(".apphasUnReadMark").closest(".amp-app-complex"),s=[];i.each(function(){var e=$(this).attr("amp-appid"),a=$(this).attr("app-card-wid"),t={appId:e,cardWid:a};s.push(t)}),Y(s)}function Y(e){var a="",t=e.length;if(0==t)return!1;for(var n in e){var i=e[n].cardWid,s=e[n].appId;a+='{"appId":"'+s+'","cardWid":"'+i+'"},'}a=a.substr(0,a.length-1),a="["+a+"]";AmpDataUtils.updatePcCardMarkStatus(a,function(e){"success"===e.result})}function V(){lct=document.getElementById("ampDesktopContent"),lct.scrollTop=Math.max(0,lct.scrollHeight-lct.offsetHeight+480),$("#ampDesktopContent").getNiceScroll().resize(),setTimeout(function(){AmpPersonalCenter.showRecommendCrad()},450)}function Z(){var e=$("#ampPersonalAsideLeftCanUseCards"),a=$("#ampDesktopNav"),t=a.find(".amp-tab-item").filter("[amp-desktop-id]").length;if(0==t){var n="请先在右侧新建桌面，方可添加应用卡片";"en_US"==AmpGlobal.currentLang&&(n=$.i18n("pleaseCreateANewDesktop"));var i=$("#tpl-CanUseCards-ampty-page").html().replace("@pleaseCreateANewDesktop",n);e.children().css("display","none"),e.append(i)}}function X(){var e=$("#ampDesktopNav"),a=e.find(".amp-tab-item"),t=a.filter("[amp-desktop-type]").length,n="",i="",s="",r=!1,o="",p="";if(!(t<=4)){a.each(function(e){1==$(this).filter("[amp-desktop-id]").length&&e<3&&!$(this).hasClass("amp-desktop-admin")?n+=$(this)[0].outerHTML:1==$(this).filter("[amp-desktop-id]").length&&e>=3&&!$(this).hasClass("amp-desktop-admin")?($(this).find("span").hasClass("amp-admin-new-desktopnav")&&(r=!0),$(this).hasClass("amp-active")&&(o="amp-desktop-admin-active"),i+=$(this)[0].outerHTML):$(this).hasClass("amp-desktop-admin")||(s+=$(this)[0].outerHTML)}),r&&(p='<span class="amp-admin-new-desktopnav"></span>');var l='<div class="amp-desktopnav-more amp-animated-fast" id="ampDesktopNavMore">'+i+"</div>";n+='<div class="amp-tab-item amp-desktop-nav-icon amp-desktop-admin amp-desktop-nav-btn '+o+'"><i class="iconfont icon-gengduo"></i>'+p+l+"</div>",e.html(n+s),AmpUtils.niceScrollInit($("#ampDesktopNavMore"))}}function K(e){var a=$("#ampDesktopContent"),t=$("#ampDesktopNav");t.find(".amp-tab-item.amp-active").find("span").remove(),a.children(".amp-active").children(".amp-admin-new-desktop-recommed").remove();var n=t.find(".amp-tab-item.amp-active").parent().hasClass("amp-desktopnav-more"),i=t.find(".amp-tab-item.amp-active").parent().find(".amp-tab-item span").length;n&&0==i&&t.find(".amp-tab-item.amp-desktop-admin").find("span").remove();var s=t.find(".amp-tab-item.amp-active").attr("amp-desktop-id");Q(s)}function Q(e){var a=e;AmpDataUtils.updateUserDesktopStatus(a,function(e){"success"==e.result})}function ee(){var e=$("#ampPersonalAsideLeftTabHead");g(e.find(".amp-tab-item:nth-child(2)"))}function ae(e){var a,t=(e.parent().attr("cardnickname"),e.parent().attr("app-card-wid")),n=$("#ampDesktopNav"),i=$("#ampDesktopContent"),s=n.find(".amp-active").attr("amp-desktop-id"),r=i.children('[amp-desktop-id="'+s+'"]'),o=r.children('[widget-wid="'+t+'"]');return a=!(o.length>0)}function te(e){var a=e.closest(".amp-create-desktop");a.removeClass("amp-animate-move-top-in").addClass("amp-animate-move-top-out"),setTimeout(function(){a.siblings(".ampDesktopAddFlag").removeClass("amp-btn-active"),a.remove(),$(".empty-desktop-create")&&1==$(".empty-desktop-create").length&&$(".empty-desktop-create").removeClass("amp-btn-active")},250)}function ne(e){var a=$("#ampCreateDesktopInput").val();if(a){var t=a,n="desktopName="+encodeURI(t);AmpDataUtils.desktopCreat(n,function(a){if("success"==a.result){te(e),w(a,t);var n=$("#ampPersonalAsideLeftCanUseCards");$(".amp-empty-page").remove(),n.children().css("display","block"),$("#ampDesktopNav").find(".ampDesktopAddFlag").removeClass("amp-btn-active")}else{var i="创建桌面失败";"en_US"==AmpGlobal.currentLang&&(i=$.i18n("failedToCreateADesktop")),AmpPrompt.show({content:i})}}),AmpUtils.zhuge("创建桌面",{"桌面名称":a,"来源":"点页面上方桌面名称后的+号"})}}function ie(){var e=$("#ampDesktopNav"),a=$("#ampDesktopContent"),t=e.find(".amp-active").attr("amp-desktop-id"),n=a.children('[amp-desktop-id="'+t+'"]'),i=n.children();i.each(function(e){var a=$(this),t=a.find('div[has-scroll="true"]');AmpUtils.niceScrollInit(t),"true"===a.find("amp-w-frame").attr("has-scroll")&&(AmpUtils.niceScrollInit(a.find(".amp-wf-body")),a.find(".amp-wf-body").getNiceScroll().resize())})}function se(){setTimeout(function(){localStorage.changeLanguageFlag="false",$("#ampProgressBar").removeClass("amp-active").addClass("amp-hide")},0)}function re(e){var a=e;return AmpIsPortalCustom.sortDesktopData&&"function"==typeof AmpIsPortalCustom.sortDesktopData&&(a=AmpIsPortalCustom.sortDesktopData(e)),a}function oe(e){return!AmpIsPortalCustom.desktopOverallInte||"function"!=typeof AmpIsPortalCustom.desktopOverallInte||(AmpIsPortalCustom.desktopOverallInte(e),s(),!1)}function pe(){return!(!AmpIsPortalCustom.personalCenterCallback||"function"!=typeof AmpIsPortalCustom.personalCenterCallback)&&(AmpIsPortalCustom.personalCenterCallback(),!0)}function le(){var e=540;return AmpIsPortalCustom.setCustomCardWidth&&"function"==typeof AmpIsPortalCustom.setCustomCardWidth&&(e=AmpIsPortalCustom.setCustomCardWidth()),e}e.space={loadState:0,loadCompleteState:2,desktopRefresh:!1,sessionStorageRecommendData:[],favEmpty:!1,hasRightSideData:!1},e.init=function(){setTimeout(function(){e.space.loadState!==e.space.loadCompleteState&&AmpLoading.show()},500),AmpUtils.niceScrollInit($("#ampDesktopContent")),AmpUtils.niceScrollInit($("#ampPersonalAsideRightTask")),AmpUtils.niceScrollInit($("#ampTagMessages")),setTimeout(function(){AmpDesktopCommon.setDesktopWidth("left","mini")},50),l(),e.getMyFavoriteApps(),e.getMainWidgetsData(),e.getUserCategoryAppData(),e.getTaskCount(),A()},e.initContainerLayout=function(e){},e.getMyFavoriteApps=function(){AmpDataUtils.getMyFavoriteApps(function(e){i(e)})},e.getUserCategoryAppData=function(){AmpDataUtils.getUserCategoryAppData(function(e){AmpCanUseApps.saveData(e),AmpCanUseCard.saveData(e)})},e.getTaskCount=function(){AmpDataUtils.getAsideWidgetsData(function(a){if("success"==a.result){var t=a.taskSideCard,n="";if(t)for(var i in t){var s=t[i];"4764373267044847"==s.appId&&(n=s.totalSize,n&&$("#ampzqfwTaskCount").addClass("amp-task-count-bg").text(n),$("#zqfwTask").removeClass("amp-aside-box-hide")),"4764356755066632"==s.appId&&(e.space.hasRightSideData=!0,$("#dbTask").removeClass("amp-aside-box-hide")),"4764368506642413"==s.appId&&(e.space.hasRightSideData=!0,$("#lcgzTask").removeClass("amp-aside-box-hide")),e.space.hasRightSideData&&AmpDataUtils.getTaskCount(function(e){var a=e[0],t=(e[1],e[2]);a&&$("#ampDbTaskCount").addClass("amp-task-count-bg").text(a),t&&$("#ampLcgzTaskCount").addClass("amp-task-count-bg").text(t),sessionStorage.setItem("taskCount1",a+t)})}sessionStorage.setItem("taskCount2",n)}}),AmpDataUtils.getAsideWidgetsDataOfUnreadMessage(function(e){"success"==e.result&&null==e.taskSideMessageBiz.appId&&(messageCount=e.taskSideMessageBiz.totalSize,messageCount&&$("#ampMessageTaskCount").addClass("amp-task-count-bg").text(messageCount),sessionStorage.setItem("messageCount",messageCount))})},e.getMainWidgetsData=function(n){n!=a&&n?(e.space.desktopRefresh=!0,t(n)):AmpDataUtils.desktopInfo(function(e){t(e)})},e.hideMainWidgets=function(){$("#ampDesktopContent").find(".amp-widget").addClass("amp-hide")},e.showMainWidgets=function(){r()},e.dragViewing=function(){$(window).scroll(function(){var e=document.getElementById("eq").offsetTop;e>=$(window).scrollTop()&&e<$(window).scrollTop()+$(window).height()&&alert("div在可视范围")})},e.getCanUseAppsHtml=function(e,a){for(var t="",n=e.length,i=0;i<n;i++){var s="",r="";s=e[i].unReadMark?"apphasUnReadMark":"",e[i].hasUnReadMarkClass=s,"complex"==a&&(r=u(e[i])?"amp-app-complex-del":"amp-app-complex-add",e[i].hasBtnClass=r),t+=AmpTemplate.getSingleAppHtml(e[i],a)}return t},e.asideLeftTabChange=g,e.showRecommendCrad=function(){var e=G(),a=($("#ampRecommendBtn").css("display"),$(".amp-recommed-card-container"));if(!e)return a.css("display","none"),!1;if(a.css("display","block"),0==$("#ampTabContentItem0").find(".amp-recommed-card-container").length){var t=sessionStorage.getItem("recommendDesktopNavHtml");$recommendCardHtml=AmpTemplate.getRecommendHtml(t),$("#ampTabContentItem0").append($recommendCardHtml),""==t&&$("#ampDesktopTitle").remove()}setTimeout(function(){var e=$("#ampDesktopContent"),a=$("#ampDesktopContent").find(".amp-tab-content-item:first").find(".recommedCard:first"),t=($("#ampDesktopContent").find(".amp-widget-drag"),a.offset().top),n="",i="",s="";t<240&&t>0?(n=t-80+"px",$("#ampRecommendBtn").addClass("amp-recommend-down").removeClass("amp-recommend-up")):t<0?n=-t+(e.offsetHeight-e.scrollTop())+"px":(s=e.scrollTop(),n=s?s+a.offset().top-240+"px":a.offset().top-240+"px",$("#ampRecommendBtn").removeClass("amp-recommend-down").addClass("amp-recommend-up"));var r=$("#ampPersonalAsideLeft").width(),o=$("#ampPersonalAsideRight").width();i=60==r?a.offset().left-100+16+"px":60==o?a.offset().left-580+"px":a.offset().left-420+"px",$(".amp-recommed-card-container").css({top:n,left:i}),$(".amp-recommed-card-container").show()},600);var n=E();n||setTimeout(function(){var e=$("#ampTabContentItem0").find(".recommedCard:first").offset().top;$("#ampDesktopContent").animate({scrollTop:e-240},300)},200)},e.showCanUseCardEmptyPage=function(){Z()},e.showAdminNewDesktop=function(){var e=$("#ampDesktopContent"),a=$("#ampDesktopNav"),t=e.children(".amp-active").attr("id"),n="";1==a.find(".amp-tab-item.amp-active").find("span").length&&(n=AmpTemplate.getAdminNewDesktopHtm()),$("#ampAdminNewDesktopRecommed").length>0&&$("#ampAdminNewDesktopRecommed").remove(),$("#"+t).append(n)},e.setPcDesktopToolAddOrDrag=function(e){var a=$("#ampDesktopNav"),t=$("#ampDesktopContent"),n=a.find(".amp-active").attr("amp-desktop-id"),i=t.find('.amp-tab-content-item[amp-desktop-id="'+n+'"]');e?(i.find(".amp-widget-add").removeClass("amp-hide").addClass("amp-animate-move-bottom-in"),i.find(".amp-widget-drag").addClass("amp-widget-drag-hide")):(i.find(".amp-widget-add").addClass("amp-hide").removeClass("amp-animate-move-bottom-in"),i.find(".amp-widget-drag").removeClass("amp-widget-drag-hide"))},e.initSortingCards=function(){k()},e.setDesktopBlurHtm=function(){var e=parseInt($("#ampDesktopContent").width()/540),a=AmpTemplate.getDesktopBlurItemsHtm(e);$("#amp-desktopBlur").html(a)},e.setCreateDesktopPosition=function(){var e=$("#ampDesktopNav").find(".ampDesktopAddFlag");if(e.length>0){var a=e.offset().left-$("#ampPersonalAsideLeft").width()-16;$("#ampAdminNewDesktop").css("left",""+a+"px")}},e.openAsideBoxConfig=function(){var e=AMPConfigure.personalCenterAsideOpenConfig,t=$("#ampPersonalAsideLeftMini").find('.amp-aside-box-mini-item[amp-id="myFavorite"]'),n=$("#ampPersonalAsideRightMini").find('.amp-aside-box-mini-item[id="zqfwTask"]'),i=localStorage.leftAsideOpenFlag!=a?localStorage.leftAsideOpenFlag:e.charAt(0),s=localStorage.rightAsideOpenFlag!=a?localStorage.rightAsideOpenFlag:e.charAt(1);i=""==i?0:i,s=""==s?0:s;var r=""+i+s,o=$("#ampPersonalAsideLeft"),p=$("#ampPersonalAsideRight");"01"==r?p.hasClass("amp-mini")&&n.click():"10"==r?o.hasClass("amp-mini")&&t.click():"11"==r&&(p.hasClass("amp-mini")&&setTimeout(function(){var e=$("#ampDesktopContent"),a=540,t=$(window).width(),i=a+e.offset().left;t-i>312&&n.click()},450),o.hasClass("amp-mini")&&t.click())},e.setCustomDesktopCenter=function(e,t){var n=$("#ampDesktopNav"),i=n.find(".amp-tab-item:first").hasClass("amp-active");e=e==a?"left":e,t==a&&(t="1"==localStorage.leftAsideOpenFlag?"normal":"mini"),"undefined"!=typeof AMPConfigure.desktop_custom&&AMPConfigure.desktop_custom.pccard_customization&&i?(cardWidth=le(),AmpDesktopCommon.setDesktopWidth(e,t,cardWidth)):AmpDesktopCommon.setDesktopWidth(e,t)}}(window.AmpPersonalCenter=window.AmpPersonalCenter||{}),function(e,a){function t(t){if(t.hasClass("amp-active"))return void(e.space.clickMiNiTab!=a&&null!=e.space.clickMiNiTab&&(n($('.ampTaskArrowFlag[amp-id="'+e.space.clickMiNiTab+'"]'))||m($('.ampTaskArrowFlag[amp-id="'+e.space.clickMiNiTab+'"]'))));var r=t.attr("amp-id"),o=t.closest(".amp-tab"),p=o.find(".amp-tab-content"),l=o.find(".amp-tab-item.amp-active"),c=l.attr("amp-id");if(l.removeClass("amp-active"),p.children('[amp-id="'+c+'"]').addClass("amp-hide"),t.addClass("amp-active"),p.children('[amp-id="'+r+'"]').removeClass("amp-hide"),"message"===r)s(),$("#ampPersonalAsideRightTask").css("display","none"),$("#ampPersonalAsideRightMessage").css("display","block"),AmpUtils.setScroll($("#ampTagMessages"),1);else{i(),$("#ampPersonalAsideRightTask").css("display","block"),$("#ampPersonalAsideRightMessage").css("display","none"),e.space.clickMiNiTab!=a&&null!=e.space.clickMiNiTab&&(n($('.ampTaskArrowFlag[amp-id="'+e.space.clickMiNiTab+'"]'))||m($('.ampTaskArrowFlag[amp-id="'+e.space.clickMiNiTab+'"]'))),AmpUtils.setScroll($("#ampPersonalAsideRightTask"),1);var d=""==parseInt($.trim($("#taskSumCount").text()))?0:$.trim($("#taskSumCount").text());d||($("#ampTaskEmptyPage").removeClass("amp-hide"),$("#ampPersonalAsideRightTask").find(".ampTaskArrowFlag").remove())}}function n(e){var a=!1,e=e,t=e.closest("div.amp-personal-aside-right-task-box"),n=t.find(".amp-personal-aside-right-task-item-content");return n.hasClass("amp-hide")||(a=!0),a}function i(){if(0===e.space.loadingCount){var a,t=AmpPersonalCenter.space.hasRightSideData,n=$("#ampPersonalAsideRightTask");t?(n.find(".hasAsideRIghtFlag").removeClass("amp-hide"),AmpDataUtils.getTaskDbLcData("1",function(t){a="1",p(t,a),e.space.loadingCount++}),AmpDataUtils.getTaskDbLcData("3",function(t){a="3",p(t,a),e.space.loadingCount++})):n.find(".hasAsideRIghtFlag").addClass("amp-hide");var i={};i.pageNumber="1",i.pageSize="20",AmpDataUtils.getTaskZqfwData(i,function(a){l(a),e.space.loadingCount++})}}function s(){var e=$("#ampTagMessages");0===$.trim(e.html()).length&&AmpMessage.show()}function r(e){var a=e.attr("amp-id");$("#ampPersonalAsideRightMini").find(".amp-active").removeClass("amp-active"),$("#ampPersonalAsideRightTabHead").find('[amp-id="'+a+'"]').click();var t=$("#ampPersonalAsideRight");"message"==a?(t.off("animationend").on("animationend",function(){AmpUtils.setScroll($("#ampTagMessages"),1)}),$("#ampPersonalAsideRightTask").css("display","none"),$("#ampPersonalAsideRightMessage").css("display","block"),AmpUtils.checkEvent(function(){return $("#ampPersonalAsideRightMessage").offset().left>0},function(){AmpUtils.setScroll($("#ampTagMessages"),1)})):"task"==a&&(t.off("animationend").on("animationend",function(){AmpUtils.setScroll($("#ampPersonalAsideRightTask"),1)}),$("#ampPersonalAsideRightTask").css("display","block"),$("#ampPersonalAsideRightMessage").css("display","none"),AmpUtils.checkEvent(function(){return $("#ampPersonalAsideRightTask").offset().left>0},function(){AmpUtils.setScroll($("#ampPersonalAsideRightTask"),1)}))}function o(){var e=$("#taskSumCount"),a=sessionStorage.getItem("taskCount1"),t=sessionStorage.getItem("taskCount2"),n=sessionStorage.getItem("messageCount");a=null==a?0:a,t=null==t?0:t,a+t&&a+t!="0"&&(e.text(parseInt(a)+parseInt(t)),parseInt(e.text())&&$('#ampPersonalAsideRightTabHead [amp-id="task"]').find(".amp-red-corner").removeClass("amp-hide")),n&&"0"!=n&&($("#messageSumCount").text(n),$('#ampPersonalAsideRightTabHead [amp-id="message"]').find(".amp-red-corner").removeClass("amp-hide"))}function p(t,i){taskData=t[0].taskData,taskDataTotal=t[0].taskDataTotal;var s=0,r="",o="";if(taskData){s=taskDataTotal-taskData.length;for(var p=0;p<taskData.length;p++)r+=AmpTemplate.getAsideRightTaskItem(taskData[p],i)}if("1"==i){var l="打开待办事项>",c="查看更多",d="项";"en_US"==AmpGlobal.currentLang&&(l=$.i18n("openTodoList"),c=$.i18n("seeMore"),d=$.i18n("itemCard")),o=taskDataTotal<6?$("#tpl-aside-right-process-item-open").html().replace("@text",l):$("#tpl-aside-right-process-item-more").html().replace("@total",s).replace("@seeMore",c).replace("@item",d),$("#ampPersonalAsideRightDbTaskItem").html(r+o),$("#dbTaskCountTotal").text(taskDataTotal)}else if("3"==i){var l="打开流程跟踪>",c="查看更多",d="项";"en_US"==AmpGlobal.currentLang&&(l=$.i18n("openProcessTracking"),c=$.i18n("seeMore"),d=$.i18n("itemCard")),o=taskDataTotal<6?$("#tpl-aside-right-process-item-open").html().replace("@text",l):$("#tpl-aside-right-process-item-more").html().replace("@total",s).replace("@seeMore",c).replace("@item",d),$("#ampPersonalAsideRightLcgzTaskItem").html(r+o),$("#lcgzTaskCountTotal").text(taskDataTotal)}e.space.clickMiNiTab!=a&&null!=e.space.clickMiNiTab&&(n($('.ampTaskArrowFlag[amp-id="'+e.space.clickMiNiTab+'"]'))||m($('.ampTaskArrowFlag[amp-id="'+e.space.clickMiNiTab+'"]')))}function l(e){var a=$("#ampPersonalAsideRightZqfwTaskItem"),t=e.hasAndReadyToOpenServiceList,n=e.totalSize,i="";0==t.length?0==a.children().length&&g():(t.length<20&&t.length>0&&g(),t&&t.forEach(function(e){i+=AmpTemplate.getAsideRightTaskZqfwItem(e)})),a.children(".amp-personal-empty-page").length>0?a.html(i):a.append(i),$("#zqfwTaskCountTotal").text(n)}function m(e){var a=""==$.trim($("#ampzqfwTaskCount").text())?0:$.trim($("#ampzqfwTaskCount").text()),t=""==$.trim($("#ampDbTaskCount").text())?0:$.trim($("#ampDbTaskCount").text()),n=""==$.trim($("#ampLcgzTaskCount").text())?0:$.trim($("#ampLcgzTaskCount").text()),i=parseInt(a)+parseInt(t)+parseInt(n);if(i){var e=e,s=e.closest("div.amp-personal-aside-right-task-box"),r=s.find(".amp-personal-aside-right-task-item-content");if(0==r.children().length&&0==s.find(".ampPersonalAsideRightZqfwTaskItemFlag").length)return;r.hasClass("amp-hide")?(r.removeClass("amp-hide").addClass("amp-active"),s.addClass("amp-aside-right-box-expand")):(r.addClass("amp-hide").removeClass("amp-active"),s.removeClass("amp-aside-right-box-expand")),s.siblings(".amp-personal-aside-right-task-box").removeClass("amp-aside-right-box-expand").find(".amp-personal-aside-right-task-item-content").addClass("amp-hide"),AmpUtils.setScroll($("#ampPersonalAsideRightTask"),1)}else $("#ampTaskEmptyPage").removeClass("amp-hide"),$("#ampPersonalAsideRightTask").find(".ampTaskArrowFlag").remove()}function c(e){var e=e,a=e.attr("appId"),t=e.attr("processIntanceId"),n=parent.window.AMPConstant.taskCenterRequestPath+"sys/taskCenter/*default/index.do?min=1#/flowChart/"+a+"/"+t;window.open(n,"_blank")}function d(e){var a=e.attr("appId"),t=e.attr("processIntanceId"),n=AMPConstant.taskCenterRequestPath+"sys/taskCenter/*default/index.do?min=1#/flowComments/"+a+"/"+t,i="查看办理意见";"en_US"==AmpGlobal.currentLang&&(i=$.i18n("checkAdvice")),window.AmpDialog({title:i,height:500,remote:{url:n}})}function u(){$("#ampPersonalAsideRightTask").on("scroll",function(){var a=$(this),t=$("#ampPersonalAsideRightZqfwTaskItem"),n=a.height(),i=a.get(0).scrollHeight,s=a.scrollTop();if(i-n-s-110<=0){var r=t.children().length;if(e.space.lazyComplete){var o={};o.pageNumber=""+parseInt(r/20+1),o.pageSize="20",f(o)}}})}function f(a){e.space.lazyComplete=!1,AmpDataUtils.getTaskZqfwData(a,function(a){l(a),e.space.lazyComplete=!0})}function g(){$("#ampPersonalAsideRightTask").off("scroll")}e.space={clickMiNiTab:null,lazyComplete:!0,loadingCount:0},$("#ampPersonalAsideRightMini").on("click",".amp-aside-box-mini-item",function(){localStorage.rightAsideOpenFlag="1";var a=$(this).attr("id");e.space.clickMiNiTab=a,r($(this)),AmpPersonalCenter.setCustomDesktopCenter("right","normal"),setTimeout(function(){"0"!=AmpGlobal.platformType&&(AmpPersonalCenter.showRecommendCrad(),
AmpPersonalCenter.setCreateDesktopPosition()),AmpPersonalCenter.setDesktopBlurHtm(),AmpPersonalCenter.showAdminNewDesktop()},750)}),$("#ampPersonalAsideRightTabHead").on("click",".amp-tab-item",function(){var e=$(this);o(),t(e);var a=e.attr("amp-id");"message"===a?AmpUtils.zhuge("查看未读消息",{}):AmpUtils.zhuge("打开任务中心",{})}),$("#ampPersonalAsideRightTask").on("click",".amp-personal-aside-right-task-item",function(){localStorage.rightAsideOpenFlag="0",m($(this))}),$("#ampPersonalAsideRightClose").on("click",function(){localStorage.rightAsideOpenFlag="0",navigator.userAgent.indexOf("MSIE 9.0")>0?setTimeout(function(){AmpPersonalCenter.setCustomDesktopCenter("right","mini")},450):AmpPersonalCenter.setCustomDesktopCenter("right","mini"),setTimeout(function(){"0"!=AmpGlobal.platformType&&(AmpPersonalCenter.showRecommendCrad(),AmpPersonalCenter.setCreateDesktopPosition()),AmpPersonalCenter.setDesktopBlurHtm(),AmpPersonalCenter.showAdminNewDesktop()},750)}),$("#ampPersonalAsideRightTask").on("click",".right-side-do-more",function(){var e=$(this).parent(),a=e.attr("id");"ampPersonalAsideRightLcgzTaskItem"==a?window.open(AMPConstant.taskCenterRequestPath+"sys/taskCenter/*default/index.do#/processTrack","_blank"):"ampPersonalAsideRightDbTaskItem"==a&&window.open(AMPConstant.taskCenterRequestPath+"sys/taskCenter/*default/index.do#/todoTask","_blank")}),$("#ampPersonalAsideRightTask").on("click",".amp-card-service-item",function(e){var a=$(e.target),t=a.closest(".amp-personal-aside-right-task-item-content").attr("id");if(a.closest(".view-comment").length)d(a);else if(a.closest(".check-flow").length)c(a);else if("ampPersonalAsideRightZqfwTaskItem"!==t){var n=a.closest(".aside-process-item").attr("url");n&&"undefined"!=n&&"null"!=n&&window.open(n,"_blank")}}),u()}(window.AmpPersonalRightAside=window.AmpPersonalRightAside||{}),function(e,a){}(window.AmpRightAsideCard=window.AmpRightAsideCard||{}),function(e,a){function t(e,a){$("body").find(e).each(function(){var e=$(this).parent();e.addClass("ampLoadingCompleteFlag"),AmpLoading.close({container:e})})}function n(e){e.find("div.amp-widget:not(.ampLoadingCompleteFlag)").each(function(){var e=$(this);e.hasClass("ampEmptyWidgetPlaceholderFlag")||0===e.children().children().length&&AmpLoading.show({type:"breath",container:e,customClass:"amp-border-radios-12"})})}e.loadWidgetComplete=function(e,a){t(e,a)},e.addLoadingToWidget=function(e){n(e)}}(window.AmpWidgetUtils=window.AmpWidgetUtils||{}),function(e,a){function t(a,t){var s=e.space,r=s.leftAsideWidth,o=s.leftAsideMiniWidth,p=s.rightAsideWidth,l=s.rightAsideMiniWidth,m=window.innerWidth,c=$("#ampPersonalMainWidgetSection"),d=c.attr("amp-left-state"),u=c.attr("amp-right-state"),f=0,g=0,v="";"left"===a?"mini"===t?"normal"===u&&(g=o,f=m-o-p):(g=r,"mini"===u?f=m-r-l:n(m)?f=m-r-p:(v="right",f=m-r-l)):"mini"===t?"normal"===d&&(g=r,f=m-r-l):"mini"===d?(g=o,f=m-o-p):n(m)?(g=r,f=m-r-p):(g=o,v="left",f=m-o-p);var h=i(m,f);"left"===v?($("#ampPersonalAsideLeft").addClass("amp-mini"),c.attr("amp-left-state","mini")):"right"===v&&($("#ampPersonalAsideRight").addClass("amp-mini"),c.attr("amp-right-state","mini")),0===f&&0===g?c.removeAttr("style"):c.css({left:g+"px",width:f+"px"}),c.attr("amp-"+a+"-state",t),$("#ampDesktopNav").css({"padding-left":h+"px"}),$("#ampDesktopContent").css({"padding-left":h+"px"}).getNiceScroll().resize()}function n(a){var t=!0,n=e.space,i=n.leftAsideWidth,s=n.rightAsideWidth,r=n.widgetWidth;return a-i-s<r&&(t=!1),t}function i(a,t){var n=e.space,i=n.leftAsideMiniWidth,s=n.rightAsideMiniWidth;t||(t=a-i-s-16);var r=n.widgetWidth,o=parseInt(t/r,10),p=r*o,l=parseInt((t-p)/2,10);return l+8}e.space={leftAsideWidth:436,leftAsideMiniWidth:60,rightAsideWidth:332,rightAsideMiniWidth:60,widgetWidth:556},e.setDesktopWidth=function(a,n,i){"undefined"!=typeof i?e.space.widgetWidth=i+16:e.space.widgetWidth=556,t(a,n)}}(window.AmpDesktopCommon=window.AmpDesktopCommon||{}),function(e,a){function t(){AmpDataUtils.getUserDesktopProperty(function(e){var a=n(e);$("body").append(a),setTimeout(function(){i()},10)})}function n(e){var a=e.desktopUserConfList,t=parseInt(a.length,10),n="",i=0,s=!1,r=window.navigator.userAgent;if((window.ActiveXObject||"ActiveXObject"in window)&&r.indexOf("MSIE")>0){var o=r.match(/MSIE \d+/i),p=o[0].match(/\d+/i);parseInt(p)<=10&&(s=!0)}if(null!==a||0!==t)for(var l=0;l<t;l++){var m=a[l].desktopId,c=a[l].desktopName,d=a[l].desktopType;"1"==d&&i++;var u=a[l].isDelete,f=a[l].isReset,g=a[l].desktopSeq,v=0==u?"set-shanchu":"",h=0==f?"set-refresh":"",A="";if(!d){var C="默认桌面 ";"en_US"==AmpGlobal.currentLang&&(C=$.i18n("defaultDesktop")),A="( "+C+")"}var k="重置",b="删除",S="8",y="",w="padding-right-55";"en_US"==AmpGlobal.currentLang&&(k=$.i18n("recover"),b=$.i18n("delete"),S=$.i18n("desktopLength"),s&&(y="right-45",w="")),n+=$("#tpl-desktop-set-container").html().replace("@desktopId",m).replace("@desktopName",c).replace("@desktopType",d).replace("@setRefresh",h).replace("@setShanchu",v).replace("@desktopSeq",g).replace("@defaultDesktopMessage",A).replace("@recover",k).replace("@delete",b).replace("@desktopLength",S).replace("@desktopLength",S).replace("@rightNumClass",y).replace("@textPaddingRight",w)}var P=t,n=n,I="新建的桌面",U="桌面设置",D="共 ",L=" /3个自建桌面",T="完成",F="保存该桌面？",x="新建",S="8",y="",w="padding-right-55";"en_US"==AmpGlobal.currentLang&&(I=$.i18n("newDesktop"),U=$.i18n("desktopSettings"),D=$.i18n("desktopSettingPre"),L=$.i18n("desktopSettingEnd"),T=$.i18n("complete"),F=$.i18n("saveDesktop"),x=$.i18n("create"),S=$.i18n("desktopLength"),s&&(y="right-45",w=""));var H=$("#tpl-desktop-set-creat-container").html().replace("@newDesktop",I).replace("@create",x).replace("@saveDesktop",F).replace("@desktopLength",S).replace("@desktopLength",S).replace("@rightNumClass",y).replace("@textPaddingRight",w),M=$("#tpl-desktop-set-page").html().replace("@desktopListCount",P).replace("@desktopListHtml",n).replace("@deskopsetCreatHtml",H).replace("@desktopSettings",U).replace("@aTotalOf",D).replace("@desktops",L).replace("@complete",T);return M}function i(){$(".amp-desktop-set-wrap").addClass("amp-active"),s(),AmpUtils.niceScrollInit($(".amp-desktop-set-container")),r(),o(),m()}function s(){var e=$(window).height(),a=e-44-120,t=a-90-104;$("#ampDesktopSet").find(".amp-desktop-set-container").css({"max-height":t+"px"})}function r(){Sortable.create(ampDesktopSortContainer,{handle:".amp-desktop-set-drag-icon",animation:150,filter:".widget-del-btn",onEnd:function(){var e="";$("#ampDesktopSortContainer").find(".amp-desktop-set-list").each(function(){var a=$(this),t=a.attr("amp-desktop-id"),n=a.index(),i=a.attr("amp-desktop-type");e+='{"desktopId":"'+t+'","desktopSeq":"'+n+'","desktopType":"'+i+'"},'}),e=e.substr(0,e.length-1),e="["+e+"]",AmpDataUtils.updateUserDesktopSeq(e,function(e){if("success"===e.result){var a="排序成功";"en_US"==AmpGlobal.currentLang&&(a=$.i18n("sortedSuccessfully")),AmpPrompt.show({content:a})}}),AmpUtils.zhuge("桌面排序",{})}})}function o(){var a=$("#ampDesktopSet");$(window).resize(function(){s()}),a.on("click",".amp-desktop-set-close-icon,.amp-desktop-set-close-btn",function(){c()}),a.on("click",".amp-desktop-set-list-name",function(e){var a=$(e.currentTarget),t=a.siblings(".amp-desktop-set-list-input-container"),n=a.find("span.desktopName").text();if(""==n){var i="新建的桌面";"en_US"==AmpGlobal.currentLang&&(i=$.i18n("newDesktop")),n=i}a.hide().closest(".amp-desktop-set-list"),t.show().find(".amp-desktop-set-list-input").attr("data-old-val",n),t.show().find(".amp-desktop-set-list-input").val(n).focus(),p(t)}),$(".amp-desktop-set-list-input").on("input",function(a){if(!e.space.inputLockFlag){var t=$(a.currentTarget).closest(".amp-desktop-set-list-input-container");p(t)}}).on("compositionstart",function(){e.space.inputLockFlag=!0}).on("compositionend",function(a){if(e.space.inputLockFlag=!1,!e.space.inputLockFlag){var t=$(a.currentTarget).closest(".amp-desktop-set-list-input-container");p(t)}}),$("#ampDesktopSortContainer").on("input",".amp-desktop-set-list-input",function(a){if(!e.space.inputLockFlag){var t=$(a.currentTarget).closest(".amp-desktop-set-list-input-container");p(t)}}),a.on("blur",".amp-desktop-set-list-input",function(e){var a=$(e.currentTarget);if("ampDesktopCreatContainer"==a.closest(".amp-desktop-set-list").attr("id"))return!1;var t=a.val();if(""==$.trim(t)){a.focus();var n="桌面不能为空";return"en_US"==AmpGlobal.currentLang&&(n=$.i18n("cannotBeEmpty")),AmpPrompt.show({content:n}),!1}if("ampdesktopSetCreateInput"==a.attr("id"))return!1;var i={};if(t){a.closest(".amp-desktop-set-list").removeClass("amp-desktop-set-list-focus-bg"),a.closest(".amp-desktop-set-list-input-container").hide().siblings(".amp-desktop-set-list-name").show().find("span.desktopName").text(t);var s=a.closest(".amp-desktop-set-list").attr("amp-desktop-id"),r=a.closest(".amp-desktop-set-list").attr("amp-desktop-type"),o="1",n="重命名成功";"en_US"==AmpGlobal.currentLang&&(n=$.i18n("renameSuccessfully")),i.desktopName=t,i.desktopId=s,i.desktopType=r,i.target=o,i.desc=n,l(i,a),AmpUtils.zhuge("修改桌面名称",{"桌面新名称":t,"桌面旧名称":a.attr("data-old-val")})}});var t="确认删除该桌面？",n="确认恢复默认配置？";"en_US"==AmpGlobal.currentLang&&(t=$.i18n("confirmToDelete"),n=$.i18n("confirmToRestore")),a.on("click",".amp-desktop-set-restore-icon",function(e){var a=$(e.currentTarget);a.closest(".amp-desktop-set-list").removeClass("amp-bg-color-primary-hover-lv4").addClass("amp-desktop-set-list-yellow-bg"),a.closest(".amp-desktop-set-list-toolbar").addClass("hide").siblings(".amp-desktop-set-list-confirm").show().attr("amp-btn-role","restore"),a.closest(".amp-desktop-set-list").find(".amp-desktop-set-list-confirm-text").text(n)}),a.on("click",".amp-desktop-set-delete-icon",function(e){var a=$(e.currentTarget);a.closest(".amp-desktop-set-list").removeClass("amp-bg-color-primary-hover-lv4").addClass("amp-desktop-set-list-yellow-bg"),a.closest(".amp-desktop-set-list-toolbar").addClass("hide").siblings(".amp-desktop-set-list-confirm").show().attr("amp-btn-role","delete"),a.closest(".amp-desktop-set-list").find(".amp-desktop-set-list-confirm-text").text(t)}),a.on("click",".amp-cancel-btn",function(e){var a=$(e.currentTarget);a.closest(".amp-desktop-set-list").removeClass("amp-desktop-set-list-yellow-bg").addClass("amp-bg-color-primary-hover-lv4"),a.closest(".amp-desktop-set-list-confirm").hide().siblings(".amp-desktop-set-list-toolbar").removeClass("hide")}),a.on("click",".amp-confirm-btn",function(e){var a=$(e.currentTarget),t=a.closest(".amp-desktop-set-list"),n=t.attr("amp-desktop-id"),i=a.closest(".amp-desktop-set-list-confirm").attr("amp-btn-role"),s={desktopId:n};if("delete"===i){s.type="delete",t.remove();var r=parseInt($("#ampDesktopSortContainer").find(".amp-desktop-set-list").length,10);$("#desktopCount").text(r);var s={},o=a.closest(".amp-desktop-set-list").find(".amp-desktop-set-list-name").find("span.desktopName").html(),n=a.closest(".amp-desktop-set-list").attr("amp-desktop-id"),p=a.closest(".amp-desktop-set-list").attr("amp-desktop-type"),m="3",c="删除成功";"en_US"==AmpGlobal.currentLang&&(c=$.i18n("deletedSuccessfully")),s.desktopName=o,s.desktopId=n,s.desktopType=p,s.target=m,s.desc=c,l(s,a),AmpUtils.zhuge("删除桌面",{"桌面名称":o})}else{a.closest(".amp-desktop-set-list").removeClass("amp-desktop-set-list-yellow-bg").addClass("amp-bg-color-primary-hover-lv4"),a.closest(".amp-desktop-set-list-confirm").hide().siblings(".amp-desktop-set-list-toolbar").removeClass("hide");var s={},o=a.closest(".amp-desktop-set-list").find(".amp-desktop-set-list-name").find("span.desktopName").html(),n=a.closest(".amp-desktop-set-list").attr("amp-desktop-id"),p=a.closest(".amp-desktop-set-list").attr("amp-desktop-type"),m="2",c="恢复成功";"en_US"==AmpGlobal.currentLang&&(c=$.i18n("recoveredSuccessfully")),s.desktopName=o,s.desktopId=n,s.desktopType=p,s.target=m,s.desc=c,l(s,a),AmpUtils.zhuge("恢复桌面默认设置",{"桌面名称":o})}}),a.on("click",".create",function(e){var a=$(e.currentTarget);a.closest(".amp-desktop-set-list").removeClass("amp-bg-color-primary-hover-lv4").addClass("amp-desktop-set-list-yellow-bg"),a.closest(".amp-desktop-set-list-center").find(".amp-desktop-set-list-name").hide().siblings(".amp-desktop-set-list-input-container").show(),a.closest(".amp-desktop-set-list").find(".amp-desktop-set-list-confirm").show().attr("amp-btn-role","delete"),$("#ampdesktopSetCreateInput").focus()}),a.on("click",".amp-create-cancel-btn",function(e){var a=$(e.currentTarget);a.closest(".amp-desktop-set-list").removeClass("amp-desktop-set-list-yellow-bg").addClass("amp-bg-color-primary-hover-lv4"),a.closest(".amp-desktop-set-list-confirm").hide().removeClass("hide"),a.closest(".amp-desktop-set-list").find(".amp-desktop-set-list-center").find(".amp-desktop-set-list-name").show(),a.closest(".amp-desktop-set-list").find(".amp-desktop-set-list-center").find(".amp-desktop-set-list-input-container").hide()}),a.on("click",".amp-create-save-btn",function(e){d()})}function p(e){var a=e.find(".amp-desktop-set-list-input").val(),t=parseInt(a.length,10);e.find('span[amp-input-role="actual"]').text(t)}function l(e,a){var t=e.desktopName,n=e.desktopId,i=e.desktopType,s=e.target,r=e.desc,o='{"desktopName":"'+encodeURI(t)+'","desktopId":"'+n+'","desktopType":"'+parseInt(i)+'","target":"'+s+'"}',p="desktopUserEntityJson="+o;AmpDataUtils.editDesktop(p,function(e){"success"===e.result&&(AmpPrompt.show({content:r}),"2"==s&&a.closest(".amp-desktop-set-list").find(".amp-desktop-set-list-name").find("span.desktopName").text(e.desktopName)),m()})}function m(){var e=$("#ampDesktopSortContainer"),a=$("#ampDesktopCreatContainer"),t=e.children().filter('[amp-desktop-type="1"]').length,n="共",i="/3个自建桌面",s="您的桌面数量已满";"en_US"==AmpGlobal.currentLang&&(n=$.i18n("desktopSettingPre"),i=$.i18n("desktopSettingEnd"),s=$.i18n("fullDesktopNum")),t>2?(a.css("display","none"),$(".amp-desktop-set-subTitle").text(n+"3"+i+","+s)):(a.css("display","block"),$(".amp-desktop-set-subTitle").text(n+t+i),a.removeClass("amp-desktop-set-list-yellow-bg").addClass("amp-bg-color-primary-hover-lv4"),a.find(".amp-desktop-set-list-confirm").hide().removeClass("hide"),a.find(".amp-desktop-set-list-center").find(".amp-desktop-set-list-name").show(),a.find(".amp-desktop-set-list-center").find(".amp-desktop-set-list-input-container").hide())}function c(){var e=$(".amp-desktop-set-wrap");e.removeClass("amp-active"),setTimeout(function(){AmpDataUtils.userDesktopInfo("",function(a){AmpUtils.currentPageBlurAnimate("restore"),e.remove();var t=$("#ampPersonalArticle");navigator.userAgent.indexOf("MSIE")>0||AmpUtils.isIE()?$("#ampPageHeaderPersonalIcon").hasClass("amp-active")&&t.addClass("amp-active").removeClass("amp-hide"):$("#ampPageHeaderPersonalIcon").hasClass("amp-active")&&t.addClass("amp-active"),AmpPersonalCenter.getMainWidgetsData(a),AmpPersonalCenter.showCanUseCardEmptyPage(),setTimeout(function(){AmpPersonalCenter.initContainerLayout()},50)})},450)}function d(){var e=$("#ampdesktopSetCreateInput").val();if(!e){var a="请输入桌面名称";return"en_US"==AmpGlobal.currentLang&&(a=$.i18n("enterDesttopName")),void AmpPrompt.show({content:a})}var t=e,n="desktopName="+encodeURI(t);AmpDataUtils.desktopCreat(n,function(e){if("success"==e.result)u(e,t);else{var a="创建桌面失败";"en_US"==AmpGlobal.currentLang&&(a=$.i18n("failedToCreateADesktop")),AmpPrompt.show({content:a})}}),AmpUtils.zhuge("创建桌面",{"桌面名称":e,"来源":"桌面设置界面中新建"})}function u(e,a){var t=!1,n=window.navigator.userAgent;if((window.ActiveXObject||"ActiveXObject"in window)&&n.indexOf("MSIE")>0){var i=n.match(/MSIE \d+/i),s=i[0].match(/\d+/i);parseInt(s)<=10&&(t=!0)}var r=e.desktopId,o=a,p="1",l=1,m=0,c="19",d=0==l?"set-shanchu":"",u=0==m?"set-refresh":"",g="",v="",h="保存",A="删除",C="8",k="",b="padding-right-55";"en_US"==AmpGlobal.currentLang&&(h=$.i18n("recover"),A=$.i18n("delete"),C=$.i18n("desktopLength"),t&&(k="right-45",b="")),v=$("#tpl-desktop-set-container").html().replace("@desktopId",r).replace("@desktopName",o).replace("@desktopType",p).replace("@setRefresh",u).replace("@setShanchu",d).replace("@desktopSeq",c).replace("@defaultDesktopMessage",g).replace("@recover",h).replace("@delete",A).replace("@desktopLength",C).replace("@desktopLength",C).replace("@rightNumClass",k).replace("@textPaddingRight",b),$("#ampDesktopSortContainer").append(v),f()}function f(){var e=$("#ampDesktopSortContainer"),a=$("#ampDesktopCreatContainer"),t=e.find('.amp-desktop-set-list[amp-desktop-type="1"]').length,n="共",i="/3个自建桌面";"en_US"==AmpGlobal.currentLang&&(n=$.i18n("desktopSettingPre"),i=$.i18n("desktopSettingEnd")),$(".amp-desktop-set-subTitle").text(n+t+i),t>2?a.hide():(a.removeClass("amp-desktop-set-list-yellow-bg").addClass("amp-bg-color-primary-hover-lv4"),a.find(".amp-desktop-set-list-confirm").hide().removeClass("hide"),a.find(".amp-desktop-set-list-center").find(".amp-desktop-set-list-name").show(),a.find(".amp-desktop-set-list-center").find(".amp-desktop-set-list-input-container").hide())}e.space={inputLockFlag:!1},e.init=function(e){t()}}(window.AmpDesktopSet=window.AmpDesktopSet||{});